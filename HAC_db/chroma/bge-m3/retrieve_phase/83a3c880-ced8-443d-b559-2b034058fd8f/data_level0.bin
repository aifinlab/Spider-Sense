v1mpAIKJIwBtKwCAcSsAgI0rAIC+6QCAh5kjAJEpAIB5KwCAyOkAgIu5JACpKwCAifkkAI6VIwCPiSMAsSsAgI2JJACSvSMAESsAgLkrAICR4SMAo+sAgJfFIwCU8SMA4SsAgJkpAICbkSMA+SsAgJndIwD9KwCAnwktAAksAICdjdUAogkjAJ0pAIBBLACAofUjAEUsAICnGSMApCUkAG0sAICq7SQAeSwAgKgdIwCpeSQArhUjAK8JIwCsCSQArQkkALI9IwCJLACAsDEjALFhIwC2VSMAt0UjALRxIwC1XSMAulkjALsRIwCRLACAuV0jAL6JLQCVLACAvI0tANzpAICAuSUAgX0iAIKBIgCDmSIAhK0lAIXZJQCGuSIAh5EiAIiVIgCJ8SUAljIAgIuxJQCMgSUAjYElAI6dIgCPgSIAkLkiAJHpIgCStSIAk9EiAJT5IgCV1SIAlt0iAJfNIgCY+SIAmdUiAJrRIgCbmSIAqSwAgLEsAIDh6QCAvSwAgGUAAACh/SIAogEiAKMZIgDFLACApVklAKY5IgCnESIAqBUiAKlxJQDNLACAqzElAKwBJQCtASUArh0iAK8BIgCwOSIAsWkiALI1IgCzUSIAtHkiALVVIgC2XSIAt00iALh5IgC5VSIAulEiALsZIgD1LACA4SwAgO0sAIDxLACAgI0vAIGlLwCCrS8Ag70vAISlLwCFrS8AhqUvAIfdLwCI5S8Aie0vAIrlLwD5LACAAS0AgAUtAIANLQCAFS0AgJCRLwCRkS8AkpEvAJORLwCUsS8AlbEvAJa1LwCXRTMAmE0zAJlVMwCaPTMAmxkzAJyZMwCdiTMAnlUwAJ9JMACgwTAAockwAKLZMACj1TAApM0wAKX9MACm5TAApzUwAKi1MQCpuTEAqu0xAKuxmgCs0ZYArbE6AK61OgAZLQCAsEGUALHNlgCy1ZoAs8GWALTBlgC14ZoAtsGWALf9lgC4yZYAucGWALrZlgC71ZYAvLGWAL29lgC+qZYAv6WWAMUAAAChfSAAooEgACktAICkrScALS0AgDktAICnkSAAXS0AgKnxJwCqZScAq7EnAKyBJwCtgScArp0gAK+BIACwuSAAsekgALK1IABhLQCAtPkgALXVIAC23SAAt80gAEUtAIC51SAATS0AgLuZIACpLQCAcS0AgHUtAIB5LQCAgDknAIH9IACCASAAgxkgAG0tAICFWScAhjkgAIcRIACIFSAAiXEnAIrlJwCLMScAjAEnAI0BJwCOHSAAjwEgAJA5IACRaSAAkjUgAJNRIACUeSAAlVUgAJZdIACXTSAAmHkgAJlVIACaUSAAmxkgAJyFLgCdBdYAnoEuAJ+BLgCArT8AgbU/AIK9PwCDtT8AhK0/AIW5yACG1T8Ah80/AIj1PwCJ/T8AipnIAIvxPwCMATsAjQE7AI6NyACPOQQAkEkEAJFJBACSWQQAk1UEAJRNBACV3TwAlnkEAJd1BACYWQQAmSEEAJohBACbNdQAnCEEAJ3Z5gCeJQQAnx0EAKDpBACh9QQAos0/AKP1BACkFQQApfnUAKYhyACnIcgAqNHUAKktBACqOQQAq03CAKwtBACtdcgArh0EAK95BACwKQQAsTEEALI9BACzOQQAtC0EALX9BQC2qQUAt6kFALiZBQC5mQUAunkFALtFBQC8AQUAvQEFAL4BBQC/AQUAgC0HAIE1BwCCPQcAgzUHAIQtBwCFqQcAhqUHAIdl1QCILQYAiTEGAIoxBgCLDQYAjPnJAI15BgCOWQYAj1UGAJBpyQCRNQYAkj0GAJM1BgCULQYAlcUGAJZdAwCXVQMAmG0DAJl1AwCafQMAm3UDAJxtAwCdET0AnlkDAJ9ZAwCgqQMAoakDAKK5AwCjuQMApKkDAKWpAwCm2QMAp9kDAKjpAwCp6QMAqvkDAKv9AwCs5QMAre0DAK7lAwCvbcMAsKEDALGhAwCyoQMAs6EDALShAwC1zeYAtq0DALelAwC4yeYAuZkDALppAwC7aQMAvHkDAL15AwC+aQMAv2kDAIAAAACBLQCAfS0AgJUtAIDm6QCAsS0AgLUtAIC9LQCA0S0AgPQtAIDr6QCA8OkAgAAuAIAELgCACC4AgPwtAIAQLgCAoSkAgKUpAIAYLgCAIC4AgPXpAIA8LgCAQC4AgEwuAID66QCAVC4AgFguAIA3LwCAqSkAgGwuAICILgCAhC4AgATqAICQLgCACeoAgJwuAICYLgCAoC4AgLAuAIC0LgCArSkAgMQuAIDMLgCA0C4AgNQuAICxKQCADuoAgLUpAID3LgCA+y4AgP8uAIDV6wCAGOoAgNo1AIAvLwCAuSkAgDvqAIAN6wCAPy8AgEcvAIC9KQCAWy8AgGsvAICqIfQAq7U/AKilPwCpzecArkXwAK+hPwCsSfAArTH0AKJl4gCjvT8AoLk/AKG5PwCmlT8Ap50/AKSlPwClnT8Augk8AG8vAIC4CTwAuQk8AHcvAICHLwCAxSkAgMEpAICy3T8AswU9ALBN7wCx1T8Atn3wALe55AC0HT0AtWk8AB3qAICPLwCAoy8AgKcvAIC3LwCAyy8AgMMvAIDHLwCAgrX7AM8vAICA/T8AgfU/AOMvAIDnLwCA/y8AgAcwAICavT8Am/3NAJi9PwCZtT8Anlk/AJ9ZPwCcWT8AnVk/AJKBPwCTaekAkHnkAJGxPwCWgT8Al4H0AJQh5wCVmT8AFzAAgCswAIAs6gCAJzAAgBswAIAzMACAOzAAgE8wAIAx6gCAVzAAgEoAAABLMACAQzAAgMkpAIBfMACAZzAAgG8wAIBjMACAzSkAgIcwAIA26gCAszAAgPUwAIDRMACA2SkAgNUpAIDRKQCAnSsAgKErAID5MACA4TAAgK41AIA9KgCADTEAgCExAIAZMQCAT+oAgN0pAIA1MQCAKTEAgFIxAIBZ6gCAXjEAgD0xAIBmMQCAajEAgG4xAIByMQCAfjEAgF7qAICGMQCA5SkAgJIxAIBj6gCAljEAgOkpAICiMQCArjEAgL4xAIBo6gCA/+kAgG3qAIDeMQCAcuoAgLgJAQC5CQEAuhkBALsZAQC8CQEAvQkBAL45AQC/OQEAsM3FALE1zACymQ4As5kOALSJDgC1iQ4AtjkBALc5AQCo6dkAqckOAKrZDgCrqcUArMUOAK3NDgCuxQ4Ar/kOAKA1DgChPQ4AojUOAKOxxQCk8Q4ApfEOAKbxDgCn8Q4AmGkPAJlpDwCaeQ8Am3kPAJxpDwCdaQ8Ant0OAJ/NDgCQ+eoAkXEPAJJ9DwCTdQ8AlG0PAJVpDwCWWQ8Al1kPAIh5DwCJeQ8AigkPAIsJDwCMGQ8AjRkPAI4NzACPDQ8AgHkPAIF5DwCCSQ8Ag0kPAIRZDwCFWQ8AhkkPAIdJDwCKUQIAi1ECAIj5xgCJQQIAjnECAI/txgCMQQIAjUECAIIVAgCDHQIAgAUCAIEdAgCGdQIAh30CAIQFAgCFfQIAmsUCAJvNAgCYkc8AmYXaAJ7FAgCfzQIAnNUCAJ3NAgCSDQIAkxUCAJANAgCRBQIAlg0CAJf1AgCUDQIAlQUCAKo9AgCrRQIAqD0CAKk1AgCuXQIAr0UCAKxdAgCtVQIAol3GAKMBAgCgNQIAoQ0CAKYBAgCnxdgApBECAKURAgC6OQIAuzkCALg5AgC5OQIAvtkBAL/ZAQC82QEAvdkBALI9AgCzBQIAsD0CALE1AgC2GQIAtxkCALQdAgC16cIA6jEAgPIxAIDiMQCA/jEAgA4yAIAWMgCAIjIAgCYyAIB36gCACjIAgD4yAIBCMgCA7SkAgFIyAIB86gCANjIAgHIyAICB6gCAhuoAgHYyAICKMgCAgjIAgPEpAICOMgCAnjIAgJoyAICmMgCAw+kAgLYyAICL6gCAwjIAgJXqAIDWMgCA9jIAgJrqAIAKMwCADjMAgJ/qAICk6gCAKjMAgDozAID1KQCAPjMAgPkpAIBWMwCAWjMAgGYzAIByMwCA/SkAgIozAICp6gCApjMAgK7qAIAT6gCAwjMAgLPqAIC4AAAAuOoAgL3qAIABKgCABSoAgMfqAIDC6gCAzOoAgIAB3gCB8QcAgvEHAIPxBwCEFQIAhR0CAIYVAgCHEQIAiCXeAIld3gCKOQIAizkCAIwpAgCNKQIAjhkCAI99ygCQTd4AkWECAJJhAgCT7cEAlH0CAJVlAgCWIcAAl2kCAJhZAgCZMcIAmlUCAJstAgCcNQIAnT0CAJ4xAgCfMQIAoNECAKHRAgCi0QIAo9ECAKTxAgCl8QIApvECAKfxAgCo0QIAqdECAKrRAgCr0QIArDECAK0xAgCuMQIArzECALBRAgCxUQIAslECALNRAgC0cQIAtXECALZxAgC3cQIAuFECALlRAgC6+dwAu1UCALxNAgC9NQIAvj0CAL81AgC+7QYAv/UGALztBgC95QYAuskGALvJBgC4xcsAuckGALbtBgC39QYAtO0GALXlBgCyjQYAs/UGALDR3QCxhQYArvEGAK/xBgCs5QYAreEGAKr1BgCr/QYAqMUGAKn9BgCm9QYAp/0GAKTlBgCl/QYAovUGAKP9BgCg+QYAoZ3dAJ75BgCf+QYAnPkGAJ35BgCa+QYAm/kGAJj5BgCZ+QYAlvkGAJf5BgCUcd0AlfkGAJL9BgCT5QYAkP0GAJH1BgCO/QYAj4UGAIz9BgCN9QYAiuEGAIsB3QCI8QYAifEGAIbBBgCHwQYAhPEGAIXxBgCCkccAg+EGAIDpBgCBxcAAgAAAANHqAIACNACABjQAgBI0AIARKgCAFSoAgNvqAIAmNACAGSoAgODqAIDl6gCA6uoAgJY0AIAdKgCAojQAgKY0AIDv6gCA9OoAgL40AIAhKgCA+eoAgNI0AIDWNACAJSoAgP7qAIDyNACAKSoAgAI1AID6NACACjUAgAjrAIAiNQCALSoAgC41AIA2NQCARjUAgDEqAIAS6wCAF+sAgDUqAIAc6wCAXjUAgCHrAIBqNQCAdjUAgCbrAIAr6wCAkjUAgDDrAICaNQCAQOoAgDkqAICyNQCAtjUAgEEqAIC6NQCAFC4AgDXrAIA66wCAReoAgErqAIDeNQCA9jcAgIDNAQCB1QEAgt0BAIPVAQCEzQEAhfUBAIb9AQCH9QEAiM0BAInVAQCK3QEAi/UJAIzJAQCNyQEAjgEcAI89HwCQRR8AkU0fAJJFHwCTXR8AlEUfAJVNHwCWRR8Al30fAJhBxwCZQR8AmkEfAJtBHwCcQR8AnUEfAJ5BHwCfYd8AoL0fAKHFHwCizR8Ao8UfAKTdHwClxR8Aps0fAKfFHwCo/R8AqcUfAKrNHwCrxR8ArN0fAK3FHwCuzR8Ar8UfALC9HwCxRR8Ask0fALNFHwC0/ckAtVkfALZJHwC3SR8AuHkfALl5HwC6SR8Au8XdALxVHwC9XR8AvlUfAL9NHwAKNgCABjYAgA42AIAZLACAEjYAgBY2AIAaNgCAIjYAgD/rAIAmNgCAOjYAgD42AIAqNgCAQjYAgFY2AIA2NgCASjYAgE42AIBSNgCAROsAgE7rAIBJ6wCASSoAgHI2AIB2NgCAfjYAgGLrAICCNgCAU+sAgE0qAIBRKgCAWOsAgF3rAIBVKgCAojYAgKo2AICuNgCAujYAgLY2AIDCNgCAvjYAgMY2AIDKNgCA0jYAgFkqAIDaNgCA3jYAgF0qAIDuNgCAZ+sAgP42AIACNwCAYSoAgA43AICVKQCAbOsAgHHrAIBlKgCAaSoAgDo3AIB26wCAkjcAgJY3AICuNwCAgLUBAIG9AQCCtQEAg80BAITt9ACF0QEAhtEBAIfRAQCI8QEAifEBAIrxAQCL8QEAjNEBAI3RAQCO0QEAj9EBAJB9wwCRBcMAkl35AJO9AQCUpQEAla0BAJalAQCXXQMAmGUDAJltAwCaZQMAm30DAJxlAwCdbQMAnmUDAJ85wwCgoQMAoaEDAKKhAwCjoQMApKEDAKWhAwCmoQMAp6EDAKjhAwCp4QMAquEDAKvhAwCs4QMAreEDAK7hAwCv4QMAsKEDALGhAwCyoQMAs6EDALShAwC1oQMAtqEDALehAwC4YQMAuWEDALphAwC7YQMAvGEDAL1hAwC+pcMAv6HDALo3AICA6wCA0ukAgMY3AIDCNwCAzjcAgNfpAIDaNwCAhesAgIrrAIAmOACAMjgAgDo4AICP6wCAPjgAgGY4AIByOACAdjgAgG44AICCOACAhjgAgJTrAICSOACAbSoAgJo4AICZ6wCAcSoAgNI4AICkLgCA6jgAgJ7rAICo6wCAdSoAgHkqAIASOQCAresAgH0qAICy6wCAMjkAgLfrAIBKOQCAgSoAgFo5AIBmOQCAbjkAgHY5AICFKgCAvOsAgKY5AICyOQCAiSoAgI0qAIC2OQCAwesAgJEqAIDG6wCAy+sAgNDrAICVKgCA9jkAgPo5AIACOgCACjoAgNrrAICQ1QEAkd0BAJLVAQCT7QEAlPUBAJXB+wCW8QEAl/n7AJjNAQCZ1QEAmt0BAJvVAQCcyfsAnckBAEUqAICPAAAAgNkBAIHZAQCC6QEAg+kBAIT5AQCF+QEAhukBAIfpAQCI2QEAidkBAIoJwQCLrQEAjLUBAI29AQCOtQEAj60BAKAAAAChAAAAogAAAKMAAACkAAAApQAAAKYAAACnAAAAqAAAAKkAAACqAAAAqwAAAKwAAACtAAAArgAAAK8AAACwAAAAsQAAALIAAACzAAAAtAAAALUAAAC2AAAAtwAAALgAAAC5AAAAugAAALsAAAC8AAAAvQAAAL4AAAC/AAAAACAAIMyBACDMgwAgzIQAIMyFACDMhgAgzIcAIMyIACDMiMyAACDMiMyBACDMiM2CACDMigAgzIsAIMyTACDMk8yAACDMk8yBACDMk82CACDMlAAgzJTMgAAgzJTMgQAgzJTNggAgzKcAIMyoACDMswAgzYIAIM2FACDZiwAg2YwAINmM2ZEAINmNACDZjdmRACDZjgAg2Y7ZkQAg2Y8AINmP2ZEAINmQACDZkNmRACDZkQAg2ZHZsAAg2ZIAIOOCmQAg44KaACEAISEAIT8AIgAjACQAJQAmACcAKAAoMSkAKDEwKQAoMTEpACgxMikAKDEzKQAoMTQpACgxNSkAKDE2KQAoMTcpACgxOCkAKDE5KQAoMikAKDIwKQAoMykAKDQpACg1KQAoNikAKDcpACg4KQAoOSkAKEEpAChCKQAoQykAKEQpAChFKQAoRikAKEcpAChIKQAoSSkAKEopAChLKQAoTCkAKE0pAChOKQAoTykAKFApAChRKQAoUikAKFMpAChUKQAoVSkAKFYpAChXKQAoWCkAKFkpAChaKQAoYSkAKGIpAChjKQAoZCkAKGUpAChmKQAoZykAKGgpAChpKQAoaikAKGspAChsKQAobSkAKG4pAChvKQAocCkAKHEpAChyKQAocykAKHQpACh1KQAodikAKHcpACh4KQAoeSkAKHopACjhhIApACjhhIIpACjhhIMpACjhhIUpACjhhIYpACjhhIcpACjhhIkpACjhhIspACjhhIwpACjhhI4pACjhhI8pACjhhJApACjhhJEpACjhhJIpACjkuIApACjkuIMpACjkuIkpACjkuZ0pACjkuowpACjkupQpACjku6MpACjkvIEpACjkvJEpACjlhaspACjlha0pACjlirQpACjljYEpACjljZQpACjlkI0pACjlkbwpACjlm5spACjlnJ8pACjlraYpACjml6UpACjmnIgpACjmnIkpACjmnKgpACjmoKopACjmsLQpACjngaspACjnibkpACjnm6MpACjnpL4pACjnpZ0pACjnpa0pACjoh6opACjoh7MpACjosqEpACjos4cpACjph5EpACjqsIApACjrgpgpACjri6QpACjrnbwpACjrp4gpACjrsJQpACjsgqwpACjslYQpACjsmKTsoIQpACjsmKTtm4QpACjsnpApACjso7wpACjssKgpACjsubQpACjtg4ApACjtjIwpACjtlZgpACkAKgArACwALQAuAC4uAC4uLgAvADAAMCwAMC4AMOKBhDMAMOeCuQAxADEsADEuADEwADEwLgAxMOaXpQAxMOaciAAxMOeCuQAxMQAxMS4AMTHml6UAMTHmnIgAMTHngrkAMTIAMTIuADEy5pelADEy5pyIADEy54K5ADEzADEzLgAxM+aXpQAxM+eCuQAxNAAxNC4AMTTml6UAMTTngrkAMTUAMTUuADE15pelADE154K5ADE2ADE2LgAxNuaXpQAxNueCuQAxNwAxNy4AMTfml6UAMTfngrkAMTgAMTguADE45pelADE454K5ADE5ADE5LgAxOeaXpQAxOeeCuQAx4oGEADHigYQxMAAx4oGEMgAx4oGEMwAx4oGENAAx4oGENQAx4oGENgAx4oGENwAx4oGEOAAx4oGEOQAx5pelADHmnIgAMeeCuQAyADIsADIuADIwADIwLgAyMOaXpQAyMOeCuQAyMQAyMeaXpQAyMeeCuQAyMgAyMuaXpQAyMueCuQAyMwAyM+aXpQAyM+eCuQAyNAAyNOaXpQAyNOeCuQAyNQAyNeaXpQAyNgAyNuaXpQAyNwAyN+aXpQAyOAAyOOaXpQAyOQAyOeaXpQAy4oGEMwAy4oGENQAy5pelADLmnIgAMueCuQAzADMsADMuADMwADMw5pelADMxADMx5pelADMyADMzADM0ADM1ADM2ADM3ADM4ADM5ADPigYQ0ADPigYQ1ADPigYQ4ADPml6UAM+aciAAz54K5ADQANCwANC4ANDAANDEANDIANDMANDQANDUANDYANDcANDgANDkANOKBhDUANOaXpQA05pyIADTngrkANQA1LAA1LgA1MAA14oGENgA14oGEOAA15pelADXmnIgANeeCuQA2ADYsADYuADbml6UANuaciAA254K5ADcANywANy4AN+KBhDgAN+aXpQA35pyIADfngrkAOAA4LAA4LgA45pelADjmnIgAOOeCuQA5ADksADkuADnml6UAOeaciAA554K5ADoAOjo9ADsAPAA9AD09AD09PQA+AD8APyEAPz8AQABBAEFVAEHiiJVtAEIAQnEAQwBDRABDby4AQ+KIlWtnAEQAREoARFoARHoARMW9AETFvgBFAEYARkFYAEcAR0IAR0h6AEdQYQBHeQBIAEhQAEhWAEhnAEh6AEkASUkASUlJAElKAElVAElWAElYAEoASwBLQgBLSwBLTQBMAExKAExURABMagBMwrcATQBNQgBNQwBNRABNSHoATVBhAE1WAE1XAE3OqQBOAE5KAE5qAE5vAE8AUABQSABQUE0AUFBWAFBSAFBURQBQYQBRAFIAUnMAUwBTRABTTQBTUwBTdgBUAFRFTABUSHoAVE0AVQBWAFZJAFZJSQBWSUlJAFbiiJVtAFcAV0MAV1oAV2IAWABYSQBYSUkAWQBaAFsAXABdAF4AXwBgAGEAYS5tLgBhL2MAYS9zAGHKvgBiAGJhcgBjAGMvbwBjL3UAY2FsAGNjAGNkAGNtAGNtMgBjbTMAZABkQgBkYQBkbABkbQBkbTIAZG0zAGR6AGTFvgBlAGVWAGVyZwBmAGZmAGZmaQBmZmwAZmkAZmwAZm0AZwBnYWwAaABoUGEAaGEAaQBpaQBpaWkAaWoAaW4AaXYAaXgAagBrAGtBAGtIegBrUGEAa1YAa1cAa2NhbABrZwBrbABrbQBrbTIAa20zAGt0AGvOqQBsAGxqAGxtAGxuAGxvZwBseABswrcAbQBtMgBtMwBtQQBtVgBtVwBtYgBtZwBtaWwAbWwAbW0AbW0yAG1tMwBtb2wAbXMAbeKIlXMAbeKIlXMyAG4AbkEAbkYAblYAblcAbmoAbm0AbnMAbwBvVgBwAHAubS4AcEEAcEYAcFYAcFcAcGMAcHMAcQByAHJhZAByYWTiiJVzAHJhZOKIlXMyAHMAc3IAc3QAdAB1AHYAdmkAdmlpAHZpaWkAdwB4AHhpAHhpaQB5AHoAewB8AH0AwqIAwqMAwqUAwqYAwqwAwrBDAMKwRgDCtwDDgADDgQDDggDDgwDDhADDhQDDhgDDhwDDiADDiQDDigDDiwDDjADDjQDDjgDDjwDDkQDDkgDDkwDDlADDlQDDlgDDmQDDmgDDmwDDnADDnQDDoADDoQDDogDDowDDpADDpQDDpwDDqADDqQDDqgDDqwDDrADDrQDDrgDDrwDDsADDsQDDsgDDswDDtADDtQDDtgDDuQDDugDDuwDDvADDvQDDvwDEgADEgQDEggDEgwDEhADEhQDEhgDEhwDEiADEiQDEigDEiwDEjADEjQDEjgDEjwDEkgDEkwDElADElQDElgDElwDEmADEmQDEmgDEmwDEnADEnQDEngDEnwDEoADEoQDEogDEowDEpADEpQDEpgDEpwDEqADEqQDEqgDEqwDErADErQDErgDErwDEsADEsQDEtADEtQDEtgDEtwDEuQDEugDEuwDEvADEvQDEvgDFgwDFhADFhQDFhgDFhwDFiADFiwDFjADFjQDFjgDFjwDFkADFkQDFkwDFlADFlQDFlgDFlwDFmADFmQDFmgDFmwDFnADFnQDFngDFnwDFoADFoQDFogDFowDFpADFpQDFqADFqQDFqgDFqwDFrADFrQDFrgDFrwDFsADFsQDFsgDFswDFtADFtQDFtgDFtwDFuADFuQDFugDFuwDFvADFvQDFvgDGjgDGkADGoADGoQDGqwDGrwDGsADHjQDHjgDHjwDHkADHkQDHkgDHkwDHlADHlQDHlgDHlwDHmADHmQDHmgDHmwDHnADHngDHnwDHoADHoQDHogDHowDHpgDHpwDHqADHqQDHqgDHqwDHrADHrQDHrgDHrwDHsADHtADHtQDHuADHuQDHugDHuwDHvADHvQDHvgDHvwDIgADIgQDIggDIgwDIhADIhQDIhgDIhwDIiADIiQDIigDIiwDIjADIjQDIjgDIjwDIkADIkQDIkgDIkwDIlADIlQDIlgDIlwDImADImQDImgDImwDIngDInwDIogDIpgDIpwDIqADIqQDIqgDIqwDIrADIrQDIrgDIrwDIsADIsQDIsgDIswDItwDJkADJkQDJkgDJlADJlQDJmQDJmwDJnADJnwDJoQDJowDJpQDJpgDJqADJqQDJqgDJqwDJrQDJrwDJsADJsQDJsgDJswDJtADJtQDJuADJuQDJuwDKgQDKggDKgwDKiQDKigDKiwDKjADKkADKkQDKkgDKlQDKnQDKnwDKuQDKvG4AzIAAzIEAzIjMgQDMkwDOhgDOiADOiQDOigDOjADOjgDOjwDOkADOkQDOkgDOkwDOlADOlQDOlgDOlwDOmADOmQDOmgDOmwDOnADOnQDOngDOnwDOoADOoQDOowDOpADOpQDOpgDOpwDOqADOqQDOqgDOqwDOrADOrQDOrgDOrwDOsADOsQDOsgDOswDOtADOtQDOtgDOtwDOuADOuQDOugDOuwDOvADOvEEAzrxGAM68VgDOvFcAzrxnAM68bADOvG0AzrxzAM69AM6+AM6/AM+AAM+BAM+CAM+DAM+EAM+FAM+GAM+HAM+IAM+JAM+KAM+LAM+MAM+NAM+OAM+cAM+dANCAANCBANCDANCHANCMANCNANCOANCZANC5ANC9ANGKANGMANGQANGRANGTANGXANGcANGdANGeANG2ANG3ANOBANOCANOQANORANOSANOTANOWANOXANOaANObANOcANOdANOeANOfANOiANOjANOkANOlANOmANOnANOqANOrANOsANOtANOuANOvANOwANOxANOyANOzANO0ANO1ANO4ANO5ANWl1oIA1bTVpQDVtNWrANW01a0A1bTVtgDVvtW2ANeQANeQ1rcA15DWuADXkNa8ANeQ15wA15EA15HWvADXkda/ANeSANeS1rwA15MA15PWvADXlADXlNa8ANeV1rkA15XWvADXlta8ANeY1rwA15nWtADXmda8ANea1rwA15sA15vWvADXm9a/ANecANec1rwA150A157WvADXoNa8ANeh1rwA16IA16PWvADXpNa8ANek1r8A16bWvADXp9a8ANeoANeo1rwA16nWvADXqda814EA16nWvNeCANep14EA16nXggDXqgDXqta8ANey1rcA2KEA2KIA2KMA2KQA2KUA2KYA2KbYpwDYptisANim2K0A2KbYrgDYptixANim2LIA2KbZhQDYptmGANim2YcA2KbZiADYptmJANim2YoA2KbbhgDYptuHANim24gA2KbbkADYptuVANinANin2YPYqNixANin2YTZhNmHANin2YsA2KfZtADYqADYqNisANio2K0A2KjYrdmKANio2K4A2KjYrtmKANio2LEA2KjYsgDYqNmFANio2YYA2KjZhwDYqNmJANio2YoA2KkA2KoA2KrYrADYqtis2YUA2KrYrNmJANiq2KzZigDYqtitANiq2K3YrADYqtit2YUA2KrYrgDYqtiu2YUA2KrYrtmJANiq2K7ZigDYqtixANiq2LIA2KrZhQDYqtmF2KwA2KrZhditANiq2YXYrgDYqtmF2YkA2KrZhdmKANiq2YYA2KrZhwDYqtmJANiq2YoA2KsA2KvYrADYq9ixANir2LIA2KvZhQDYq9mGANir2YcA2KvZiQDYq9mKANisANis2K0A2KzYrdmJANis2K3ZigDYrNmEINis2YTYp9mE2YcA2KzZhQDYrNmF2K0A2KzZhdmJANis2YXZigDYrNmJANis2YoA2K0A2K3YrADYrdis2YoA2K3ZhQDYrdmF2YkA2K3ZhdmKANit2YkA2K3ZigDYrgDYrtisANiu2K0A2K7ZhQDYrtmJANiu2YoA2K8A2LAA2LDZsADYsQDYsdiz2YjZhADYsdmwANix24zYp9mEANiyANizANiz2KwA2LPYrNitANiz2KzZiQDYs9itANiz2K3YrADYs9iuANiz2K7ZiQDYs9iu2YoA2LPYsQDYs9mFANiz2YXYrADYs9mF2K0A2LPZhdmFANiz2YcA2LPZiQDYs9mKANi0ANi02KwA2LTYrNmKANi02K0A2LTYrdmFANi02K3ZigDYtNiuANi02LEA2LTZhQDYtNmF2K4A2LTZhdmFANi02YcA2LTZiQDYtNmKANi1ANi12K0A2LXYrditANi12K3ZigDYtdiuANi12LEA2LXZhNi52YUA2LXZhNmJANi12YTZiSDYp9mE2YTZhyDYudmE2YrZhyDZiNiz2YTZhQDYtdmE25IA2LXZhQDYtdmF2YUA2LXZiQDYtdmKANi2ANi22KwA2LbYrQDYttit2YkA2LbYrdmKANi22K4A2LbYrtmFANi22LEA2LbZhQDYttmJANi22YoA2LcA2LfYrQDYt9mFANi32YXYrQDYt9mF2YUA2LfZhdmKANi32YkA2LfZigDYuADYuNmFANi5ANi52KwA2LnYrNmFANi52YTZitmHANi52YUA2LnZhdmFANi52YXZiQDYudmF2YoA2LnZiQDYudmKANi6ANi62KwA2LrZhQDYutmF2YUA2LrZhdmJANi62YXZigDYutmJANi62YoA2YDZiwDZgNmOANmA2Y7ZkQDZgNmPANmA2Y/ZkQDZgNmQANmA2ZDZkQDZgNmRANmA2ZIA2YEA2YHYrADZgditANmB2K4A2YHYrtmFANmB2YUA2YHZhdmKANmB2YkA2YHZigDZggDZgtitANmC2YTbkgDZgtmFANmC2YXYrQDZgtmF2YUA2YLZhdmKANmC2YkA2YLZigDZgwDZg9inANmD2KwA2YPYrQDZg9iuANmD2YQA2YPZhQDZg9mF2YUA2YPZhdmKANmD2YkA2YPZigDZhADZhNiiANmE2KMA2YTYpQDZhNinANmE2KwA2YTYrNisANmE2KzZhQDZhNis2YoA2YTYrQDZhNit2YUA2YTYrdmJANmE2K3ZigDZhNiuANmE2K7ZhQDZhNmFANmE2YXYrQDZhNmF2YoA2YTZhwDZhNmJANmE2YoA2YUA2YXYpwDZhdisANmF2KzYrQDZhdis2K4A2YXYrNmFANmF2KzZigDZhditANmF2K3YrADZhdit2YUA2YXYrdmF2K8A2YXYrdmKANmF2K4A2YXYrtisANmF2K7ZhQDZhdiu2YoA2YXZhQDZhdmF2YoA2YXZiQDZhdmKANmGANmG2KwA2YbYrNitANmG2KzZhQDZhtis2YkA2YbYrNmKANmG2K0A2YbYrdmFANmG2K3ZiQDZhtit2YoA2YbYrgDZhtixANmG2LIA2YbZhQDZhtmF2YkA2YbZhdmKANmG2YYA2YbZhwDZhtmJANmG2YoA2YcA2YfYrADZh9mFANmH2YXYrADZh9mF2YUA2YfZiQDZh9mKANmH2bAA2YgA2YjYs9mE2YUA2YjZtADZiQDZidmwANmKANmK2KwA2YrYrNmKANmK2K0A2YrYrdmKANmK2K4A2YrYsQDZitiyANmK2YUA2YrZhdmFANmK2YXZigDZitmGANmK2YcA2YrZiQDZitmKANmK2bQA2a4A2a8A2bEA2bkA2boA2bsA2b4A2b8A2oAA2oMA2oQA2oYA2ocA2ogA2owA2o0A2o4A2pEA2pgA2qEA2qQA2qYA2qkA2q0A2q8A2rEA2rMA2roA2rsA2r4A24AA24EA24IA24UA24YA24cA24fZtADbiADbiQDbiwDbjADbkADbkgDbkwDgpJXgpLwA4KSW4KS8AOCkl+CkvADgpJzgpLwA4KSh4KS8AOCkouCkvADgpKkA4KSr4KS8AOCkr+CkvADgpLEA4KS0AOCmoeCmvADgpqLgprwA4Kav4Ka8AOCniwDgp4wA4KiW4Ki8AOCol+CovADgqJzgqLwA4Kir4Ki8AOCosuCovADgqLjgqLwA4Kyh4Ky8AOCsouCsvADgrYgA4K2LAOCtjADgrpQA4K+KAOCviwDgr4wA4LGIAOCzgADgs4cA4LOIAOCzigDgs4sA4LWKAOC1iwDgtYwA4LeaAOC3nADgt50A4LeeAOC5jeC4sgDguqvgupkA4Lqr4LqhAOC7jeC6sgDgvIsA4L2A4L61AOC9guC+twDgvYzgvrcA4L2R4L63AOC9luC+twDgvZvgvrcA4L2x4L2yAOC9seC9tADgvbHgvoAA4L6Q4L61AOC+kuC+twDgvpzgvrcA4L6h4L63AOC+puC+twDgvqvgvrcA4L6y4L2x4L6AAOC+suC+gADgvrPgvbHgvoAA4L6z4L6AAOGApgDhg5wA4YSAAOGEgQDhhIIA4YSDAOGEhADhhIUA4YSGAOGEhwDhhIgA4YSJAOGEigDhhIsA4YSMAOGEjQDhhI4A4YSPAOGEkADhhJEA4YSSAOGElADhhJUA4YSaAOGEnADhhJ0A4YSeAOGEoADhhKEA4YSiAOGEowDhhKcA4YSpAOGEqwDhhKwA4YStAOGErgDhhK8A4YSyAOGEtgDhhYAA4YWHAOGFjADhhZcA4YWYAOGFmQDhhaAA4YWhAOGFogDhhaMA4YWkAOGFpQDhhaYA4YWnAOGFqADhhakA4YWqAOGFqwDhhawA4YWtAOGFrgDhha8A4YWwAOGFsQDhhbIA4YWzAOGFtADhhbUA4YaEAOGGhQDhhogA4YaRAOGGkgDhhpQA4YaeAOGGoQDhhqoA4YasAOGGrQDhhrAA4YaxAOGGsgDhhrMA4Ya0AOGGtQDhh4cA4YeIAOGHjADhh44A4YeTAOGHlwDhh5kA4YedAOGHnwDhh7EA4YeyAOGshgDhrIgA4ayKAOGsjADhrI4A4aySAOGsuwDhrL0A4a2AAOGtgQDhrYMA4bSCAOG0lgDhtJcA4bScAOG0nQDhtKUA4bW7AOG2hQDhuIAA4biBAOG4ggDhuIMA4biEAOG4hQDhuIYA4biHAOG4iADhuIkA4biKAOG4iwDhuIwA4biNAOG4jgDhuI8A4biQAOG4kQDhuJIA4biTAOG4lADhuJUA4biWAOG4lwDhuJgA4biZAOG4mgDhuJsA4bicAOG4nQDhuJ4A4bifAOG4oADhuKEA4biiAOG4owDhuKQA4bilAOG4pgDhuKcA4bioAOG4qQDhuKoA4birAOG4rADhuK0A4biuAOG4rwDhuLAA4bixAOG4sgDhuLMA4bi0AOG4tQDhuLYA4bi3AOG4uADhuLkA4bi6AOG4uwDhuLwA4bi9AOG4vgDhuL8A4bmAAOG5gQDhuYIA4bmDAOG5hADhuYUA4bmGAOG5hwDhuYgA4bmJAOG5igDhuYsA4bmMAOG5jQDhuY4A4bmPAOG5kADhuZEA4bmSAOG5kwDhuZQA4bmVAOG5lgDhuZcA4bmYAOG5mQDhuZoA4bmbAOG5nADhuZ0A4bmeAOG5nwDhuaAA4bmhAOG5ogDhuaMA4bmkAOG5pQDhuaYA4bmnAOG5qADhuakA4bmqAOG5qwDhuawA4bmtAOG5rgDhua8A4bmwAOG5sQDhubIA4bmzAOG5tADhubUA4bm2AOG5twDhubgA4bm5AOG5ugDhubsA4bm8AOG5vQDhub4A4bm/AOG6gADhuoEA4bqCAOG6gwDhuoQA4bqFAOG6hgDhuocA4bqIAOG6iQDhuooA4bqLAOG6jADhuo0A4bqOAOG6jwDhupAA4bqRAOG6kgDhupMA4bqUAOG6lQDhupYA4bqXAOG6mADhupkA4bqgAOG6oQDhuqIA4bqjAOG6pADhuqUA4bqmAOG6pwDhuqgA4bqpAOG6qgDhuqsA4bqsAOG6rQDhuq4A4bqvAOG6sADhurEA4bqyAOG6swDhurQA4bq1AOG6tgDhurcA4bq4AOG6uQDhuroA4bq7AOG6vADhur0A4bq+AOG6vwDhu4AA4buBAOG7ggDhu4MA4buEAOG7hQDhu4YA4buHAOG7iADhu4kA4buKAOG7iwDhu4wA4buNAOG7jgDhu48A4buQAOG7kQDhu5IA4buTAOG7lADhu5UA4buWAOG7lwDhu5gA4buZAOG7mgDhu5sA4bucAOG7nQDhu54A4bufAOG7oADhu6EA4buiAOG7owDhu6QA4bulAOG7pgDhu6cA4buoAOG7qQDhu6oA4burAOG7rADhu60A4buuAOG7rwDhu7AA4buxAOG7sgDhu7MA4bu0AOG7tQDhu7YA4bu3AOG7uADhu7kA4byAAOG8gQDhvIIA4byDAOG8hADhvIUA4byGAOG8hwDhvIgA4byJAOG8igDhvIsA4byMAOG8jQDhvI4A4byPAOG8kADhvJEA4bySAOG8kwDhvJQA4byVAOG8mADhvJkA4byaAOG8mwDhvJwA4bydAOG8oADhvKEA4byiAOG8owDhvKQA4bylAOG8pgDhvKcA4byoAOG8qQDhvKoA4byrAOG8rADhvK0A4byuAOG8rwDhvLAA4byxAOG8sgDhvLMA4by0AOG8tQDhvLYA4by3AOG8uADhvLkA4by6AOG8uwDhvLwA4by9AOG8vgDhvL8A4b2AAOG9gQDhvYIA4b2DAOG9hADhvYUA4b2IAOG9iQDhvYoA4b2LAOG9jADhvY0A4b2QAOG9kQDhvZIA4b2TAOG9lADhvZUA4b2WAOG9lwDhvZkA4b2bAOG9nQDhvZ8A4b2gAOG9oQDhvaIA4b2jAOG9pADhvaUA4b2mAOG9pwDhvagA4b2pAOG9qgDhvasA4b2sAOG9rQDhva4A4b2vAOG9sADhvbIA4b20AOG9tgDhvbgA4b26AOG9vADhvoAA4b6BAOG+ggDhvoMA4b6EAOG+hQDhvoYA4b6HAOG+iADhvokA4b6KAOG+iwDhvowA4b6NAOG+jgDhvo8A4b6QAOG+kQDhvpIA4b6TAOG+lADhvpUA4b6WAOG+lwDhvpgA4b6ZAOG+mgDhvpsA4b6cAOG+nQDhvp4A4b6fAOG+oADhvqEA4b6iAOG+owDhvqQA4b6lAOG+pgDhvqcA4b6oAOG+qQDhvqoA4b6rAOG+rADhvq0A4b6uAOG+rwDhvrAA4b6xAOG+sgDhvrMA4b60AOG+tgDhvrcA4b64AOG+uQDhvroA4b68AOG/ggDhv4MA4b+EAOG/hgDhv4cA4b+IAOG/igDhv4wA4b+QAOG/kQDhv5IA4b+WAOG/lwDhv5gA4b+ZAOG/mgDhv6AA4b+hAOG/ogDhv6QA4b+lAOG/pgDhv6cA4b+oAOG/qQDhv6oA4b+sAOG/sgDhv7MA4b+0AOG/tgDhv7cA4b+4AOG/ugDhv7wA4oCQAOKAkwDigJQA4oCy4oCyAOKAsuKAsuKAsgDigLLigLLigLLigLIA4oC14oC1AOKAteKAteKAtQDigqkA4oaQAOKGkQDihpIA4oaTAOKGmgDihpsA4oauAOKHjQDih44A4oePAOKIggDiiIQA4oiHAOKIiQDiiIwA4oiRAOKIkgDiiKQA4oimAOKIq+KIqwDiiKviiKviiKsA4oir4oir4oir4oirAOKIruKIrgDiiK7iiK7iiK4A4omBAOKJhADiiYcA4omJAOKJoADiiaIA4omtAOKJrgDiia8A4omwAOKJsQDiibQA4om1AOKJuADiibkA4oqAAOKKgQDiioQA4oqFAOKKiADiiokA4oqsAOKKrQDiiq4A4oqvAOKLoADii6EA4ouiAOKLowDii6oA4ourAOKLrADii60A4pSCAOKWoADil4sA4qaFAOKmhgDiq53MuADitaEA44CBAOOAggDjgIgA44CJAOOAigDjgIsA44CMAOOAjQDjgI4A44CPAOOAkADjgJEA44CSAOOAlADjgJRT44CVAOOAlOS4ieOAlQDjgJTkuozjgJUA44CU5Yud44CVAOOAlOWuieOAlQDjgJTmiZPjgJUA44CU5pWX44CVAOOAlOacrOOAlQDjgJTngrnjgJUA44CU55uX44CVAOOAlQDjgJYA44CXAOOBjADjgY4A44GQAOOBkgDjgZQA44GWAOOBmADjgZoA44GcAOOBngDjgaAA44GiAOOBpQDjgacA44GpAOOBsADjgbEA44GzAOOBtADjgbYA44G3AOOBuQDjgboA44G744GLAOOBvADjgb0A44KI44KKAOOClADjgpkA44KaAOOCngDjgqEA44KiAOOCouODkeODvOODiADjgqLjg6vjg5XjgqEA44Ki44Oz44Oa44KiAOOCouODvOODqwDjgqMA44KkAOOCpOODi+ODs+OCsADjgqTjg7Pjg4EA44KlAOOCpgDjgqbjgqnjg7MA44KnAOOCqADjgqjjgrnjgq/jg7zjg4kA44Ko44O844Kr44O8AOOCqQDjgqoA44Kq44Oz44K5AOOCquODvOODoADjgqsA44Kr44Kk44OqAOOCq+ODqeODg+ODiADjgqvjg63jg6rjg7wA44KsAOOCrOODreODswDjgqzjg7Pjg54A44KtAOOCreODpeODquODvADjgq3jg60A44Kt44Ot44Kw44Op44OgAOOCreODreODoeODvOODiOODqwDjgq3jg63jg6/jg4Pjg4gA44KuAOOCruOCrADjgq7jg4vjg7wA44Ku44Or44OA44O8AOOCrwDjgq/jg6vjgrzjgqTjg60A44Kv44Ot44O844ONAOOCsADjgrDjg6njg6AA44Kw44Op44Og44OI44OzAOOCsQDjgrHjg7zjgrkA44KyAOOCswDjgrPjgrMA44Kz44OIAOOCs+ODq+ODigDjgrPjg7zjg50A44K0AOOCtQDjgrXjgqTjgq/jg6sA44K144Oz44OB44O844OgAOOCtgDjgrcA44K344Oq44Oz44KwAOOCuADjgrkA44K6AOOCuwDjgrvjg7Pjg4EA44K744Oz44OIAOOCvADjgr0A44K+AOOCvwDjg4AA44OA44O844K5AOODgQDjg4IA44ODAOODhADjg4UA44OGAOODhwDjg4fjgrcA44OIAOODiOODswDjg4kA44OJ44OrAOODigDjg4rjg44A44OLAOODjADjg40A44OOAOODjuODg+ODiADjg48A44OP44Kk44OEAOODkADjg5Djg7zjg6zjg6sA44ORAOODkeODvOOCu+ODs+ODiADjg5Hjg7zjg4QA44OSAOODkwDjg5Pjg6sA44OUAOODlOOCouOCueODiOODqwDjg5Tjgq/jg6sA44OU44KzAOODlQDjg5XjgqHjg6njg4Pjg4kA44OV44Kj44O844OIAOODleODqeODswDjg5YA44OW44OD44K344Kn44OrAOODlwDjg5gA44OY44Kv44K/44O844OrAOODmOODq+ODhADjg5kA44OZ44O844K/AOODmgDjg5rjgr0A44Oa44OL44OSAOODmuODs+OCuQDjg5rjg7zjgrgA44ObAOODm+ODswDjg5vjg7zjg6sA44Ob44O844OzAOODnADjg5zjg6vjg4gA44OdAOODneOCpOODs+ODiADjg53jg7Pjg4kA44OeAOODnuOCpOOCr+ODrQDjg57jgqTjg6sA44Oe44OD44OPAOODnuODq+OCrwDjg57jg7Pjgrfjg6fjg7MA44OfAOODn+OCr+ODreODswDjg5/jg6oA44Of44Oq44OQ44O844OrAOODoADjg6EA44Oh44KsAOODoeOCrOODiOODswDjg6Hjg7zjg4jjg6sA44OiAOODowDjg6QA44Ok44O844OJAOODpOODvOODqwDjg6UA44OmAOODpuOCouODswDjg6cA44OoAOODqQDjg6oA44Oq44OD44OI44OrAOODquODqQDjg6sA44Or44OU44O8AOODq+ODvOODluODqwDjg6wA44Os44OgAOODrOODs+ODiOOCsuODswDjg60A44OvAOODr+ODg+ODiADjg7AA44OxAOODsgDjg7MA44O0AOODtwDjg7gA44O5AOODugDjg7sA44O8AOODvgDjkp4A45K5AOOSuwDjk58A45SVAOObrgDjm7wA456BAOOgrwDjoaIA46G8AOOjhwDjo6MA46ScAOOkugDjqK4A46msAOOrpADjrIgA46yZAOOtiQDjrp0A47CYAOOxjgDjtLMA47aWAOO6rADjurgA47ybAOO/vADkgIgA5ICYAOSAuQDkgYYA5IKWAOSDowDkhK8A5IiCAOSIpwDkiqAA5IyBAOSMtADkjZkA5I+VAOSPmQDkkIsA5JGrAOSUqwDklZ0A5JWhAOSVqwDkl5cA5Je5AOSYtQDkmr4A5JuHAOSmlQDkp6YA5KmuAOSptgDkqrIA5KyzAOSvjgDks44A5LOtAOSzuADktZYA5LiAAOS4gQDkuIMA5LiJAOS4igDkuIsA5LiNAOS4mQDkuKYA5LioAOS4rQDkuLIA5Li2AOS4uADkuLkA5Li9AOS4vwDkuYEA5LmZAOS5nQDkuoIA5LqFAOS6hgDkuowA5LqUAOS6oADkuqQA5LquAOS6ugDku4AA5LuMAOS7pADkvIEA5LyRAOS9oADkvoAA5L6GAOS+iwDkvq4A5L67AOS+vwDlgIIA5YCrAOWBugDlgpkA5YOPAOWDmgDlg6cA5YSqAOWEvwDlhYAA5YWFAOWFjQDlhZQA5YWkAOWFpQDlhacA5YWoAOWFqQDlhasA5YWtAOWFtwDlhoAA5YaCAOWGjQDlhpIA5YaVAOWGlgDlhpcA5YaZAOWGpADlhqsA5YasAOWGtQDlhrcA5YeJAOWHjADlh5wA5YeeAOWHoADlh7UA5YiAAOWIgwDliIcA5YiXAOWInQDliKkA5Yi6AOWIuwDliYYA5YmNAOWJsgDlibcA5YqJAOWKmwDliqMA5YqzAOWKtADli4cA5YuJAOWLkgDli54A5YukAOWLtQDli7kA5Yu6AOWMhQDljIYA5YyVAOWMlwDljJoA5Yy4AOWMuwDljL8A5Y2BAOWNhADljYUA5Y2JAOWNkQDljZQA5Y2aAOWNnADljakA5Y2wAOWNswDljbUA5Y29AOWNvwDljoIA5Y62AOWPgwDlj4gA5Y+KAOWPjADlj58A5Y+jAOWPpQDlj6sA5Y+vAOWPsQDlj7MA5ZCGAOWQiADlkI0A5ZCPAOWQnQDlkLgA5ZC5AOWRggDlkYgA5ZGoAOWSngDlkqIA5ZK9AOWTtgDllJAA5ZWPAOWVkwDllZUA5ZWjAOWWhADllocA5ZaZAOWWnQDllqsA5ZazAOWWtgDll4AA5ZeCAOWXogDlmIYA5ZmRAOWZqADlmbQA5ZuXAOWbmwDlm7kA5ZyWAOWclwDlnJ8A5ZywAOWeiwDln44A5Z+0AOWgjQDloLEA5aCyAOWhgADloZoA5aGeAOWiqADloqwA5aKzAOWjmADlo58A5aOrAOWjrgDlo7AA5aOyAOWjtwDlpIIA5aSGAOWkigDlpJUA5aSaAOWknADlpKIA5aSnAOWkp+atowDlpKkA5aWEAOWliADlpZEA5aWUAOWlogDlpbMA5aeYAOWnrADlqJsA5ainAOWpogDlqaYA5aq1AOWsiADlrKgA5ay+AOWtkADlrZcA5a2mAOWugADlroUA5a6XAOWvgwDlr5gA5a+nAOWvrgDlr7MA5a+4AOWvvwDlsIYA5bCPAOWwogDlsLgA5bC/AOWxoADlsaIA5bGkAOWxpQDlsa4A5bGxAOWyjQDls4AA5bSZAOW1gwDltZAA5bWrAOW1rgDltbwA5bayAOW2ugDlt5sA5behAOW3ogDlt6UA5bemAOW3sQDlt70A5be+AOW4qADluL0A5bmpAOW5sgDlubPmiJAA5bm0AOW5ugDlubwA5bm/AOW6pgDlurAA5bqzAOW6tgDlu4kA5buKAOW7kgDlu5MA5buZAOW7rADlu7QA5bu+AOW8hADlvIsA5byTAOW8ogDlvZAA5b2TAOW9oQDlvaIA5b2pAOW9qwDlvbMA5b6LAOW+jADlvpcA5b6aAOW+qQDlvq0A5b+DAOW/jQDlv5cA5b+1AOW/uQDmgJIA5oCcAOaBtQDmgoEA5oKUAOaDhwDmg5gA5oOhAOaEiADmhYQA5oWIAOaFjADmhY4A5oWgAOaFqADmhboA5oaOAOaGkADmhqQA5oavAOaGsgDmh54A5oeyAOaHtgDmiIAA5oiIAOaIkADmiJsA5oiuAOaItADmiLYA5omLAOaJkwDmiZ0A5oqVAOaKsQDmi4kA5ouPAOaLkwDmi5QA5ou8AOaLvgDmjIcA5oy9AOaNkADmjZUA5o2oAOaNuwDmjoMA5o6gAOaOqQDmj4QA5o+FAOaPpADmkJwA5pCiAOaRkgDmkakA5pG3AOaRvgDmkpoA5pKdAOaThADmlK8A5pS0AOaVjwDmlZYA5pWsAOaVuADmlocA5paXAOaWmQDmlqQA5pawAOaWuQDml4UA5pegAOaXogDml6MA5pelAOaYjuayuwDmmJMA5pigAOaYreWSjADmmYkA5pm0AOaaiADmmpEA5pqcAOaatADmm4YA5puwAOabtADmm7gA5pyAAOaciADmnIkA5pyXAOacmwDmnKEA5pyoAOadjgDmnZMA5p2WAOadngDmnbsA5p6FAOaelwDmn7MA5p+6AOaglwDmoJ8A5qCqAOagquW8j+S8muekvgDmoZIA5qKBAOaihQDmoo4A5qKoAOaklADmpYIA5qajAOanqgDmqIIA5qiTAOaqqADmq5MA5qubAOashADmrKAA5qyhAOatlADmraIA5q2jAOatsgDmrbcA5q25AOaunwDmrq4A5q6zAOauugDmrrsA5q+LAOavjQDmr5QA5q+bAOawjwDmsJQA5rC0AOaxjgDmsacA5rKIAOayvwDms4wA5rONAOazpQDms6gA5rSWAOa0mwDmtJ4A5rS0AOa0vgDmtYEA5rWpAOa1qgDmtbcA5rW4AOa2hQDmt4sA5reaAOa3qgDmt7kA5riaAOa4rwDmua4A5rqAAOa6nADmuroA5ruHAOa7iwDmu5EA5rubAOa8jwDmvJQA5ryiAOa8owDmva4A5r+GAOa/qwDmv74A54CbAOeAngDngLkA54GKAOeBqwDngbAA54G3AOeBvQDngpkA54KtAOeDiADng5kA54ShAOeFhQDnhYkA54WuAOeGnADnh44A54eQAOeIkADniJsA54ioAOeIqgDniKsA54i1AOeItgDniLsA54i/AOeJhwDniZAA54mZAOeJmwDniaIA54m5AOeKgADnipUA54qsAOeKrwDni4AA54u8AOeMqgDnjbUA5426AOeOhADnjocA546JAOeOiwDnjqUA546yAOePngDnkIYA55CJAOeQogDnkYcA55GcAOeRqQDnkbEA55KFAOeSiQDnkpgA55OKAOeTnADnk6YA55SGAOeUmADnlJ8A55SkAOeUqADnlLAA55SyAOeUswDnlLcA55S7AOeUvgDnlZkA55WlAOeVsADnlosA55aSAOeXogDnmJAA55idAOeYnwDnmYIA55mpAOeZtgDnmb0A55quAOeavwDnm4oA55ubAOebowDnm6cA55uuAOebtADnnIEA55yeAOecnwDnnYAA552KAOeeiwDnnqcA55+bAOefogDnn7MA56GOAOehqwDnoowA56KRAOejigDno4wA56O7AOekqgDnpLoA56S8AOekvgDnpYgA56WJAOelkADnpZYA56WdAOelngDnpaUA56W/AOemgQDnpo0A56aOAOemjwDnpq4A56a4AOemvgDnp4oA56eYAOenqwDnqJwA56mAAOepigDnqY8A56m0AOepugDnqoEA56qxAOeriwDnq64A56u5AOesoADnro8A56+AAOevhgDnr4kA57C+AOexoADnsbMA57G7AOeykgDnsr4A57OSAOezlgDns6MA57OnAOezqADns7gA57SAAOe0kADntKIA57SvAOe1ggDntZsA57WjAOe2oADntr4A57eHAOe3tADnuIIA57iJAOe4twDnuYEA57mFAOe8tgDnvL4A572RAOe9sgDnvbkA5726AOe+hQDnvooA576VAOe+mgDnvr0A57+6AOiAgQDogIUA6ICMAOiAkgDogLMA6IGGAOiBoADoga8A6IGwAOiBvgDogb8A6IKJAOiCiwDogq0A6IKyAOiEgwDohL4A6IeYAOiHowDoh6gA6IeqAOiHrQDoh7MA6Ie8AOiIgQDoiIQA6IiMAOiImADoiJsA6IifAOiJrgDoia8A6ImyAOiJuADoibkA6IqLAOiKkQDoip0A6IqxAOiKswDoir0A6IulAOiLpgDojJ0A6IyjAOiMtgDojZIA6I2TAOiNowDojq0A6I69AOiPiQDoj4oA6I+MAOiPnADoj6cA6I+vAOiPsQDokL0A6JGJAOiRlwDok64A6JOxAOiTswDok7wA6JSWAOiVpADol40A6Je6AOiYhgDomJIA6JitAOiYvwDomY0A6JmQAOiZnADomacA6JmpAOiZqwDomogA6JqpAOibogDonI4A6JyoAOidqwDonbkA6J6GAOieugDon6EA6KCBAOignwDooYAA6KGMAOihoADooaMA6KOCAOijjwDoo5cA6KOeAOijoQDoo7gA6KO6AOikkADopYEA6KWkAOilvgDopoYA6KaLAOimlgDop5IA6KejAOiogADoqqAA6KqqAOiqvwDoq4sA6KuSAOirlgDoq60A6Ku4AOirvgDorIEA6Ky5AOitmADoroAA6K6KAOiwtwDosYYA6LGIAOixlQDosbgA6LKdAOiyoQDosqkA6LKrAOizgQDos4IA6LOHAOiziADos5MA6LSIAOi0mwDotaQA6LWwAOi1twDotrMA6La8AOi3iwDot68A6LewAOi6qwDou4oA6LuUAOi8pgDovKoA6Ly4AOi8uwDovaIA6L6bAOi+ngDovrAA6L61AOi+tgDpgKMA6YC4AOmBigDpgakA6YGyAOmBvADpgo8A6YKRAOmClADpg44A6YOeAOmDsQDpg70A6YSRAOmEmwDphYkA6YWqAOmGmQDphrQA6YeGAOmHjADph48A6YeRAOmItADpiLgA6Ym2AOmJvADpi5cA6YuYAOmMhADpjYoA6Y+5AOmQlQDplbcA6ZaAAOmWiwDplq0A6Za3AOmYnADpmK4A6ZmLAOmZjQDpmbUA6Zm4AOmZvADpmoYA6ZqjAOmatgDpmrcA6Zq4AOmauQDpm4MA6ZuiAOmbowDpm6gA6Zu2AOmbtwDpnKMA6ZyyAOmdiADpnZEA6Z2WAOmdngDpnaIA6Z2pAOmfiwDpn5sA6Z+gAOmfrQDpn7MA6Z+/AOmggQDpoIUA6aCLAOmgmADpoKkA6aC7AOmhngDpoqgA6aObAOmjnwDpo6IA6aOvAOmjvADppKgA6aSpAOmmlgDpppkA6aanAOmmrADpp4IA6aexAOmnvgDpqaoA6aqoAOmrmADpq58A6aySAOmspQDprK8A6ayyAOmsvADprZoA6a2vAOmxgADpsZcA6bOlAOmzvQDptacA6ba0AOm3ugDpuJ4A6bm1AOm5vwDpupcA6bqfAOm6pQDpursA6buDAOm7jQDpu44A6buRAOm7uQDpu70A6bu+AOm8hQDpvI4A6byPAOm8kwDpvJYA6bygAOm8uwDpvYMA6b2KAOm9kgDpvo0A6b6OAOm+nADpvp8A6b6gAOqcpwDqna8A6qy3AOqtkgDqsIAA6rCBAOqwggDqsIMA6rCEAOqwhQDqsIYA6rCHAOqwiADqsIkA6rCKAOqwiwDqsIwA6rCNAOqwjgDqsI8A6rCQAOqwkQDqsJIA6rCTAOqwlADqsJUA6rCWAOqwlwDqsJgA6rCZAOqwmgDqsJsA6rCcAOqwnQDqsJ4A6rCfAOqwoADqsKEA6rCiAOqwowDqsKQA6rClAOqwpgDqsKcA6rCoAOqwqQDqsKoA6rCrAOqwrADqsK0A6rCuAOqwrwDqsLAA6rCxAOqwsgDqsLMA6rC0AOqwtQDqsLYA6rC3AOqwuADqsLkA6rC6AOqwuwDqsLwA6rC9AOqwvgDqsL8A6rGAAOqxgQDqsYIA6rGDAOqxhADqsYUA6rGGAOqxhwDqsYgA6rGJAOqxigDqsYsA6rGMAOqxjQDqsY4A6rGPAOqxkADqsZEA6rGSAOqxkwDqsZQA6rGVAOqxlgDqsZcA6rGYAOqxmQDqsZoA6rGbAOqxnADqsZ0A6rGeAOqxnwDqsaAA6rGhAOqxogDqsaMA6rGkAOqxpQDqsaYA6rGnAOqxqADqsakA6rGqAOqxqwDqsawA6rGtAOqxrgDqsa8A6rGwAOqxsQDqsbIA6rGzAOqxtADqsbUA6rG2AOqxtwDqsbgA6rG5AOqxugDqsbsA6rG8AOqxvQDqsb4A6rG/AOqygADqsoEA6rKCAOqygwDqsoQA6rKFAOqyhgDqsocA6rKIAOqyiQDqsooA6rKLAOqyjADqso0A6rKOAOqyjwDqspAA6rKRAOqykgDqspMA6rKUAOqylQDqspYA6rKXAOqymADqspkA6rKaAOqymwDqspwA6rKdAOqyngDqsp8A6rKgAOqyoQDqsqIA6rKjAOqypADqsqUA6rKmAOqypwDqsqgA6rKpAOqyqgDqsqsA6rKsAOqyrQDqsq4A6rKvAOqysADqsrEA6rKyAOqyswDqsrQA6rK1AOqytgDqsrcA6rK4AOqyuQDqsroA6rK7AOqyvADqsr0A6rK+AOqyvwDqs4AA6rOBAOqzggDqs4MA6rOEAOqzhQDqs4YA6rOHAOqziADqs4kA6rOKAOqziwDqs4wA6rONAOqzjgDqs48A6rOQAOqzkQDqs5IA6rOTAOqzlADqs5UA6rOWAOqzlwDqs5gA6rOZAOqzmgDqs5sA6rOcAOqznQDqs54A6rOfAOqzoADqs6EA6rOiAOqzowDqs6QA6rOlAOqzpgDqs6cA6rOoAOqzqQDqs6oA6rOrAOqzrADqs60A6rOuAOqzrwDqs7AA6rOxAOqzsgDqs7MA6rO0AOqztQDqs7YA6rO3AOqzuADqs7kA6rO6AOqzuwDqs7wA6rO9AOqzvgDqs78A6rSAAOq0gQDqtIIA6rSDAOq0hADqtIUA6rSGAOq0hwDqtIgA6rSJAOq0igDqtIsA6rSMAOq0jQDqtI4A6rSPAOq0kADqtJEA6rSSAOq0kwDqtJQA6rSVAOq0lgDqtJcA6rSYAOq0mQDqtJoA6rSbAOq0nADqtJ0A6rSeAOq0nwDqtKAA6rShAOq0ogDqtKMA6rSkAOq0pQDqtKYA6rSnAOq0qADqtKkA6rSqAOq0qwDqtKwA6rStAOq0rgDqtK8A6rSwAOq0sQDqtLIA6rSzAOq0tADqtLUA6rS2AOq0twDqtLgA6rS5AOq0ugDqtLsA6rS8AOq0vQDqtL4A6rS/AOq1gADqtYEA6rWCAOq1gwDqtYQA6rWFAOq1hgDqtYcA6rWIAOq1iQDqtYoA6rWLAOq1jADqtY0A6rWOAOq1jwDqtZAA6rWRAOq1kgDqtZMA6rWUAOq1lQDqtZYA6rWXAOq1mADqtZkA6rWaAOq1mwDqtZwA6rWdAOq1ngDqtZ8A6rWgAOq1oQDqtaIA6rWjAOq1pADqtaUA6rWmAOq1pwDqtagA6rWpAOq1qgDqtasA6rWsAOq1rQDqta4A6rWvAOq1sADqtbEA6rWyAOq1swDqtbQA6rW1AOq1tgDqtbcA6rW4AOq1uQDqtboA6rW7AOq1vADqtb0A6rW+AOq1vwDqtoAA6raBAOq2ggDqtoMA6raEAOq2hQDqtoYA6raHAOq2iADqtokA6raKAOq2iwDqtowA6raNAOq2jgDqto8A6raQAOq2kQDqtpIA6raTAOq2lADqtpUA6raWAOq2lwDqtpgA6raZAOq2mgDqtpsA6racAOq2nQDqtp4A6rafAOq2oADqtqEA6raiAOq2owDqtqQA6ralAOq2pgDqtqcA6raoAOq2qQDqtqoA6rarAOq2rADqtq0A6rauAOq2rwDqtrAA6raxAOq2sgDqtrMA6ra0AOq2tQDqtrYA6ra3AOq2uADqtrkA6ra6AOq2uwDqtrwA6ra9AOq2vgDqtr8A6reAAOq3gQDqt4IA6reDAOq3hADqt4UA6reGAOq3hwDqt4gA6reJAOq3igDqt4sA6reMAOq3jQDqt44A6rePAOq3kADqt5EA6reSAOq3kwDqt5QA6reVAOq3lgDqt5cA6reYAOq3mQDqt5oA6rebAOq3nADqt50A6reeAOq3nwDqt6AA6rehAOq3ogDqt6MA6rekAOq3pQDqt6YA6renAOq3qADqt6kA6reqAOq3qwDqt6wA6retAOq3rgDqt68A6rewAOq3sQDqt7IA6rezAOq3tADqt7UA6re2AOq3twDqt7gA6re5AOq3ugDqt7sA6re8AOq3vQDqt74A6re/AOq4gADquIEA6riCAOq4gwDquIQA6riFAOq4hgDquIcA6riIAOq4iQDquIoA6riLAOq4jADquI0A6riOAOq4jwDquJAA6riRAOq4kgDquJMA6riUAOq4lQDquJYA6riXAOq4mADquJkA6riaAOq4mwDquJwA6ridAOq4ngDquJ8A6rigAOq4oQDquKIA6rijAOq4pADquKUA6rimAOq4pwDquKgA6ripAOq4qgDquKsA6risAOq4rQDquK4A6rivAOq4sADquLEA6riyAOq4swDquLQA6ri1AOq4tgDquLcA6ri4AOq4uQDquLoA6ri7AOq4vADquL0A6ri+AOq4vwDquYAA6rmBAOq5ggDquYMA6rmEAOq5hQDquYYA6rmHAOq5iADquYkA6rmKAOq5iwDquYwA6rmNAOq5jgDquY8A6rmQAOq5kQDquZIA6rmTAOq5lADquZUA6rmWAOq5lwDquZgA6rmZAOq5mgDquZsA6rmcAOq5nQDquZ4A6rmfAOq5oADquaEA6rmiAOq5owDquaQA6rmlAOq5pgDquacA6rmoAOq5qQDquaoA6rmrAOq5rADqua0A6rmuAOq5rwDqubAA6rmxAOq5sgDqubMA6rm0AOq5tQDqubYA6rm3AOq5uADqubkA6rm6AOq5uwDqubwA6rm9AOq5vgDqub8A6rqAAOq6gQDquoIA6rqDAOq6hADquoUA6rqGAOq6hwDquogA6rqJAOq6igDquosA6rqMAOq6jQDquo4A6rqPAOq6kADqupEA6rqSAOq6kwDqupQA6rqVAOq6lgDqupcA6rqYAOq6mQDqupoA6rqbAOq6nADqup0A6rqeAOq6nwDquqAA6rqhAOq6ogDquqMA6rqkAOq6pQDquqYA6rqnAOq6qADquqkA6rqqAOq6qwDquqwA6rqtAOq6rgDquq8A6rqwAOq6sQDqurIA6rqzAOq6tADqurUA6rq2AOq6twDqurgA6rq5AOq6ugDqursA6rq8AOq6vQDqur4A6rq/AOq7gADqu4EA6ruCAOq7gwDqu4QA6ruFAOq7hgDqu4cA6ruIAOq7iQDqu4oA6ruLAOq7jADqu40A6ruOAOq7jwDqu5AA6ruRAOq7kgDqu5MA6ruUAOq7lQDqu5YA6ruXAOq7mADqu5kA6ruaAOq7mwDqu5wA6rudAOq7ngDqu58A6rugAOq7oQDqu6IA6rujAOq7pADqu6UA6rumAOq7pwDqu6gA6rupAOq7qgDqu6sA6rusAOq7rQDqu64A6ruvAOq7sADqu7EA6ruyAOq7swDqu7QA6ru1AOq7tgDqu7cA6ru4AOq7uQDqu7oA6ru7AOq7vADqu70A6ru+AOq7vwDqvIAA6ryBAOq8ggDqvIMA6ryEAOq8hQDqvIYA6ryHAOq8iADqvIkA6ryKAOq8iwDqvIwA6ryNAOq8jgDqvI8A6ryQAOq8kQDqvJIA6ryTAOq8lADqvJUA6ryWAOq8lwDqvJgA6ryZAOq8mgDqvJsA6rycAOq8nQDqvJ4A6ryfAOq8oADqvKEA6ryiAOq8owDqvKQA6rylAOq8pgDqvKcA6ryoAOq8qQDqvKoA6ryrAOq8rADqvK0A6ryuAOq8rwDqvLAA6ryxAOq8sgDqvLMA6ry0AOq8tQDqvLYA6ry3AOq8uADqvLkA6ry6AOq8uwDqvLwA6ry9AOq8vgDqvL8A6r2AAOq9gQDqvYIA6r2DAOq9hADqvYUA6r2GAOq9hwDqvYgA6r2JAOq9igDqvYsA6r2MAOq9jQDqvY4A6r2PAOq9kADqvZEA6r2SAOq9kwDqvZQA6r2VAOq9lgDqvZcA6r2YAOq9mQDqvZoA6r2bAOq9nADqvZ0A6r2eAOq9nwDqvaAA6r2hAOq9ogDqvaMA6r2kAOq9pQDqvaYA6r2nAOq9qADqvakA6r2qAOq9qwDqvawA6r2tAOq9rgDqva8A6r2wAOq9sQDqvbIA6r2zAOq9tADqvbUA6r22AOq9twDqvbgA6r25AOq9ugDqvbsA6r28AOq9vQDqvb4A6r2/AOq+gADqvoEA6r6CAOq+gwDqvoQA6r6FAOq+hgDqvocA6r6IAOq+iQDqvooA6r6LAOq+jADqvo0A6r6OAOq+jwDqvpAA6r6RAOq+kgDqvpMA6r6UAOq+lQDqvpYA6r6XAOq+mADqvpkA6r6aAOq+mwDqvpwA6r6dAOq+ngDqvp8A6r6gAOq+oQDqvqIA6r6jAOq+pADqvqUA6r6mAOq+pwDqvqgA6r6pAOq+qgDqvqsA6r6sAOq+rQDqvq4A6r6vAOq+sADqvrEA6r6yAOq+swDqvrQA6r61AOq+tgDqvrcA6r64AOq+uQDqvroA6r67AOq+vADqvr0A6r6+AOq+vwDqv4AA6r+BAOq/ggDqv4MA6r+EAOq/hQDqv4YA6r+HAOq/iADqv4kA6r+KAOq/iwDqv4wA6r+NAOq/jgDqv48A6r+QAOq/kQDqv5IA6r+TAOq/lADqv5UA6r+WAOq/lwDqv5gA6r+ZAOq/mgDqv5sA6r+cAOq/nQDqv54A6r+fAOq/oADqv6EA6r+iAOq/owDqv6QA6r+lAOq/pgDqv6cA6r+oAOq/qQDqv6oA6r+rAOq/rADqv60A6r+uAOq/rwDqv7AA6r+xAOq/sgDqv7MA6r+0AOq/tQDqv7YA6r+3AOq/uADqv7kA6r+6AOq/uwDqv7wA6r+9AOq/vgDqv78A64CAAOuAgQDrgIIA64CDAOuAhADrgIUA64CGAOuAhwDrgIgA64CJAOuAigDrgIsA64CMAOuAjQDrgI4A64CPAOuAkADrgJEA64CSAOuAkwDrgJQA64CVAOuAlgDrgJcA64CYAOuAmQDrgJoA64CbAOuAnADrgJ0A64CeAOuAnwDrgKAA64ChAOuAogDrgKMA64CkAOuApQDrgKYA64CnAOuAqADrgKkA64CqAOuAqwDrgKwA64CtAOuArgDrgK8A64CwAOuAsQDrgLIA64CzAOuAtADrgLUA64C2AOuAtwDrgLgA64C5AOuAugDrgLsA64C8AOuAvQDrgL4A64C/AOuBgADrgYEA64GCAOuBgwDrgYQA64GFAOuBhgDrgYcA64GIAOuBiQDrgYoA64GLAOuBjADrgY0A64GOAOuBjwDrgZAA64GRAOuBkgDrgZMA64GUAOuBlQDrgZYA64GXAOuBmADrgZkA64GaAOuBmwDrgZwA64GdAOuBngDrgZ8A64GgAOuBoQDrgaIA64GjAOuBpADrgaUA64GmAOuBpwDrgagA64GpAOuBqgDrgasA64GsAOuBrQDrga4A64GvAOuBsADrgbEA64GyAOuBswDrgbQA64G1AOuBtgDrgbcA64G4AOuBuQDrgboA64G7AOuBvADrgb0A64G+AOuBvwDrgoAA64KBAOuCggDrgoMA64KEAOuChQDrgoYA64KHAOuCiADrgokA64KKAOuCiwDrgowA64KNAOuCjgDrgo8A64KQAOuCkQDrgpIA64KTAOuClADrgpUA64KWAOuClwDrgpgA64KZAOuCmgDrgpsA64KcAOuCnQDrgp4A64KfAOuCoADrgqEA64KiAOuCowDrgqQA64KlAOuCpgDrgqcA64KoAOuCqQDrgqoA64KrAOuCrADrgq0A64KuAOuCrwDrgrAA64KxAOuCsgDrgrMA64K0AOuCtQDrgrYA64K3AOuCuADrgrkA64K6AOuCuwDrgrwA64K9AOuCvgDrgr8A64OAAOuDgQDrg4IA64ODAOuDhADrg4UA64OGAOuDhwDrg4gA64OJAOuDigDrg4sA64OMAOuDjQDrg44A64OPAOuDkADrg5EA64OSAOuDkwDrg5QA64OVAOuDlgDrg5cA64OYAOuDmQDrg5oA64ObAOuDnADrg50A64OeAOuDnwDrg6AA64OhAOuDogDrg6MA64OkAOuDpQDrg6YA64OnAOuDqADrg6kA64OqAOuDqwDrg6wA64OtAOuDrgDrg68A64OwAOuDsQDrg7IA64OzAOuDtADrg7UA64O2AOuDtwDrg7gA64O5AOuDugDrg7sA64O8AOuDvQDrg74A64O/AOuEgADrhIEA64SCAOuEgwDrhIQA64SFAOuEhgDrhIcA64SIAOuEiQDrhIoA64SLAOuEjADrhI0A64SOAOuEjwDrhJAA64SRAOuEkgDrhJMA64SUAOuElQDrhJYA64SXAOuEmADrhJkA64SaAOuEmwDrhJwA64SdAOuEngDrhJ8A64SgAOuEoQDrhKIA64SjAOuEpADrhKUA64SmAOuEpwDrhKgA64SpAOuEqgDrhKsA64SsAOuErQDrhK4A64SvAOuEsADrhLEA64SyAOuEswDrhLQA64S1AOuEtgDrhLcA64S4AOuEuQDrhLoA64S7AOuEvADrhL0A64S+AOuEvwDrhYAA64WBAOuFggDrhYMA64WEAOuFhQDrhYYA64WHAOuFiADrhYkA64WKAOuFiwDrhYwA64WNAOuFjgDrhY8A64WQAOuFkQDrhZIA64WTAOuFlADrhZUA64WWAOuFlwDrhZgA64WZAOuFmgDrhZsA64WcAOuFnQDrhZ4A64WfAOuFoADrhaEA64WiAOuFowDrhaQA64WlAOuFpgDrhacA64WoAOuFqQDrhaoA64WrAOuFrADrha0A64WuAOuFrwDrhbAA64WxAOuFsgDrhbMA64W0AOuFtQDrhbYA64W3AOuFuADrhbkA64W6AOuFuwDrhbwA64W9AOuFvgDrhb8A64aAAOuGgQDrhoIA64aDAOuGhADrhoUA64aGAOuGhwDrhogA64aJAOuGigDrhosA64aMAOuGjQDrho4A64aPAOuGkADrhpEA64aSAOuGkwDrhpQA64aVAOuGlgDrhpcA64aYAOuGmQDrhpoA64abAOuGnADrhp0A64aeAOuGnwDrhqAA64ahAOuGogDrhqMA64akAOuGpQDrhqYA64anAOuGqADrhqkA64aqAOuGqwDrhqwA64atAOuGrgDrhq8A64awAOuGsQDrhrIA64azAOuGtADrhrUA64a2AOuGtwDrhrgA64a5AOuGugDrhrsA64a8AOuGvQDrhr4A64a/AOuHgADrh4EA64eCAOuHgwDrh4QA64eFAOuHhgDrh4cA64eIAOuHiQDrh4oA64eLAOuHjADrh40A64eOAOuHjwDrh5AA64eRAOuHkgDrh5MA64eUAOuHlQDrh5YA64eXAOuHmADrh5kA64eaAOuHmwDrh5wA64edAOuHngDrh58A64egAOuHoQDrh6IA64ejAOuHpADrh6UA64emAOuHpwDrh6gA64epAOuHqgDrh6sA64esAOuHrQDrh64A64evAOuHsADrh7EA64eyAOuHswDrh7QA64e1AOuHtgDrh7cA64e4AOuHuQDrh7oA64e7AOuHvADrh70A64e+AOuHvwDriIAA64iBAOuIggDriIMA64iEAOuIhQDriIYA64iHAOuIiADriIkA64iKAOuIiwDriIwA64iNAOuIjgDriI8A64iQAOuIkQDriJIA64iTAOuIlADriJUA64iWAOuIlwDriJgA64iZAOuImgDriJsA64icAOuInQDriJ4A64ifAOuIoADriKEA64iiAOuIowDriKQA64ilAOuIpgDriKcA64ioAOuIqQDriKoA64irAOuIrADriK0A64iuAOuIrwDriLAA64ixAOuIsgDriLMA64i0AOuItQDriLYA64i3AOuIuADriLkA64i6AOuIuwDriLwA64i9AOuIvgDriL8A64mAAOuJgQDriYIA64mDAOuJhADriYUA64mGAOuJhwDriYgA64mJAOuJigDriYsA64mMAOuJjQDriY4A64mPAOuJkADriZEA64mSAOuJkwDriZQA64mVAOuJlgDriZcA64mYAOuJmQDriZoA64mbAOuJnADriZ0A64meAOuJnwDriaAA64mhAOuJogDriaMA64mkAOuJpQDriaYA64mnAOuJqADriakA64mqAOuJqwDriawA64mtAOuJrgDria8A64mwAOuJsQDribIA64mzAOuJtADribUA64m2AOuJtwDribgA64m5AOuJugDribsA64m8AOuJvQDrib4A64m/AOuKgADrioEA64qCAOuKgwDrioQA64qFAOuKhgDriocA64qIAOuKiQDriooA64qLAOuKjADrio0A64qOAOuKjwDripAA64qRAOuKkgDripMA64qUAOuKlQDripYA64qXAOuKmADripkA64qaAOuKmwDripwA64qdAOuKngDrip8A64qgAOuKoQDriqIA64qjAOuKpADriqUA64qmAOuKpwDriqgA64qpAOuKqgDriqsA64qsAOuKrQDriq4A64qvAOuKsADrirEA64qyAOuKswDrirQA64q1AOuKtgDrircA64q4AOuKuQDriroA64q7AOuKvADrir0A64q+AOuKvwDri4AA64uBAOuLggDri4MA64uEAOuLhQDri4YA64uHAOuLiADri4kA64uKAOuLiwDri4wA64uNAOuLjgDri48A64uQAOuLkQDri5IA64uTAOuLlADri5UA64uWAOuLlwDri5gA64uZAOuLmgDri5sA64ucAOuLnQDri54A64ufAOuLoADri6EA64uiAOuLowDri6QA64ulAOuLpgDri6cA64uoAOuLqQDri6oA64urAOuLrADri60A64uuAOuLrwDri7AA64uxAOuLsgDri7MA64u0AOuLtQDri7YA64u3AOuLuADri7kA64u6AOuLuwDri7wA64u9AOuLvgDri78A64yAAOuMgQDrjIIA64yDAOuMhADrjIUA64yGAOuMhwDrjIgA64yJAOuMigDrjIsA64yMAOuMjQDrjI4A64yPAOuMkADrjJEA64ySAOuMkwDrjJQA64yVAOuMlgDrjJcA64yYAOuMmQDrjJoA64ybAOuMnADrjJ0A64yeAOuMnwDrjKAA64yhAOuMogDrjKMA64ykAOuMpQDrjKYA64ynAOuMqADrjKkA64yqAOuMqwDrjKwA64ytAOuMrgDrjK8A64ywAOuMsQDrjLIA64yzAOuMtADrjLUA64y2AOuMtwDrjLgA64y5AOuMugDrjLsA64y8AOuMvQDrjL4A64y/AOuNgADrjYEA642CAOuNgwDrjYQA642FAOuNhgDrjYcA642IAOuNiQDrjYoA642LAOuNjADrjY0A642OAOuNjwDrjZAA642RAOuNkgDrjZMA642UAOuNlQDrjZYA642XAOuNmADrjZkA642aAOuNmwDrjZwA642dAOuNngDrjZ8A642gAOuNoQDrjaIA642jAOuNpADrjaUA642mAOuNpwDrjagA642pAOuNqgDrjasA642sAOuNrQDrja4A642vAOuNsADrjbEA642yAOuNswDrjbQA6421AOuNtgDrjbcA6424AOuNuQDrjboA6427AOuNvADrjb0A642+AOuNvwDrjoAA646BAOuOggDrjoMA646EAOuOhQDrjoYA646HAOuOiADrjokA646KAOuOiwDrjowA646NAOuOjgDrjo8A646QAOuOkQDrjpIA646TAOuOlADrjpUA646WAOuOlwDrjpgA646ZAOuOmgDrjpsA646cAOuOnQDrjp4A646fAOuOoADrjqEA646iAOuOowDrjqQA646lAOuOpgDrjqcA646oAOuOqQDrjqoA646rAOuOrADrjq0A646uAOuOrwDrjrAA646xAOuOsgDrjrMA6460AOuOtQDrjrYA6463AOuOuADrjrkA6466AOuOuwDrjrwA6469AOuOvgDrjr8A64+AAOuPgQDrj4IA64+DAOuPhADrj4UA64+GAOuPhwDrj4gA64+JAOuPigDrj4sA64+MAOuPjQDrj44A64+PAOuPkADrj5EA64+SAOuPkwDrj5QA64+VAOuPlgDrj5cA64+YAOuPmQDrj5oA64+bAOuPnADrj50A64+eAOuPnwDrj6AA64+hAOuPogDrj6MA64+kAOuPpQDrj6YA64+nAOuPqADrj6kA64+qAOuPqwDrj6wA64+tAOuPrgDrj68A64+wAOuPsQDrj7IA64+zAOuPtADrj7UA64+2AOuPtwDrj7gA64+5AOuPugDrj7sA64+8AOuPvQDrj74A64+/AOuQgADrkIEA65CCAOuQgwDrkIQA65CFAOuQhgDrkIcA65CIAOuQiQDrkIoA65CLAOuQjADrkI0A65COAOuQjwDrkJAA65CRAOuQkgDrkJMA65CUAOuQlQDrkJYA65CXAOuQmADrkJkA65CaAOuQmwDrkJwA65CdAOuQngDrkJ8A65CgAOuQoQDrkKIA65CjAOuQpADrkKUA65CmAOuQpwDrkKgA65CpAOuQqgDrkKsA65CsAOuQrQDrkK4A65CvAOuQsADrkLEA65CyAOuQswDrkLQA65C1AOuQtgDrkLcA65C4AOuQuQDrkLoA65C7AOuQvADrkL0A65C+AOuQvwDrkYAA65GBAOuRggDrkYMA65GEAOuRhQDrkYYA65GHAOuRiADrkYkA65GKAOuRiwDrkYwA65GNAOuRjgDrkY8A65GQAOuRkQDrkZIA65GTAOuRlADrkZUA65GWAOuRlwDrkZgA65GZAOuRmgDrkZsA65GcAOuRnQDrkZ4A65GfAOuRoADrkaEA65GiAOuRowDrkaQA65GlAOuRpgDrkacA65GoAOuRqQDrkaoA65GrAOuRrADrka0A65GuAOuRrwDrkbAA65GxAOuRsgDrkbMA65G0AOuRtQDrkbYA65G3AOuRuADrkbkA65G6AOuRuwDrkbwA65G9AOuRvgDrkb8A65KAAOuSgQDrkoIA65KDAOuShADrkoUA65KGAOuShwDrkogA65KJAOuSigDrkosA65KMAOuSjQDrko4A65KPAOuSkADrkpEA65KSAOuSkwDrkpQA65KVAOuSlgDrkpcA65KYAOuSmQDrkpoA65KbAOuSnADrkp0A65KeAOuSnwDrkqAA65KhAOuSogDrkqMA65KkAOuSpQDrkqYA65KnAOuSqADrkqkA65KqAOuSqwDrkqwA65KtAOuSrgDrkq8A65KwAOuSsQDrkrIA65KzAOuStADrkrUA65K2AOuStwDrkrgA65K5AOuSugDrkrsA65K8AOuSvQDrkr4A65K/AOuTgADrk4EA65OCAOuTgwDrk4QA65OFAOuThgDrk4cA65OIAOuTiQDrk4oA65OLAOuTjADrk40A65OOAOuTjwDrk5AA65ORAOuTkgDrk5MA65OUAOuTlQDrk5YA65OXAOuTmADrk5kA65OaAOuTmwDrk5wA65OdAOuTngDrk58A65OgAOuToQDrk6IA65OjAOuTpADrk6UA65OmAOuTpwDrk6gA65OpAOuTqgDrk6sA65OsAOuTrQDrk64A65OvAOuTsADrk7EA65OyAOuTswDrk7QA65O1AOuTtgDrk7cA65O4AOuTuQDrk7oA65O7AOuTvADrk70A65O+AOuTvwDrlIAA65SBAOuUggDrlIMA65SEAOuUhQDrlIYA65SHAOuUiADrlIkA65SKAOuUiwDrlIwA65SNAOuUjgDrlI8A65SQAOuUkQDrlJIA65STAOuUlADrlJUA65SWAOuUlwDrlJgA65SZAOuUmgDrlJsA65ScAOuUnQDrlJ4A65SfAOuUoADrlKEA65SiAOuUowDrlKQA65SlAOuUpgDrlKcA65SoAOuUqQDrlKoA65SrAOuUrADrlK0A65SuAOuUrwDrlLAA65SxAOuUsgDrlLMA65S0AOuUtQDrlLYA65S3AOuUuADrlLkA65S6AOuUuwDrlLwA65S9AOuUvgDrlL8A65WAAOuVgQDrlYIA65WDAOuVhADrlYUA65WGAOuVhwDrlYgA65WJAOuVigDrlYsA65WMAOuVjQDrlY4A65WPAOuVkADrlZEA65WSAOuVkwDrlZQA65WVAOuVlgDrlZcA65WYAOuVmQDrlZoA65WbAOuVnADrlZ0A65WeAOuVnwDrlaAA65WhAOuVogDrlaMA65WkAOuVpQDrlaYA65WnAOuVqADrlakA65WqAOuVqwDrlawA65WtAOuVrgDrla8A65WwAOuVsQDrlbIA65WzAOuVtADrlbUA65W2AOuVtwDrlbgA65W5AOuVugDrlbsA65W8AOuVvQDrlb4A65W/AOuWgADrloEA65aCAOuWgwDrloQA65aFAOuWhgDrlocA65aIAOuWiQDrlooA65aLAOuWjADrlo0A65aOAOuWjwDrlpAA65aRAOuWkgDrlpMA65aUAOuWlQDrlpYA65aXAOuWmADrlpkA65aaAOuWmwDrlpwA65adAOuWngDrlp8A65agAOuWoQDrlqIA65ajAOuWpADrlqUA65amAOuWpwDrlqgA65apAOuWqgDrlqsA65asAOuWrQDrlq4A65avAOuWsADrlrEA65ayAOuWswDrlrQA65a1AOuWtgDrlrcA65a4AOuWuQDrlroA65a7AOuWvADrlr0A65a+AOuWvwDrl4AA65eBAOuXggDrl4MA65eEAOuXhQDrl4YA65eHAOuXiADrl4kA65eKAOuXiwDrl4wA65eNAOuXjgDrl48A65eQAOuXkQDrl5IA65eTAOuXlADrl5UA65eWAOuXlwDrl5gA65eZAOuXmgDrl5sA65ecAOuXnQDrl54A65efAOuXoADrl6EA65eiAOuXowDrl6QA65elAOuXpgDrl6cA65eoAOuXqQDrl6oA65erAOuXrADrl60A65euAOuXrwDrl7AA65exAOuXsgDrl7MA65e0AOuXtQDrl7YA65e3AOuXuADrl7kA65e6AOuXuwDrl7wA65e9AOuXvgDrl78A65iAAOuYgQDrmIIA65iDAOuYhADrmIUA65iGAOuYhwDrmIgA65iJAOuYigDrmIsA65iMAOuYjQDrmI4A65iPAOuYkADrmJEA65iSAOuYkwDrmJQA65iVAOuYlgDrmJcA65iYAOuYmQDrmJoA65ibAOuYnADrmJ0A65ieAOuYnwDrmKAA65ihAOuYogDrmKMA65ikAOuYpQDrmKYA65inAOuYqADrmKkA65iqAOuYqwDrmKwA65itAOuYrgDrmK8A65iwAOuYsQDrmLIA65izAOuYtADrmLUA65i2AOuYtwDrmLgA65i5AOuYugDrmLsA65i8AOuYvQDrmL4A65i/AOuZgADrmYEA65mCAOuZgwDrmYQA65mFAOuZhgDrmYcA65mIAOuZiQDrmYoA65mLAOuZjADrmY0A65mOAOuZjwDrmZAA65mRAOuZkgDrmZMA65mUAOuZlQDrmZYA65mXAOuZmADrmZkA65maAOuZmwDrmZwA65mdAOuZngDrmZ8A65mgAOuZoQDrmaIA65mjAOuZpADrmaUA65mmAOuZpwDrmagA65mpAOuZqgDrmasA65msAOuZrQDrma4A65mvAOuZsADrmbEA65myAOuZswDrmbQA65m1AOuZtgDrmbcA65m4AOuZuQDrmboA65m7AOuZvADrmb0A65m+AOuZvwDrmoAA65qBAOuaggDrmoMA65qEAOuahQDrmoYA65qHAOuaiADrmokA65qKAOuaiwDrmowA65qNAOuajgDrmo8A65qQAOuakQDrmpIA65qTAOualADrmpUA65qWAOualwDrmpgA65qZAOuamgDrmpsA65qcAOuanQDrmp4A65qfAOuaoADrmqEA65qiAOuaowDrmqQA65qlAOuapgDrmqcA65qoAOuaqQDrmqoA65qrAOuarADrmq0A65quAOuarwDrmrAA65qxAOuasgDrmrMA65q0AOuatQDrmrYA65q3AOuauADrmrkA65q6AOuauwDrmrwA65q9AOuavgDrmr8A65uAAOubgQDrm4IA65uDAOubhADrm4UA65uGAOubhwDrm4gA65uJAOubigDrm4sA65uMAOubjQDrm44A65uPAOubkADrm5EA65uSAOubkwDrm5QA65uVAOublgDrm5cA65uYAOubmQDrm5oA65ubAOubnADrm50A65ueAOubnwDrm6AA65uhAOubogDrm6MA65ukAOubpQDrm6YA65unAOubqADrm6kA65uqAOubqwDrm6wA65utAOubrgDrm68A65uwAOubsQDrm7IA65uzAOubtADrm7UA65u2AOubtwDrm7gA65u5AOubugDrm7sA65u8AOubvQDrm74A65u/AOucgADrnIEA65yCAOucgwDrnIQA65yFAOuchgDrnIcA65yIAOuciQDrnIoA65yLAOucjADrnI0A65yOAOucjwDrnJAA65yRAOuckgDrnJMA65yUAOuclQDrnJYA65yXAOucmADrnJkA65yaAOucmwDrnJwA65ydAOucngDrnJ8A65ygAOucoQDrnKIA65yjAOucpADrnKUA65ymAOucpwDrnKgA65ypAOucqgDrnKsA65ysAOucrQDrnK4A65yvAOucsADrnLEA65yyAOucswDrnLQA65y1AOuctgDrnLcA65y4AOucuQDrnLoA65y7AOucvADrnL0A65y+AOucvwDrnYAA652BAOudggDrnYMA652EAOudhQDrnYYA652HAOudiADrnYkA652KAOudiwDrnYwA652NAOudjgDrnY8A652QAOudkQDrnZIA652TAOudlADrnZUA652WAOudlwDrnZgA652ZAOudmgDrnZsA652cAOudnQDrnZ4A652fAOudoADrnaEA652iAOudowDrnaQA652lAOudpgDrnacA652oAOudqQDrnaoA652rAOudrADrna0A652uAOudrwDrnbAA652xAOudsgDrnbMA6520AOudtQDrnbYA6523AOuduADrnbkA6526AOuduwDrnbwA6529AOudvgDrnb8A656AAOuegQDrnoIA656DAOuehADrnoUA656GAOuehwDrnogA656JAOueigDrnosA656MAOuejQDrno4A656PAOuekADrnpEA656SAOuekwDrnpQA656VAOuelgDrnpcA656YAOuemQDrnpoA656bAOuenADrnp0A656eAOuenwDrnqAA656hAOueogDrnqMA656kAOuepQDrnqYA656nAOueqADrnqkA656qAOueqwDrnqwA656tAOuergDrnq8A656wAOuesQDrnrIA656zAOuetADrnrUA6562AOuetwDrnrgA6565AOueugDrnrsA6568AOuevQDrnr4A656/AOufgADrn4EA65+CAOufgwDrn4QA65+FAOufhgDrn4cA65+IAOufiQDrn4oA65+LAOufjADrn40A65+OAOufjwDrn5AA65+RAOufkgDrn5MA65+UAOuflQDrn5YA65+XAOufmADrn5kA65+aAOufmwDrn5wA65+dAOufngDrn58A65+gAOufoQDrn6IA65+jAOufpADrn6UA65+mAOufpwDrn6gA65+pAOufqgDrn6sA65+sAOufrQDrn64A65+vAOufsADrn7EA65+yAOufswDrn7QA65+1AOuftgDrn7cA65+4AOufuQDrn7oA65+7AOufvADrn70A65++AOufvwDroIAA66CBAOugggDroIMA66CEAOughQDroIYA66CHAOugiADroIkA66CKAOugiwDroIwA66CNAOugjgDroI8A66CQAOugkQDroJIA66CTAOuglADroJUA66CWAOuglwDroJgA66CZAOugmgDroJsA66CcAOugnQDroJ4A66CfAOugoADroKEA66CiAOugowDroKQA66ClAOugpgDroKcA66CoAOugqQDroKoA66CrAOugrADroK0A66CuAOugrwDroLAA66CxAOugsgDroLMA66C0AOugtQDroLYA66C3AOuguADroLkA66C6AOuguwDroLwA66C9AOugvgDroL8A66GAAOuhgQDroYIA66GDAOuhhADroYUA66GGAOuhhwDroYgA66GJAOuhigDroYsA66GMAOuhjQDroY4A66GPAOuhkADroZEA66GSAOuhkwDroZQA66GVAOuhlgDroZcA66GYAOuhmQDroZoA66GbAOuhnADroZ0A66GeAOuhnwDroaAA66GhAOuhogDroaMA66GkAOuhpQDroaYA66GnAOuhqADroakA66GqAOuhqwDroawA66GtAOuhrgDroa8A66GwAOuhsQDrobIA66GzAOuhtADrobUA66G2AOuhtwDrobgA66G5AOuhugDrobsA66G8AOuhvQDrob4A66G/AOuigADrooEA66KCAOuigwDrooQA66KFAOuihgDroocA66KIAOuiiQDroooA66KLAOuijADroo0A66KOAOuijwDropAA66KRAOuikgDropMA66KUAOuilQDropYA66KXAOuimADropkA66KaAOuimwDropwA66KdAOuingDrop8A66KgAOuioQDroqIA66KjAOuipADroqUA66KmAOuipwDroqgA66KpAOuiqgDroqsA66KsAOuirQDroq4A66KvAOuisADrorEA66KyAOuiswDrorQA66K1AOuitgDrorcA66K4AOuiuQDroroA66K7AOuivADror0A66K+AOuivwDro4AA66OBAOujggDro4MA66OEAOujhQDro4YA66OHAOujiADro4kA66OKAOujiwDro4wA66ONAOujjgDro48A66OQAOujkQDro5IA66OTAOujlADro5UA66OWAOujlwDro5gA66OZAOujmgDro5sA66OcAOujnQDro54A66OfAOujoADro6EA66OiAOujowDro6QA66OlAOujpgDro6cA66OoAOujqQDro6oA66OrAOujrADro60A66OuAOujrwDro7AA66OxAOujsgDro7MA66O0AOujtQDro7YA66O3AOujuADro7kA66O6AOujuwDro7wA66O9AOujvgDro78A66SAAOukgQDrpIIA66SDAOukhADrpIUA66SGAOukhwDrpIgA66SJAOukigDrpIsA66SMAOukjQDrpI4A66SPAOukkADrpJEA66SSAOukkwDrpJQA66SVAOuklgDrpJcA66SYAOukmQDrpJoA66SbAOuknADrpJ0A66SeAOuknwDrpKAA66ShAOukogDrpKMA66SkAOukpQDrpKYA66SnAOukqADrpKkA66SqAOukqwDrpKwA66StAOukrgDrpK8A66SwAOuksQDrpLIA66SzAOuktADrpLUA66S2AOuktwDrpLgA66S5AOukugDrpLsA66S8AOukvQDrpL4A66S/AOulgADrpYEA66WCAOulgwDrpYQA66WFAOulhgDrpYcA66WIAOuliQDrpYoA66WLAOuljADrpY0A66WOAOuljwDrpZAA66WRAOulkgDrpZMA66WUAOullQDrpZYA66WXAOulmADrpZkA66WaAOulmwDrpZwA66WdAOulngDrpZ8A66WgAOuloQDrpaIA66WjAOulpADrpaUA66WmAOulpwDrpagA66WpAOulqgDrpasA66WsAOulrQDrpa4A66WvAOulsADrpbEA66WyAOulswDrpbQA66W1AOultgDrpbcA66W4AOuluQDrpboA66W7AOulvADrpb0A66W+AOulvwDrpoAA66aBAOumggDrpoMA66aEAOumhQDrpoYA66aHAOumiADrpokA66aKAOumiwDrpowA66aNAOumjgDrpo8A66aQAOumkQDrppIA66aTAOumlADrppUA66aWAOumlwDrppgA66aZAOummgDrppsA66acAOumnQDrpp4A66afAOumoADrpqEA66aiAOumowDrpqQA66alAOumpgDrpqcA66aoAOumqQDrpqoA66arAOumrADrpq0A66auAOumrwDrprAA66axAOumsgDrprMA66a0AOumtQDrprYA66a3AOumuADrprkA66a6AOumuwDrprwA66a9AOumvgDrpr8A66eAAOungQDrp4IA66eDAOunhADrp4UA66eGAOunhwDrp4gA66eJAOunigDrp4sA66eMAOunjQDrp44A66ePAOunkADrp5EA66eSAOunkwDrp5QA66eVAOunlgDrp5cA66eYAOunmQDrp5oA66ebAOunnADrp50A66eeAOunnwDrp6AA66ehAOunogDrp6MA66ekAOunpQDrp6YA66enAOunqADrp6kA66eqAOunqwDrp6wA66etAOunrgDrp68A66ewAOunsQDrp7IA66ezAOuntADrp7UA66e2AOuntwDrp7gA66e5AOunugDrp7sA66e8AOunvQDrp74A66e/AOuogADrqIEA66iCAOuogwDrqIQA66iFAOuohgDrqIcA66iIAOuoiQDrqIoA66iLAOuojADrqI0A66iOAOuojwDrqJAA66iRAOuokgDrqJMA66iUAOuolQDrqJYA66iXAOuomADrqJkA66iaAOuomwDrqJwA66idAOuongDrqJ8A66igAOuooQDrqKIA66ijAOuopADrqKUA66imAOuopwDrqKgA66ipAOuoqgDrqKsA66isAOuorQDrqK4A66ivAOuosADrqLEA66iyAOuoswDrqLQA66i1AOuotgDrqLcA66i4AOuouQDrqLoA66i7AOuovADrqL0A66i+AOuovwDrqYAA66mBAOupggDrqYMA66mEAOuphQDrqYYA66mHAOupiADrqYkA66mKAOupiwDrqYwA66mNAOupjgDrqY8A66mQAOupkQDrqZIA66mTAOuplADrqZUA66mWAOuplwDrqZgA66mZAOupmgDrqZsA66mcAOupnQDrqZ4A66mfAOupoADrqaEA66miAOupowDrqaQA66mlAOuppgDrqacA66moAOupqQDrqaoA66mrAOuprADrqa0A66muAOuprwDrqbAA66mxAOupsgDrqbMA66m0AOuptQDrqbYA66m3AOupuADrqbkA66m6AOupuwDrqbwA66m9AOupvgDrqb8A66qAAOuqgQDrqoIA66qDAOuqhADrqoUA66qGAOuqhwDrqogA66qJAOuqigDrqosA66qMAOuqjQDrqo4A66qPAOuqkADrqpEA66qSAOuqkwDrqpQA66qVAOuqlgDrqpcA66qYAOuqmQDrqpoA66qbAOuqnADrqp0A66qeAOuqnwDrqqAA66qhAOuqogDrqqMA66qkAOuqpQDrqqYA66qnAOuqqADrqqkA66qqAOuqqwDrqqwA66qtAOuqrgDrqq8A66qwAOuqsQDrqrIA66qzAOuqtADrqrUA66q2AOuqtwDrqrgA66q5AOuqugDrqrsA66q8AOuqvQDrqr4A66q/AOurgADrq4EA66uCAOurgwDrq4QA66uFAOurhgDrq4cA66uIAOuriQDrq4oA66uLAOurjADrq40A66uOAOurjwDrq5AA66uRAOurkgDrq5MA66uUAOurlQDrq5YA66uXAOurmADrq5kA66uaAOurmwDrq5wA66udAOurngDrq58A66ugAOuroQDrq6IA66ujAOurpADrq6UA66umAOurpwDrq6gA66upAOurqgDrq6sA66usAOurrQDrq64A66uvAOursADrq7EA66uyAOurswDrq7QA66u1AOurtgDrq7cA66u4AOuruQDrq7oA66u7AOurvADrq70A66u+AOurvwDrrIAA66yBAOusggDrrIMA66yEAOushQDrrIYA66yHAOusiADrrIkA66yKAOusiwDrrIwA66yNAOusjgDrrI8A66yQAOuskQDrrJIA66yTAOuslADrrJUA66yWAOuslwDrrJgA66yZAOusmgDrrJsA66ycAOusnQDrrJ4A66yfAOusoADrrKEA66yiAOusowDrrKQA66ylAOuspgDrrKcA66yoAOusqQDrrKoA66yrAOusrADrrK0A66yuAOusrwDrrLAA66yxAOussgDrrLMA66y0AOustQDrrLYA66y3AOusuADrrLkA66y6AOusuwDrrLwA66y9AOusvgDrrL8A662AAOutgQDrrYIA662DAOuthADrrYUA662GAOuthwDrrYgA662JAOutigDrrYsA662MAOutjQDrrY4A662PAOutkADrrZEA662SAOutkwDrrZQA662VAOutlgDrrZcA662YAOutmQDrrZoA662bAOutnADrrZ0A662eAOutnwDrraAA662hAOutogDrraMA662kAOutpQDrraYA662nAOutqADrrakA662qAOutqwDrrawA662tAOutrgDrra8A662wAOutsQDrrbIA662zAOuttADrrbUA6622AOuttwDrrbgA6625AOutugDrrbsA6628AOutvQDrrb4A662/AOuugADrroEA666CAOuugwDrroQA666FAOuuhgDrrocA666IAOuuiQDrrooA666LAOuujADrro0A666OAOuujwDrrpAA666RAOuukgDrrpMA666UAOuulQDrrpYA666XAOuumADrrpkA666aAOuumwDrrpwA666dAOuungDrrp8A666gAOuuoQDrrqIA666jAOuupADrrqUA666mAOuupwDrrqgA666pAOuuqgDrrqsA666sAOuurQDrrq4A666vAOuusADrrrEA666yAOuuswDrrrQA6661AOuutgDrrrcA6664AOuuuQDrrroA6667AOuuvADrrr0A666+AOuuvwDrr4AA66+BAOuvggDrr4MA66+EAOuvhQDrr4YA66+HAOuviADrr4kA66+KAOuviwDrr4wA66+NAOuvjgDrr48A66+QAOuvkQDrr5IA66+TAOuvlADrr5UA66+WAOuvlwDrr5gA66+ZAOuvmgDrr5sA66+cAOuvnQDrr54A66+fAOuvoADrr6EA66+iAOuvowDrr6QA66+lAOuvpgDrr6cA66+oAOuvqQDrr6oA66+rAOuvrADrr60A66+uAOuvrwDrr7AA66+xAOuvsgDrr7MA66+0AOuvtQDrr7YA66+3AOuvuADrr7kA66+6AOuvuwDrr7wA66+9AOuvvgDrr78A67CAAOuwgQDrsIIA67CDAOuwhADrsIUA67CGAOuwhwDrsIgA67CJAOuwigDrsIsA67CMAOuwjQDrsI4A67CPAOuwkADrsJEA67CSAOuwkwDrsJQA67CVAOuwlgDrsJcA67CYAOuwmQDrsJoA67CbAOuwnADrsJ0A67CeAOuwnwDrsKAA67ChAOuwogDrsKMA67CkAOuwpQDrsKYA67CnAOuwqADrsKkA67CqAOuwqwDrsKwA67CtAOuwrgDrsK8A67CwAOuwsQDrsLIA67CzAOuwtADrsLUA67C2AOuwtwDrsLgA67C5AOuwugDrsLsA67C8AOuwvQDrsL4A67C/AOuxgADrsYEA67GCAOuxgwDrsYQA67GFAOuxhgDrsYcA67GIAOuxiQDrsYoA67GLAOuxjADrsY0A67GOAOuxjwDrsZAA67GRAOuxkgDrsZMA67GUAOuxlQDrsZYA67GXAOuxmADrsZkA67GaAOuxmwDrsZwA67GdAOuxngDrsZ8A67GgAOuxoQDrsaIA67GjAOuxpADrsaUA67GmAOuxpwDrsagA67GpAOuxqgDrsasA67GsAOuxrQDrsa4A67GvAOuxsADrsbEA67GyAOuxswDrsbQA67G1AOuxtgDrsbcA67G4AOuxuQDrsboA67G7AOuxvADrsb0A67G+AOuxvwDrsoAA67KBAOuyggDrsoMA67KEAOuyhQDrsoYA67KHAOuyiADrsokA67KKAOuyiwDrsowA67KNAOuyjgDrso8A67KQAOuykQDrspIA67KTAOuylADrspUA67KWAOuylwDrspgA67KZAOuymgDrspsA67KcAOuynQDrsp4A67KfAOuyoADrsqEA67KiAOuyowDrsqQA67KlAOuypgDrsqcA67KoAOuyqQDrsqoA67KrAOuyrADrsq0A67KuAOuyrwDrsrAA67KxAOuysgDrsrMA67K0AOuytQDrsrYA67K3AOuyuADrsrkA67K6AOuyuwDrsrwA67K9AOuyvgDrsr8A67OAAOuzgQDrs4IA67ODAOuzhADrs4UA67OGAOuzhwDrs4gA67OJAOuzigDrs4sA67OMAOuzjQDrs44A67OPAOuzkADrs5EA67OSAOuzkwDrs5QA67OVAOuzlgDrs5cA67OYAOuzmQDrs5oA67ObAOuznADrs50A67OeAOuznwDrs6AA67OhAOuzogDrs6MA67OkAOuzpQDrs6YA67OnAOuzqADrs6kA67OqAOuzqwDrs6wA67OtAOuzrgDrs68A67OwAOuzsQDrs7IA67OzAOuztADrs7UA67O2AOuztwDrs7gA67O5AOuzugDrs7sA67O8AOuzvQDrs74A67O/AOu0gADrtIEA67SCAOu0gwDrtIQA67SFAOu0hgDrtIcA67SIAOu0iQDrtIoA67SLAOu0jADrtI0A67SOAOu0jwDrtJAA67SRAOu0kgDrtJMA67SUAOu0lQDrtJYA67SXAOu0mADrtJkA67SaAOu0mwDrtJwA67SdAOu0ngDrtJ8A67SgAOu0oQDrtKIA67SjAOu0pADrtKUA67SmAOu0pwDrtKgA67SpAOu0qgDrtKsA67SsAOu0rQDrtK4A67SvAOu0sADrtLEA67SyAOu0swDrtLQA67S1AOu0tgDrtLcA67S4AOu0uQDrtLoA67S7AOu0vADrtL0A67S+AOu0vwDrtYAA67WBAOu1ggDrtYMA67WEAOu1hQDrtYYA67WHAOu1iADrtYkA67WKAOu1iwDrtYwA67WNAOu1jgDrtY8A67WQAOu1kQDrtZIA67WTAOu1lADrtZUA67WWAOu1lwDrtZgA67WZAOu1mgDrtZsA67WcAOu1nQDrtZ4A67WfAOu1oADrtaEA67WiAOu1owDrtaQA67WlAOu1pgDrtacA67WoAOu1qQDrtaoA67WrAOu1rADrta0A67WuAOu1rwDrtbAA67WxAOu1sgDrtbMA67W0AOu1tQDrtbYA67W3AOu1uADrtbkA67W6AOu1uwDrtbwA67W9AOu1vgDrtb8A67aAAOu2gQDrtoIA67aDAOu2hADrtoUA67aGAOu2hwDrtogA67aJAOu2igDrtosA67aMAOu2jQDrto4A67aPAOu2kADrtpEA67aSAOu2kwDrtpQA67aVAOu2lgDrtpcA67aYAOu2mQDrtpoA67abAOu2nADrtp0A67aeAOu2nwDrtqAA67ahAOu2ogDrtqMA67akAOu2pQDrtqYA67anAOu2qADrtqkA67aqAOu2qwDrtqwA67atAOu2rgDrtq8A67awAOu2sQDrtrIA67azAOu2tADrtrUA67a2AOu2twDrtrgA67a5AOu2ugDrtrsA67a8AOu2vQDrtr4A67a/AOu3gADrt4EA67eCAOu3gwDrt4QA67eFAOu3hgDrt4cA67eIAOu3iQDrt4oA67eLAOu3jADrt40A67eOAOu3jwDrt5AA67eRAOu3kgDrt5MA67eUAOu3lQDrt5YA67eXAOu3mADrt5kA67eaAOu3mwDrt5wA67edAOu3ngDrt58A67egAOu3oQDrt6IA67ejAOu3pADrt6UA67emAOu3pwDrt6gA67epAOu3qgDrt6sA67esAOu3rQDrt64A67evAOu3sADrt7EA67eyAOu3swDrt7QA67e1AOu3tgDrt7cA67e4AOu3uQDrt7oA67e7AOu3vADrt70A67e+AOu3vwDruIAA67iBAOu4ggDruIMA67iEAOu4hQDruIYA67iHAOu4iADruIkA67iKAOu4iwDruIwA67iNAOu4jgDruI8A67iQAOu4kQDruJIA67iTAOu4lADruJUA67iWAOu4lwDruJgA67iZAOu4mgDruJsA67icAOu4nQDruJ4A67ifAOu4oADruKEA67iiAOu4owDruKQA67ilAOu4pgDruKcA67ioAOu4qQDruKoA67irAOu4rADruK0A67iuAOu4rwDruLAA67ixAOu4sgDruLMA67i0AOu4tQDruLYA67i3AOu4uADruLkA67i6AOu4uwDruLwA67i9AOu4vgDruL8A67mAAOu5gQDruYIA67mDAOu5hADruYUA67mGAOu5hwDruYgA67mJAOu5igDruYsA67mMAOu5jQDruY4A67mPAOu5kADruZEA67mSAOu5kwDruZQA67mVAOu5lgDruZcA67mYAOu5mQDruZoA67mbAOu5nADruZ0A67meAOu5nwDruaAA67mhAOu5ogDruaMA67mkAOu5pQDruaYA67mnAOu5qADruakA67mqAOu5qwDruawA67mtAOu5rgDrua8A67mwAOu5sQDrubIA67mzAOu5tADrubUA67m2AOu5twDrubgA67m5AOu5ugDrubsA67m8AOu5vQDrub4A67m/AOu6gADruoEA67qCAOu6gwDruoQA67qFAOu6hgDruocA67qIAOu6iQDruooA67qLAOu6jADruo0A67qOAOu6jwDrupAA67qRAOu6kgDrupMA67qUAOu6lQDrupYA67qXAOu6mADrupkA67qaAOu6mwDrupwA67qdAOu6ngDrup8A67qgAOu6oQDruqIA67qjAOu6pADruqUA67qmAOu6pwDruqgA67qpAOu6qgDruqsA67qsAOu6rQDruq4A67qvAOu6sADrurEA67qyAOu6swDrurQA67q1AOu6tgDrurcA67q4AOu6uQDruroA67q7AOu6vADrur0A67q+AOu6vwDru4AA67uBAOu7ggDru4MA67uEAOu7hQDru4YA67uHAOu7iADru4kA67uKAOu7iwDru4wA67uNAOu7jgDru48A67uQAOu7kQDru5IA67uTAOu7lADru5UA67uWAOu7lwDru5gA67uZAOu7mgDru5sA67ucAOu7nQDru54A67ufAOu7oADru6EA67uiAOu7owDru6QA67ulAOu7pgDru6cA67uoAOu7qQDru6oA67urAOu7rADru60A67uuAOu7rwDru7AA67uxAOu7sgDru7MA67u0AOu7tQDru7YA67u3AOu7uADru7kA67u6AOu7uwDru7wA67u9AOu7vgDru78A67yAAOu8gQDrvIIA67yDAOu8hADrvIUA67yGAOu8hwDrvIgA67yJAOu8igDrvIsA67yMAOu8jQDrvI4A67yPAOu8kADrvJEA67ySAOu8kwDrvJQA67yVAOu8lgDrvJcA67yYAOu8mQDrvJoA67ybAOu8nADrvJ0A67yeAOu8nwDrvKAA67yhAOu8ogDrvKMA67ykAOu8pQDrvKYA67ynAOu8qADrvKkA67yqAOu8qwDrvKwA67ytAOu8rgDrvK8A67ywAOu8sQDrvLIA67yzAOu8tADrvLUA67y2AOu8twDrvLgA67y5AOu8ugDrvLsA67y8AOu8vQDrvL4A67y/AOu9gADrvYEA672CAOu9gwDrvYQA672FAOu9hgDrvYcA672IAOu9iQDrvYoA672LAOu9jADrvY0A672OAOu9jwDrvZAA672RAOu9kgDrvZMA672UAOu9lQDrvZYA672XAOu9mADrvZkA672aAOu9mwDrvZwA672dAOu9ngDrvZ8A672gAOu9oQDrvaIA672jAOu9pADrvaUA672mAOu9pwDrvagA672pAOu9qgDrvasA672sAOu9rQDrva4A672vAOu9sADrvbEA672yAOu9swDrvbQA6721AOu9tgDrvbcA6724AOu9uQDrvboA6727AOu9vADrvb0A672+AOu9vwDrvoAA676BAOu+ggDrvoMA676EAOu+hQDrvoYA676HAOu+iADrvokA676KAOu+iwDrvowA676NAOu+jgDrvo8A676QAOu+kQDrvpIA676TAOu+lADrvpUA676WAOu+lwDrvpgA676ZAOu+mgDrvpsA676cAOu+nQDrvp4A676fAOu+oADrvqEA676iAOu+owDrvqQA676lAOu+pgDrvqcA676oAOu+qQDrvqoA676rAOu+rADrvq0A676uAOu+rwDrvrAA676xAOu+sgDrvrMA6760AOu+tQDrvrYA6763AOu+uADrvrkA6766AOu+uwDrvrwA6769AOu+vgDrvr8A67+AAOu/gQDrv4IA67+DAOu/hADrv4UA67+GAOu/hwDrv4gA67+JAOu/igDrv4sA67+MAOu/jQDrv44A67+PAOu/kADrv5EA67+SAOu/kwDrv5QA67+VAOu/lgDrv5cA67+YAOu/mQDrv5oA67+bAOu/nADrv50A67+eAOu/nwDrv6AA67+hAOu/ogDrv6MA67+kAOu/pQDrv6YA67+nAOu/qADrv6kA67+qAOu/qwDrv6wA67+tAOu/rgDrv68A67+wAOu/sQDrv7IA67+zAOu/tADrv7UA67+2AOu/twDrv7gA67+5AOu/ugDrv7sA67+8AOu/vQDrv74A67+/AOyAgADsgIEA7ICCAOyAgwDsgIQA7ICFAOyAhgDsgIcA7ICIAOyAiQDsgIoA7ICLAOyAjADsgI0A7ICOAOyAjwDsgJAA7ICRAOyAkgDsgJMA7ICUAOyAlQDsgJYA7ICXAOyAmADsgJkA7ICaAOyAmwDsgJwA7ICdAOyAngDsgJ8A7ICgAOyAoQDsgKIA7ICjAOyApADsgKUA7ICmAOyApwDsgKgA7ICpAOyAqgDsgKsA7ICsAOyArQDsgK4A7ICvAOyAsADsgLEA7ICyAOyAswDsgLQA7IC1AOyAtgDsgLcA7IC4AOyAuQDsgLoA7IC7AOyAvADsgL0A7IC+AOyAvwDsgYAA7IGBAOyBggDsgYMA7IGEAOyBhQDsgYYA7IGHAOyBiADsgYkA7IGKAOyBiwDsgYwA7IGNAOyBjgDsgY8A7IGQAOyBkQDsgZIA7IGTAOyBlADsgZUA7IGWAOyBlwDsgZgA7IGZAOyBmgDsgZsA7IGcAOyBnQDsgZ4A7IGfAOyBoADsgaEA7IGiAOyBowDsgaQA7IGlAOyBpgDsgacA7IGoAOyBqQDsgaoA7IGrAOyBrADsga0A7IGuAOyBrwDsgbAA7IGxAOyBsgDsgbMA7IG0AOyBtQDsgbYA7IG3AOyBuADsgbkA7IG6AOyBuwDsgbwA7IG9AOyBvgDsgb8A7IKAAOyCgQDsgoIA7IKDAOyChADsgoUA7IKGAOyChwDsgogA7IKJAOyCigDsgosA7IKMAOyCjQDsgo4A7IKPAOyCkADsgpEA7IKSAOyCkwDsgpQA7IKVAOyClgDsgpcA7IKYAOyCmQDsgpoA7IKbAOyCnADsgp0A7IKeAOyCnwDsgqAA7IKhAOyCogDsgqMA7IKkAOyCpQDsgqYA7IKnAOyCqADsgqkA7IKqAOyCqwDsgqwA7IKtAOyCrgDsgq8A7IKwAOyCsQDsgrIA7IKzAOyCtADsgrUA7IK2AOyCtwDsgrgA7IK5AOyCugDsgrsA7IK8AOyCvQDsgr4A7IK/AOyDgADsg4EA7IOCAOyDgwDsg4QA7IOFAOyDhgDsg4cA7IOIAOyDiQDsg4oA7IOLAOyDjADsg40A7IOOAOyDjwDsg5AA7IORAOyDkgDsg5MA7IOUAOyDlQDsg5YA7IOXAOyDmADsg5kA7IOaAOyDmwDsg5wA7IOdAOyDngDsg58A7IOgAOyDoQDsg6IA7IOjAOyDpADsg6UA7IOmAOyDpwDsg6gA7IOpAOyDqgDsg6sA7IOsAOyDrQDsg64A7IOvAOyDsADsg7EA7IOyAOyDswDsg7QA7IO1AOyDtgDsg7cA7IO4AOyDuQDsg7oA7IO7AOyDvADsg70A7IO+AOyDvwDshIAA7ISBAOyEggDshIMA7ISEAOyEhQDshIYA7ISHAOyEiADshIkA7ISKAOyEiwDshIwA7ISNAOyEjgDshI8A7ISQAOyEkQDshJIA7ISTAOyElADshJUA7ISWAOyElwDshJgA7ISZAOyEmgDshJsA7IScAOyEnQDshJ4A7ISfAOyEoADshKEA7ISiAOyEowDshKQA7ISlAOyEpgDshKcA7ISoAOyEqQDshKoA7ISrAOyErADshK0A7ISuAOyErwDshLAA7ISxAOyEsgDshLMA7IS0AOyEtQDshLYA7IS3AOyEuADshLkA7IS6AOyEuwDshLwA7IS9AOyEvgDshL8A7IWAAOyFgQDshYIA7IWDAOyFhADshYUA7IWGAOyFhwDshYgA7IWJAOyFigDshYsA7IWMAOyFjQDshY4A7IWPAOyFkADshZEA7IWSAOyFkwDshZQA7IWVAOyFlgDshZcA7IWYAOyFmQDshZoA7IWbAOyFnADshZ0A7IWeAOyFnwDshaAA7IWhAOyFogDshaMA7IWkAOyFpQDshaYA7IWnAOyFqADshakA7IWqAOyFqwDshawA7IWtAOyFrgDsha8A7IWwAOyFsQDshbIA7IWzAOyFtADshbUA7IW2AOyFtwDshbgA7IW5AOyFugDshbsA7IW8AOyFvQDshb4A7IW/AOyGgADshoEA7IaCAOyGgwDshoQA7IaFAOyGhgDshocA7IaIAOyGiQDshooA7IaLAOyGjADsho0A7IaOAOyGjwDshpAA7IaRAOyGkgDshpMA7IaUAOyGlQDshpYA7IaXAOyGmADshpkA7IaaAOyGmwDshpwA7IadAOyGngDshp8A7IagAOyGoQDshqIA7IajAOyGpADshqUA7IamAOyGpwDshqgA7IapAOyGqgDshqsA7IasAOyGrQDshq4A7IavAOyGsADshrEA7IayAOyGswDshrQA7Ia1AOyGtgDshrcA7Ia4AOyGuQDshroA7Ia7AOyGvADshr0A7Ia+AOyGvwDsh4AA7IeBAOyHggDsh4MA7IeEAOyHhQDsh4YA7IeHAOyHiADsh4kA7IeKAOyHiwDsh4wA7IeNAOyHjgDsh48A7IeQAOyHkQDsh5IA7IeTAOyHlADsh5UA7IeWAOyHlwDsh5gA7IeZAOyHmgDsh5sA7IecAOyHnQDsh54A7IefAOyHoADsh6EA7IeiAOyHowDsh6QA7IelAOyHpgDsh6cA7IeoAOyHqQDsh6oA7IerAOyHrADsh60A7IeuAOyHrwDsh7AA7IexAOyHsgDsh7MA7Ie0AOyHtQDsh7YA7Ie3AOyHuADsh7kA7Ie6AOyHuwDsh7wA7Ie9AOyHvgDsh78A7IiAAOyIgQDsiIIA7IiDAOyIhADsiIUA7IiGAOyIhwDsiIgA7IiJAOyIigDsiIsA7IiMAOyIjQDsiI4A7IiPAOyIkADsiJEA7IiSAOyIkwDsiJQA7IiVAOyIlgDsiJcA7IiYAOyImQDsiJoA7IibAOyInADsiJ0A7IieAOyInwDsiKAA7IihAOyIogDsiKMA7IikAOyIpQDsiKYA7IinAOyIqADsiKkA7IiqAOyIqwDsiKwA7IitAOyIrgDsiK8A7IiwAOyIsQDsiLIA7IizAOyItADsiLUA7Ii2AOyItwDsiLgA7Ii5AOyIugDsiLsA7Ii8AOyIvQDsiL4A7Ii/AOyJgADsiYEA7ImCAOyJgwDsiYQA7ImFAOyJhgDsiYcA7ImIAOyJiQDsiYoA7ImLAOyJjADsiY0A7ImOAOyJjwDsiZAA7ImRAOyJkgDsiZMA7ImUAOyJlQDsiZYA7ImXAOyJmADsiZkA7ImaAOyJmwDsiZwA7ImdAOyJngDsiZ8A7ImgAOyJoQDsiaIA7ImjAOyJpADsiaUA7ImmAOyJpwDsiagA7ImpAOyJqgDsiasA7ImsAOyJrQDsia4A7ImvAOyJsADsibEA7ImyAOyJswDsibQA7Im1AOyJtgDsibcA7Im4AOyJuQDsiboA7Im7AOyJvADsib0A7Im+AOyJvwDsioAA7IqBAOyKggDsioMA7IqEAOyKhQDsioYA7IqHAOyKiADsiokA7IqKAOyKiwDsiowA7IqNAOyKjgDsio8A7IqQAOyKkQDsipIA7IqTAOyKlADsipUA7IqWAOyKlwDsipgA7IqZAOyKmgDsipsA7IqcAOyKnQDsip4A7IqfAOyKoADsiqEA7IqiAOyKowDsiqQA7IqlAOyKpgDsiqcA7IqoAOyKqQDsiqoA7IqrAOyKrADsiq0A7IquAOyKrwDsirAA7IqxAOyKsgDsirMA7Iq0AOyKtQDsirYA7Iq3AOyKuADsirkA7Iq6AOyKuwDsirwA7Iq9AOyKvgDsir8A7IuAAOyLgQDsi4IA7IuDAOyLhADsi4UA7IuGAOyLhwDsi4gA7IuJAOyLigDsi4sA7IuMAOyLjQDsi44A7IuPAOyLkADsi5EA7IuSAOyLkwDsi5QA7IuVAOyLlgDsi5cA7IuYAOyLmQDsi5oA7IubAOyLnADsi50A7IueAOyLnwDsi6AA7IuhAOyLogDsi6MA7IukAOyLpQDsi6YA7IunAOyLqADsi6kA7IuqAOyLqwDsi6wA7IutAOyLrgDsi68A7IuwAOyLsQDsi7IA7IuzAOyLtADsi7UA7Iu2AOyLtwDsi7gA7Iu5AOyLugDsi7sA7Iu8AOyLvQDsi74A7Iu/AOyMgADsjIEA7IyCAOyMgwDsjIQA7IyFAOyMhgDsjIcA7IyIAOyMiQDsjIoA7IyLAOyMjADsjI0A7IyOAOyMjwDsjJAA7IyRAOyMkgDsjJMA7IyUAOyMlQDsjJYA7IyXAOyMmADsjJkA7IyaAOyMmwDsjJwA7IydAOyMngDsjJ8A7IygAOyMoQDsjKIA7IyjAOyMpADsjKUA7IymAOyMpwDsjKgA7IypAOyMqgDsjKsA7IysAOyMrQDsjK4A7IyvAOyMsADsjLEA7IyyAOyMswDsjLQA7Iy1AOyMtgDsjLcA7Iy4AOyMuQDsjLoA7Iy7AOyMvADsjL0A7Iy+AOyMvwDsjYAA7I2BAOyNggDsjYMA7I2EAOyNhQDsjYYA7I2HAOyNiADsjYkA7I2KAOyNiwDsjYwA7I2NAOyNjgDsjY8A7I2QAOyNkQDsjZIA7I2TAOyNlADsjZUA7I2WAOyNlwDsjZgA7I2ZAOyNmgDsjZsA7I2cAOyNnQDsjZ4A7I2fAOyNoADsjaEA7I2iAOyNowDsjaQA7I2lAOyNpgDsjacA7I2oAOyNqQDsjaoA7I2rAOyNrADsja0A7I2uAOyNrwDsjbAA7I2xAOyNsgDsjbMA7I20AOyNtQDsjbYA7I23AOyNuADsjbkA7I26AOyNuwDsjbwA7I29AOyNvgDsjb8A7I6AAOyOgQDsjoIA7I6DAOyOhADsjoUA7I6GAOyOhwDsjogA7I6JAOyOigDsjosA7I6MAOyOjQDsjo4A7I6PAOyOkADsjpEA7I6SAOyOkwDsjpQA7I6VAOyOlgDsjpcA7I6YAOyOmQDsjpoA7I6bAOyOnADsjp0A7I6eAOyOnwDsjqAA7I6hAOyOogDsjqMA7I6kAOyOpQDsjqYA7I6nAOyOqADsjqkA7I6qAOyOqwDsjqwA7I6tAOyOrgDsjq8A7I6wAOyOsQDsjrIA7I6zAOyOtADsjrUA7I62AOyOtwDsjrgA7I65AOyOugDsjrsA7I68AOyOvQDsjr4A7I6/AOyPgADsj4EA7I+CAOyPgwDsj4QA7I+FAOyPhgDsj4cA7I+IAOyPiQDsj4oA7I+LAOyPjADsj40A7I+OAOyPjwDsj5AA7I+RAOyPkgDsj5MA7I+UAOyPlQDsj5YA7I+XAOyPmADsj5kA7I+aAOyPmwDsj5wA7I+dAOyPngDsj58A7I+gAOyPoQDsj6IA7I+jAOyPpADsj6UA7I+mAOyPpwDsj6gA7I+pAOyPqgDsj6sA7I+sAOyPrQDsj64A7I+vAOyPsADsj7EA7I+yAOyPswDsj7QA7I+1AOyPtgDsj7cA7I+4AOyPuQDsj7oA7I+7AOyPvADsj70A7I++AOyPvwDskIAA7JCBAOyQggDskIMA7JCEAOyQhQDskIYA7JCHAOyQiADskIkA7JCKAOyQiwDskIwA7JCNAOyQjgDskI8A7JCQAOyQkQDskJIA7JCTAOyQlADskJUA7JCWAOyQlwDskJgA7JCZAOyQmgDskJsA7JCcAOyQnQDskJ4A7JCfAOyQoADskKEA7JCiAOyQowDskKQA7JClAOyQpgDskKcA7JCoAOyQqQDskKoA7JCrAOyQrADskK0A7JCuAOyQrwDskLAA7JCxAOyQsgDskLMA7JC0AOyQtQDskLYA7JC3AOyQuADskLkA7JC6AOyQuwDskLwA7JC9AOyQvgDskL8A7JGAAOyRgQDskYIA7JGDAOyRhADskYUA7JGGAOyRhwDskYgA7JGJAOyRigDskYsA7JGMAOyRjQDskY4A7JGPAOyRkADskZEA7JGSAOyRkwDskZQA7JGVAOyRlgDskZcA7JGYAOyRmQDskZoA7JGbAOyRnADskZ0A7JGeAOyRnwDskaAA7JGhAOyRogDskaMA7JGkAOyRpQDskaYA7JGnAOyRqADskakA7JGqAOyRqwDskawA7JGtAOyRrgDska8A7JGwAOyRsQDskbIA7JGzAOyRtADskbUA7JG2AOyRtwDskbgA7JG5AOyRugDskbsA7JG8AOyRvQDskb4A7JG/AOySgADskoEA7JKCAOySgwDskoQA7JKFAOyShgDskocA7JKIAOySiQDskooA7JKLAOySjADsko0A7JKOAOySjwDskpAA7JKRAOySkgDskpMA7JKUAOySlQDskpYA7JKXAOySmADskpkA7JKaAOySmwDskpwA7JKdAOySngDskp8A7JKgAOySoQDskqIA7JKjAOySpADskqUA7JKmAOySpwDskqgA7JKpAOySqgDskqsA7JKsAOySrQDskq4A7JKvAOySsADskrEA7JKyAOySswDskrQA7JK1AOyStgDskrcA7JK4AOySuQDskroA7JK7AOySvADskr0A7JK+AOySvwDsk4AA7JOBAOyTggDsk4MA7JOEAOyThQDsk4YA7JOHAOyTiADsk4kA7JOKAOyTiwDsk4wA7JONAOyTjgDsk48A7JOQAOyTkQDsk5IA7JOTAOyTlADsk5UA7JOWAOyTlwDsk5gA7JOZAOyTmgDsk5sA7JOcAOyTnQDsk54A7JOfAOyToADsk6EA7JOiAOyTowDsk6QA7JOlAOyTpgDsk6cA7JOoAOyTqQDsk6oA7JOrAOyTrADsk60A7JOuAOyTrwDsk7AA7JOxAOyTsgDsk7MA7JO0AOyTtQDsk7YA7JO3AOyTuADsk7kA7JO6AOyTuwDsk7wA7JO9AOyTvgDsk78A7JSAAOyUgQDslIIA7JSDAOyUhADslIUA7JSGAOyUhwDslIgA7JSJAOyUigDslIsA7JSMAOyUjQDslI4A7JSPAOyUkADslJEA7JSSAOyUkwDslJQA7JSVAOyUlgDslJcA7JSYAOyUmQDslJoA7JSbAOyUnADslJ0A7JSeAOyUnwDslKAA7JShAOyUogDslKMA7JSkAOyUpQDslKYA7JSnAOyUqADslKkA7JSqAOyUqwDslKwA7JStAOyUrgDslK8A7JSwAOyUsQDslLIA7JSzAOyUtADslLUA7JS2AOyUtwDslLgA7JS5AOyUugDslLsA7JS8AOyUvQDslL4A7JS/AOyVgADslYEA7JWCAOyVgwDslYQA7JWFAOyVhgDslYcA7JWIAOyViQDslYoA7JWLAOyVjADslY0A7JWOAOyVjwDslZAA7JWRAOyVkgDslZMA7JWUAOyVlQDslZYA7JWXAOyVmADslZkA7JWaAOyVmwDslZwA7JWdAOyVngDslZ8A7JWgAOyVoQDslaIA7JWjAOyVpADslaUA7JWmAOyVpwDslagA7JWpAOyVqgDslasA7JWsAOyVrQDsla4A7JWvAOyVsADslbEA7JWyAOyVswDslbQA7JW1AOyVtgDslbcA7JW4AOyVuQDslboA7JW7AOyVvADslb0A7JW+AOyVvwDsloAA7JaBAOyWggDsloMA7JaEAOyWhQDsloYA7JaHAOyWiADslokA7JaKAOyWiwDslowA7JaNAOyWjgDslo8A7JaQAOyWkQDslpIA7JaTAOyWlADslpUA7JaWAOyWlwDslpgA7JaZAOyWmgDslpsA7JacAOyWnQDslp4A7JafAOyWoADslqEA7JaiAOyWowDslqQA7JalAOyWpgDslqcA7JaoAOyWqQDslqoA7JarAOyWrADslq0A7JauAOyWrwDslrAA7JaxAOyWsgDslrMA7Ja0AOyWtQDslrYA7Ja3AOyWuADslrkA7Ja6AOyWuwDslrwA7Ja9AOyWvgDslr8A7JeAAOyXgQDsl4IA7JeDAOyXhADsl4UA7JeGAOyXhwDsl4gA7JeJAOyXigDsl4sA7JeMAOyXjQDsl44A7JePAOyXkADsl5EA7JeSAOyXkwDsl5QA7JeVAOyXlgDsl5cA7JeYAOyXmQDsl5oA7JebAOyXnADsl50A7JeeAOyXnwDsl6AA7JehAOyXogDsl6MA7JekAOyXpQDsl6YA7JenAOyXqADsl6kA7JeqAOyXqwDsl6wA7JetAOyXrgDsl68A7JewAOyXsQDsl7IA7JezAOyXtADsl7UA7Je2AOyXtwDsl7gA7Je5AOyXugDsl7sA7Je8AOyXvQDsl74A7Je/AOyYgADsmIEA7JiCAOyYgwDsmIQA7JiFAOyYhgDsmIcA7JiIAOyYiQDsmIoA7JiLAOyYjADsmI0A7JiOAOyYjwDsmJAA7JiRAOyYkgDsmJMA7JiUAOyYlQDsmJYA7JiXAOyYmADsmJkA7JiaAOyYmwDsmJwA7JidAOyYngDsmJ8A7JigAOyYoQDsmKIA7JijAOyYpADsmKUA7JimAOyYpwDsmKgA7JipAOyYqgDsmKsA7JisAOyYrQDsmK4A7JivAOyYsADsmLEA7JiyAOyYswDsmLQA7Ji1AOyYtgDsmLcA7Ji4AOyYuQDsmLoA7Ji7AOyYvADsmL0A7Ji+AOyYvwDsmYAA7JmBAOyZggDsmYMA7JmEAOyZhQDsmYYA7JmHAOyZiADsmYkA7JmKAOyZiwDsmYwA7JmNAOyZjgDsmY8A7JmQAOyZkQDsmZIA7JmTAOyZlADsmZUA7JmWAOyZlwDsmZgA7JmZAOyZmgDsmZsA7JmcAOyZnQDsmZ4A7JmfAOyZoADsmaEA7JmiAOyZowDsmaQA7JmlAOyZpgDsmacA7JmoAOyZqQDsmaoA7JmrAOyZrADsma0A7JmuAOyZrwDsmbAA7JmxAOyZsgDsmbMA7Jm0AOyZtQDsmbYA7Jm3AOyZuADsmbkA7Jm6AOyZuwDsmbwA7Jm9AOyZvgDsmb8A7JqAAOyagQDsmoIA7JqDAOyahADsmoUA7JqGAOyahwDsmogA7JqJAOyaigDsmosA7JqMAOyajQDsmo4A7JqPAOyakADsmpEA7JqSAOyakwDsmpQA7JqVAOyalgDsmpcA7JqYAOyamQDsmpoA7JqbAOyanADsmp0A7JqeAOyanwDsmqAA7JqhAOyaogDsmqMA7JqkAOyapQDsmqYA7JqnAOyaqADsmqkA7JqqAOyaqwDsmqwA7JqtAOyargDsmq8A7JqwAOyasQDsmrIA7JqzAOyatADsmrUA7Jq2AOyatwDsmrgA7Jq5AOyaugDsmrsA7Jq8AOyavQDsmr4A7Jq/AOybgADsm4EA7JuCAOybgwDsm4QA7JuFAOybhgDsm4cA7JuIAOybiQDsm4oA7JuLAOybjADsm40A7JuOAOybjwDsm5AA7JuRAOybkgDsm5MA7JuUAOyblQDsm5YA7JuXAOybmADsm5kA7JuaAOybmwDsm5wA7JudAOybngDsm58A7JugAOyboQDsm6IA7JujAOybpADsm6UA7JumAOybpwDsm6gA7JupAOybqgDsm6sA7JusAOybrQDsm64A7JuvAOybsADsm7EA7JuyAOybswDsm7QA7Ju1AOybtgDsm7cA7Ju4AOybuQDsm7oA7Ju7AOybvADsm70A7Ju+AOybvwDsnIAA7JyBAOycggDsnIMA7JyEAOychQDsnIYA7JyHAOyciADsnIkA7JyKAOyciwDsnIwA7JyNAOycjgDsnI8A7JyQAOyckQDsnJIA7JyTAOyclADsnJUA7JyWAOyclwDsnJgA7JyZAOycmgDsnJsA7JycAOycnQDsnJ4A7JyfAOycoADsnKEA7JyiAOycowDsnKQA7JylAOycpgDsnKcA7JyoAOycqQDsnKoA7JyrAOycrADsnK0A7JyuAOycrwDsnLAA7JyxAOycsgDsnLMA7Jy0AOyctQDsnLYA7Jy3AOycuADsnLkA7Jy6AOycuwDsnLwA7Jy9AOycvgDsnL8A7J2AAOydgQDsnYIA7J2DAOydhADsnYUA7J2GAOydhwDsnYgA7J2JAOydigDsnYsA7J2MAOydjQDsnY4A7J2PAOydkADsnZEA7J2SAOydkwDsnZQA7J2VAOydlgDsnZcA7J2YAOydmQDsnZoA7J2bAOydnADsnZ0A7J2eAOydnwDsnaAA7J2hAOydogDsnaMA7J2kAOydpQDsnaYA7J2nAOydqADsnakA7J2qAOydqwDsnawA7J2tAOydrgDsna8A7J2wAOydsQDsnbIA7J2zAOydtADsnbUA7J22AOydtwDsnbgA7J25AOydugDsnbsA7J28AOydvQDsnb4A7J2/AOyegADsnoEA7J6CAOyegwDsnoQA7J6FAOyehgDsnocA7J6IAOyeiQDsnooA7J6LAOyejADsno0A7J6OAOyejwDsnpAA7J6RAOyekgDsnpMA7J6UAOyelQDsnpYA7J6XAOyemADsnpkA7J6aAOyemwDsnpwA7J6dAOyengDsnp8A7J6gAOyeoQDsnqIA7J6jAOyepADsnqUA7J6mAOyepwDsnqgA7J6pAOyeqgDsnqsA7J6sAOyerQDsnq4A7J6vAOyesADsnrEA7J6yAOyeswDsnrQA7J61AOyetgDsnrcA7J64AOyeuQDsnroA7J67AOyevADsnr0A7J6+AOyevwDsn4AA7J+BAOyfggDsn4MA7J+EAOyfhQDsn4YA7J+HAOyfiADsn4kA7J+KAOyfiwDsn4wA7J+NAOyfjgDsn48A7J+QAOyfkQDsn5IA7J+TAOyflADsn5UA7J+WAOyflwDsn5gA7J+ZAOyfmgDsn5sA7J+cAOyfnQDsn54A7J+fAOyfoADsn6EA7J+iAOyfowDsn6QA7J+lAOyfpgDsn6cA7J+oAOyfqQDsn6oA7J+rAOyfrADsn60A7J+uAOyfrwDsn7AA7J+xAOyfsgDsn7MA7J+0AOyftQDsn7YA7J+3AOyfuADsn7kA7J+6AOyfuwDsn7wA7J+9AOyfvgDsn78A7KCAAOyggQDsoIIA7KCDAOyghADsoIUA7KCGAOyghwDsoIgA7KCJAOygigDsoIsA7KCMAOygjQDsoI4A7KCPAOygkADsoJEA7KCSAOygkwDsoJQA7KCVAOyglgDsoJcA7KCYAOygmQDsoJoA7KCbAOygnADsoJ0A7KCeAOygnwDsoKAA7KChAOygogDsoKMA7KCkAOygpQDsoKYA7KCnAOygqADsoKkA7KCqAOygqwDsoKwA7KCtAOygrgDsoK8A7KCwAOygsQDsoLIA7KCzAOygtADsoLUA7KC2AOygtwDsoLgA7KC5AOygugDsoLsA7KC8AOygvQDsoL4A7KC/AOyhgADsoYEA7KGCAOyhgwDsoYQA7KGFAOyhhgDsoYcA7KGIAOyhiQDsoYoA7KGLAOyhjADsoY0A7KGOAOyhjwDsoZAA7KGRAOyhkgDsoZMA7KGUAOyhlQDsoZYA7KGXAOyhmADsoZkA7KGaAOyhmwDsoZwA7KGdAOyhngDsoZ8A7KGgAOyhoQDsoaIA7KGjAOyhpADsoaUA7KGmAOyhpwDsoagA7KGpAOyhqgDsoasA7KGsAOyhrQDsoa4A7KGvAOyhsADsobEA7KGyAOyhswDsobQA7KG1AOyhtgDsobcA7KG4AOyhuQDsoboA7KG7AOyhvADsob0A7KG+AOyhvwDsooAA7KKBAOyiggDsooMA7KKEAOyihQDsooYA7KKHAOyiiADsookA7KKKAOyiiwDsoowA7KKNAOyijgDsoo8A7KKQAOyikQDsopIA7KKTAOyilADsopUA7KKWAOyilwDsopgA7KKZAOyimgDsopsA7KKcAOyinQDsop4A7KKfAOyioADsoqEA7KKiAOyiowDsoqQA7KKlAOyipgDsoqcA7KKoAOyiqQDsoqoA7KKrAOyirADsoq0A7KKuAOyirwDsorAA7KKxAOyisgDsorMA7KK0AOyitQDsorYA7KK3AOyiuADsorkA7KK6AOyiuwDsorwA7KK9AOyivgDsor8A7KOAAOyjgQDso4IA7KODAOyjhADso4UA7KOGAOyjhwDso4gA7KOJAOyjigDso4sA7KOMAOyjjQDso44A7KOPAOyjkADso5EA7KOSAOyjkwDso5QA7KOVAOyjlgDso5cA7KOYAOyjmQDso5oA7KObAOyjnADso50A7KOeAOyjnwDso6AA7KOhAOyjogDso6MA7KOkAOyjpQDso6YA7KOnAOyjqADso6kA7KOqAOyjqwDso6wA7KOtAOyjrgDso68A7KOwAOyjsQDso7IA7KOzAOyjtADso7UA7KO2AOyjtwDso7gA7KO5AOyjugDso7sA7KO8AOyjvOydmADso70A7KO+AOyjvwDspIAA7KSBAOykggDspIMA7KSEAOykhQDspIYA7KSHAOykiADspIkA7KSKAOykiwDspIwA7KSNAOykjgDspI8A7KSQAOykkQDspJIA7KSTAOyklADspJUA7KSWAOyklwDspJgA7KSZAOykmgDspJsA7KScAOyknQDspJ4A7KSfAOykoADspKEA7KSiAOykowDspKQA7KSlAOykpgDspKcA7KSoAOykqQDspKoA7KSrAOykrADspK0A7KSuAOykrwDspLAA7KSxAOyksgDspLMA7KS0AOyktQDspLYA7KS3AOykuADspLkA7KS6AOykuwDspLwA7KS9AOykvgDspL8A7KWAAOylgQDspYIA7KWDAOylhADspYUA7KWGAOylhwDspYgA7KWJAOyligDspYsA7KWMAOyljQDspY4A7KWPAOylkADspZEA7KWSAOylkwDspZQA7KWVAOyllgDspZcA7KWYAOylmQDspZoA7KWbAOylnADspZ0A7KWeAOylnwDspaAA7KWhAOylogDspaMA7KWkAOylpQDspaYA7KWnAOylqADspakA7KWqAOylqwDspawA7KWtAOylrgDspa8A7KWwAOylsQDspbIA7KWzAOyltADspbUA7KW2AOyltwDspbgA7KW5AOylugDspbsA7KW8AOylvQDspb4A7KW/AOymgADspoEA7KaCAOymgwDspoQA7KaFAOymhgDspocA7KaIAOymiQDspooA7KaLAOymjADspo0A7KaOAOymjwDsppAA7KaRAOymkgDsppMA7KaUAOymlQDsppYA7KaXAOymmADsppkA7KaaAOymmwDsppwA7KadAOymngDspp8A7KagAOymoQDspqIA7KajAOympADspqUA7KamAOympwDspqgA7KapAOymqgDspqsA7KasAOymrQDspq4A7KavAOymsADsprEA7KayAOymswDsprQA7Ka1AOymtgDsprcA7Ka4AOymuQDsproA7Ka7AOymvADspr0A7Ka+AOymvwDsp4AA7KeBAOynggDsp4MA7KeEAOynhQDsp4YA7KeHAOyniADsp4kA7KeKAOyniwDsp4wA7KeNAOynjgDsp48A7KeQAOynkQDsp5IA7KeTAOynlADsp5UA7KeWAOynlwDsp5gA7KeZAOynmgDsp5sA7KecAOynnQDsp54A7KefAOynoADsp6EA7KeiAOynowDsp6QA7KelAOynpgDsp6cA7KeoAOynqQDsp6oA7KerAOynrADsp60A7KeuAOynrwDsp7AA7KexAOynsgDsp7MA7Ke0AOyntQDsp7YA7Ke3AOynuADsp7kA7Ke6AOynuwDsp7wA7Ke9AOynvgDsp78A7KiAAOyogQDsqIIA7KiDAOyohADsqIUA7KiGAOyohwDsqIgA7KiJAOyoigDsqIsA7KiMAOyojQDsqI4A7KiPAOyokADsqJEA7KiSAOyokwDsqJQA7KiVAOyolgDsqJcA7KiYAOyomQDsqJoA7KibAOyonADsqJ0A7KieAOyonwDsqKAA7KihAOyoogDsqKMA7KikAOyopQDsqKYA7KinAOyoqADsqKkA7KiqAOyoqwDsqKwA7KitAOyorgDsqK8A7KiwAOyosQDsqLIA7KizAOyotADsqLUA7Ki2AOyotwDsqLgA7Ki5AOyougDsqLsA7Ki8AOyovQDsqL4A7Ki/AOypgADsqYEA7KmCAOypgwDsqYQA7KmFAOyphgDsqYcA7KmIAOypiQDsqYoA7KmLAOypjADsqY0A7KmOAOypjwDsqZAA7KmRAOypkgDsqZMA7KmUAOyplQDsqZYA7KmXAOypmADsqZkA7KmaAOypmwDsqZwA7KmdAOypngDsqZ8A7KmgAOypoQDsqaIA7KmjAOyppADsqaUA7KmmAOyppwDsqagA7KmpAOypqgDsqasA7KmsAOyprQDsqa4A7KmvAOypsADsqbEA7KmyAOypswDsqbQA7Km1AOyptgDsqbcA7Km4AOypuQDsqboA7Km7AOypvADsqb0A7Km+AOypvwDsqoAA7KqBAOyqggDsqoMA7KqEAOyqhQDsqoYA7KqHAOyqiADsqokA7KqKAOyqiwDsqowA7KqNAOyqjgDsqo8A7KqQAOyqkQDsqpIA7KqTAOyqlADsqpUA7KqWAOyqlwDsqpgA7KqZAOyqmgDsqpsA7KqcAOyqnQDsqp4A7KqfAOyqoADsqqEA7KqiAOyqowDsqqQA7KqlAOyqpgDsqqcA7KqoAOyqqQDsqqoA7KqrAOyqrADsqq0A7KquAOyqrwDsqrAA7KqxAOyqsgDsqrMA7Kq0AOyqtQDsqrYA7Kq3AOyquADsqrkA7Kq6AOyquwDsqrwA7Kq9AOyqvgDsqr8A7KuAAOyrgQDsq4IA7KuDAOyrhADsq4UA7KuGAOyrhwDsq4gA7KuJAOyrigDsq4sA7KuMAOyrjQDsq44A7KuPAOyrkADsq5EA7KuSAOyrkwDsq5QA7KuVAOyrlgDsq5cA7KuYAOyrmQDsq5oA7KubAOyrnADsq50A7KueAOyrnwDsq6AA7KuhAOyrogDsq6MA7KukAOyrpQDsq6YA7KunAOyrqADsq6kA7KuqAOyrqwDsq6wA7KutAOyrrgDsq68A7KuwAOyrsQDsq7IA7KuzAOyrtADsq7UA7Ku2AOyrtwDsq7gA7Ku5AOyrugDsq7sA7Ku8AOyrvQDsq74A7Ku/AOysgADsrIEA7KyCAOysgwDsrIQA7KyFAOyshgDsrIcA7KyIAOysiQDsrIoA7KyLAOysjADsrI0A7KyOAOysjwDsrJAA7KyRAOyskgDsrJMA7KyUAOyslQDsrJYA7KyXAOysmADsrJkA7KyaAOysmwDsrJwA7KydAOysngDsrJ8A7KygAOysoQDsrKIA7KyjAOyspADsrKUA7KymAOyspwDsrKgA7KypAOysqgDsrKsA7KysAOysrQDsrK4A7KyvAOyssADsrLEA7KyyAOysswDsrLQA7Ky1AOystgDsrLcA7Ky4AOysuQDsrLoA7Ky7AOysvADsrL0A7Ky+AOysvwDsrYAA7K2BAOytggDsrYMA7K2EAOythQDsrYYA7K2HAOytiADsrYkA7K2KAOytiwDsrYwA7K2NAOytjgDsrY8A7K2QAOytkQDsrZIA7K2TAOytlADsrZUA7K2WAOytlwDsrZgA7K2ZAOytmgDsrZsA7K2cAOytnQDsrZ4A7K2fAOytoADsraEA7K2iAOytowDsraQA7K2lAOytpgDsracA7K2oAOytqQDsraoA7K2rAOytrADsra0A7K2uAOytrwDsrbAA7K2xAOytsgDsrbMA7K20AOyttQDsrbYA7K23AOytuADsrbkA7K26AOytuwDsrbwA7K29AOytvgDsrb8A7K6AAOyugQDsroIA7K6DAOyuhADsroUA7K6GAOyuhwDsrogA7K6JAOyuigDsrosA7K6MAOyujQDsro4A7K6PAOyukADsrpEA7K6SAOyukwDsrpQA7K6VAOyulgDsrpcA7K6YAOyumQDsrpoA7K6bAOyunADsrp0A7K6eAOyunwDsrqAA7K6hAOyuogDsrqMA7K6kAOyupQDsrqYA7K6nAOyuqADsrqkA7K6qAOyuqwDsrqwA7K6tAOyurgDsrq8A7K6wAOyusQDsrrIA7K6zAOyutADsrrUA7K62AOyutwDsrrgA7K65AOyuugDsrrsA7K68AOyuvQDsrr4A7K6/AOyvgADsr4EA7K+CAOyvgwDsr4QA7K+FAOyvhgDsr4cA7K+IAOyviQDsr4oA7K+LAOyvjADsr40A7K+OAOyvjwDsr5AA7K+RAOyvkgDsr5MA7K+UAOyvlQDsr5YA7K+XAOyvmADsr5kA7K+aAOyvmwDsr5wA7K+dAOyvngDsr58A7K+gAOyvoQDsr6IA7K+jAOyvpADsr6UA7K+mAOyvpwDsr6gA7K+pAOyvqgDsr6sA7K+sAOyvrQDsr64A7K+vAOyvsADsr7EA7K+yAOyvswDsr7QA7K+1AOyvtgDsr7cA7K+4AOyvuQDsr7oA7K+7AOyvvADsr70A7K++AOyvvwDssIAA7LCBAOywggDssIMA7LCEAOywhQDssIYA7LCHAOywiADssIkA7LCKAOywiwDssIwA7LCNAOywjgDssI8A7LCQAOywkQDssJIA7LCTAOywlADssJUA7LCWAOywlwDssJgA7LCZAOywmgDssJsA7LCcAOywnQDssJ4A7LCfAOywoADssKEA7LCiAOywowDssKQA7LClAOywpgDssKcA7LCoAOywqQDssKoA7LCrAOywrADssK0A7LCuAOywrwDssLAA7LCxAOywsgDssLMA7LC0AOywtQDssLYA7LC3AOywuADssLjqs6AA7LC5AOywugDssLsA7LC8AOywvQDssL4A7LC/AOyxgADssYEA7LGCAOyxgwDssYQA7LGFAOyxhgDssYcA7LGIAOyxiQDssYoA7LGLAOyxjADssY0A7LGOAOyxjwDssZAA7LGRAOyxkgDssZMA7LGUAOyxlQDssZYA7LGXAOyxmADssZkA7LGaAOyxmwDssZwA7LGdAOyxngDssZ8A7LGgAOyxoQDssaIA7LGjAOyxpADssaUA7LGmAOyxpwDssagA7LGpAOyxqgDssasA7LGsAOyxrQDssa4A7LGvAOyxsADssbEA7LGyAOyxswDssbQA7LG1AOyxtgDssbcA7LG4AOyxuQDssboA7LG7AOyxvADssb0A7LG+AOyxvwDssoAA7LKBAOyyggDssoMA7LKEAOyyhQDssoYA7LKHAOyyiADssokA7LKKAOyyiwDssowA7LKNAOyyjgDsso8A7LKQAOyykQDsspIA7LKTAOyylADsspUA7LKWAOyylwDsspgA7LKZAOyymgDsspsA7LKcAOyynQDssp4A7LKfAOyyoADssqEA7LKiAOyyowDssqQA7LKlAOyypgDssqcA7LKoAOyyqQDssqoA7LKrAOyyrADssq0A7LKuAOyyrwDssrAA7LKxAOyysgDssrMA7LK0AOyytQDssrYA7LK3AOyyuADssrkA7LK6AOyyuwDssrwA7LK9AOyyvgDssr8A7LOAAOyzgQDss4IA7LODAOyzhADss4UA7LOGAOyzhwDss4gA7LOJAOyzigDss4sA7LOMAOyzjQDss44A7LOPAOyzkADss5EA7LOSAOyzkwDss5QA7LOVAOyzlgDss5cA7LOYAOyzmQDss5oA7LObAOyznADss50A7LOeAOyznwDss6AA7LOhAOyzogDss6MA7LOkAOyzpQDss6YA7LOnAOyzqADss6kA7LOqAOyzqwDss6wA7LOtAOyzrgDss68A7LOwAOyzsQDss7IA7LOzAOyztADss7UA7LO2AOyztwDss7gA7LO5AOyzugDss7sA7LO8AOyzvQDss74A7LO/AOy0gADstIEA7LSCAOy0gwDstIQA7LSFAOy0hgDstIcA7LSIAOy0iQDstIoA7LSLAOy0jADstI0A7LSOAOy0jwDstJAA7LSRAOy0kgDstJMA7LSUAOy0lQDstJYA7LSXAOy0mADstJkA7LSaAOy0mwDstJwA7LSdAOy0ngDstJ8A7LSgAOy0oQDstKIA7LSjAOy0pADstKUA7LSmAOy0pwDstKgA7LSpAOy0qgDstKsA7LSsAOy0rQDstK4A7LSvAOy0sADstLEA7LSyAOy0swDstLQA7LS1AOy0tgDstLcA7LS4AOy0uQDstLoA7LS7AOy0vADstL0A7LS+AOy0vwDstYAA7LWBAOy1ggDstYMA7LWEAOy1hQDstYYA7LWHAOy1iADstYkA7LWKAOy1iwDstYwA7LWNAOy1jgDstY8A7LWQAOy1kQDstZIA7LWTAOy1lADstZUA7LWWAOy1lwDstZgA7LWZAOy1mgDstZsA7LWcAOy1nQDstZ4A7LWfAOy1oADstaEA7LWiAOy1owDstaQA7LWlAOy1pgDstacA7LWoAOy1qQDstaoA7LWrAOy1rADsta0A7LWuAOy1rwDstbAA7LWxAOy1sgDstbMA7LW0AOy1tQDstbYA7LW3AOy1uADstbkA7LW6AOy1uwDstbwA7LW9AOy1vgDstb8A7LaAAOy2gQDstoIA7LaDAOy2hADstoUA7LaGAOy2hwDstogA7LaJAOy2igDstosA7LaMAOy2jQDsto4A7LaPAOy2kADstpEA7LaSAOy2kwDstpQA7LaVAOy2lgDstpcA7LaYAOy2mQDstpoA7LabAOy2nADstp0A7LaeAOy2nwDstqAA7LahAOy2ogDstqMA7LakAOy2pQDstqYA7LanAOy2qADstqkA7LaqAOy2qwDstqwA7LatAOy2rgDstq8A7LawAOy2sQDstrIA7LazAOy2tADstrUA7La2AOy2twDstrgA7La5AOy2ugDstrsA7La8AOy2vQDstr4A7La/AOy3gADst4EA7LeCAOy3gwDst4QA7LeFAOy3hgDst4cA7LeIAOy3iQDst4oA7LeLAOy3jADst40A7LeOAOy3jwDst5AA7LeRAOy3kgDst5MA7LeUAOy3lQDst5YA7LeXAOy3mADst5kA7LeaAOy3mwDst5wA7LedAOy3ngDst58A7LegAOy3oQDst6IA7LejAOy3pADst6UA7LemAOy3pwDst6gA7LepAOy3qgDst6sA7LesAOy3rQDst64A7LevAOy3sADst7EA7LeyAOy3swDst7QA7Le1AOy3tgDst7cA7Le4AOy3uQDst7oA7Le7AOy3vADst70A7Le+AOy3vwDsuIAA7LiBAOy4ggDsuIMA7LiEAOy4hQDsuIYA7LiHAOy4iADsuIkA7LiKAOy4iwDsuIwA7LiNAOy4jgDsuI8A7LiQAOy4kQDsuJIA7LiTAOy4lADsuJUA7LiWAOy4lwDsuJgA7LiZAOy4mgDsuJsA7LicAOy4nQDsuJ4A7LifAOy4oADsuKEA7LiiAOy4owDsuKQA7LilAOy4pgDsuKcA7LioAOy4qQDsuKoA7LirAOy4rADsuK0A7LiuAOy4rwDsuLAA7LixAOy4sgDsuLMA7Li0AOy4tQDsuLYA7Li3AOy4uADsuLkA7Li6AOy4uwDsuLwA7Li9AOy4vgDsuL8A7LmAAOy5gQDsuYIA7LmDAOy5hADsuYUA7LmGAOy5hwDsuYgA7LmJAOy5igDsuYsA7LmMAOy5jQDsuY4A7LmPAOy5kADsuZEA7LmSAOy5kwDsuZQA7LmVAOy5lgDsuZcA7LmYAOy5mQDsuZoA7LmbAOy5nADsuZ0A7LmeAOy5nwDsuaAA7LmhAOy5ogDsuaMA7LmkAOy5pQDsuaYA7LmnAOy5qADsuakA7LmqAOy5qwDsuawA7LmtAOy5rgDsua8A7LmwAOy5sQDsubIA7LmzAOy5tADsubUA7Lm2AOy5twDsubgA7Lm5AOy5ugDsubsA7Lm8AOy5vQDsub4A7Lm/AOy6gADsuoEA7LqCAOy6gwDsuoQA7LqFAOy6hgDsuocA7LqIAOy6iQDsuooA7LqLAOy6jADsuo0A7LqOAOy6jwDsupAA7LqRAOy6kgDsupMA7LqUAOy6lQDsupYA7LqXAOy6mADsupkA7LqaAOy6mwDsupwA7LqdAOy6ngDsup8A7LqgAOy6oQDsuqIA7LqjAOy6pADsuqUA7LqmAOy6pwDsuqgA7LqpAOy6qgDsuqsA7LqsAOy6rQDsuq4A7LqvAOy6sADsurEA7LqyAOy6swDsurQA7Lq1AOy6tgDsurcA7Lq4AOy6uQDsuroA7Lq7AOy6vADsur0A7Lq+AOy6vwDsu4AA7LuBAOy7ggDsu4MA7LuEAOy7hQDsu4YA7LuHAOy7iADsu4kA7LuKAOy7iwDsu4wA7LuNAOy7jgDsu48A7LuQAOy7kQDsu5IA7LuTAOy7lADsu5UA7LuWAOy7lwDsu5gA7LuZAOy7mgDsu5sA7LucAOy7nQDsu54A7LufAOy7oADsu6EA7LuiAOy7owDsu6QA7LulAOy7pgDsu6cA7LuoAOy7qQDsu6oA7LurAOy7rADsu60A7LuuAOy7rwDsu7AA7LuxAOy7sgDsu7MA7Lu0AOy7tQDsu7YA7Lu3AOy7uADsu7kA7Lu6AOy7uwDsu7wA7Lu9AOy7vgDsu78A7LyAAOy8gQDsvIIA7LyDAOy8hADsvIUA7LyGAOy8hwDsvIgA7LyJAOy8igDsvIsA7LyMAOy8jQDsvI4A7LyPAOy8kADsvJEA7LySAOy8kwDsvJQA7LyVAOy8lgDsvJcA7LyYAOy8mQDsvJoA7LybAOy8nADsvJ0A7LyeAOy8nwDsvKAA7LyhAOy8ogDsvKMA7LykAOy8pQDsvKYA7LynAOy8qADsvKkA7LyqAOy8qwDsvKwA7LytAOy8rgDsvK8A7LywAOy8sQDsvLIA7LyzAOy8tADsvLUA7Ly2AOy8twDsvLgA7Ly5AOy8ugDsvLsA7Ly8AOy8vQDsvL4A7Ly/AOy9gADsvYEA7L2CAOy9gwDsvYQA7L2FAOy9hgDsvYcA7L2IAOy9iQDsvYoA7L2LAOy9jADsvY0A7L2OAOy9jwDsvZAA7L2RAOy9kgDsvZMA7L2UAOy9lQDsvZYA7L2XAOy9mADsvZkA7L2aAOy9mwDsvZwA7L2dAOy9ngDsvZ8A7L2gAOy9oQDsvaIA7L2jAOy9pADsvaUA7L2mAOy9pwDsvagA7L2pAOy9qgDsvasA7L2sAOy9rQDsva4A7L2vAOy9sADsvbEA7L2yAOy9swDsvbQA7L21AOy9tgDsvbcA7L24AOy9uQDsvboA7L27AOy9vADsvb0A7L2+AOy9vwDsvoAA7L6BAOy+ggDsvoMA7L6EAOy+hQDsvoYA7L6HAOy+iADsvokA7L6KAOy+iwDsvowA7L6NAOy+jgDsvo8A7L6QAOy+kQDsvpIA7L6TAOy+lADsvpUA7L6WAOy+lwDsvpgA7L6ZAOy+mgDsvpsA7L6cAOy+nQDsvp4A7L6fAOy+oADsvqEA7L6iAOy+owDsvqQA7L6lAOy+pgDsvqcA7L6oAOy+qQDsvqoA7L6rAOy+rADsvq0A7L6uAOy+rwDsvrAA7L6xAOy+sgDsvrMA7L60AOy+tQDsvrYA7L63AOy+uADsvrkA7L66AOy+uwDsvrwA7L69AOy+vgDsvr8A7L+AAOy/gQDsv4IA7L+DAOy/hADsv4UA7L+GAOy/hwDsv4gA7L+JAOy/igDsv4sA7L+MAOy/jQDsv44A7L+PAOy/kADsv5EA7L+SAOy/kwDsv5QA7L+VAOy/lgDsv5cA7L+YAOy/mQDsv5oA7L+bAOy/nADsv50A7L+eAOy/nwDsv6AA7L+hAOy/ogDsv6MA7L+kAOy/pQDsv6YA7L+nAOy/qADsv6kA7L+qAOy/qwDsv6wA7L+tAOy/rgDsv68A7L+wAOy/sQDsv7IA7L+zAOy/tADsv7UA7L+2AOy/twDsv7gA7L+5AOy/ugDsv7sA7L+8AOy/vQDsv74A7L+/AO2AgADtgIEA7YCCAO2AgwDtgIQA7YCFAO2AhgDtgIcA7YCIAO2AiQDtgIoA7YCLAO2AjADtgI0A7YCOAO2AjwDtgJAA7YCRAO2AkgDtgJMA7YCUAO2AlQDtgJYA7YCXAO2AmADtgJkA7YCaAO2AmwDtgJwA7YCdAO2AngDtgJ8A7YCgAO2AoQDtgKIA7YCjAO2ApADtgKUA7YCmAO2ApwDtgKgA7YCpAO2AqgDtgKsA7YCsAO2ArQDtgK4A7YCvAO2AsADtgLEA7YCyAO2AswDtgLQA7YC1AO2AtgDtgLcA7YC4AO2AuQDtgLoA7YC7AO2AvADtgL0A7YC+AO2AvwDtgYAA7YGBAO2BggDtgYMA7YGEAO2BhQDtgYYA7YGHAO2BiADtgYkA7YGKAO2BiwDtgYwA7YGNAO2BjgDtgY8A7YGQAO2BkQDtgZIA7YGTAO2BlADtgZUA7YGWAO2BlwDtgZgA7YGZAO2BmgDtgZsA7YGcAO2BnQDtgZ4A7YGfAO2BoADtgaEA7YGiAO2BowDtgaQA7YGlAO2BpgDtgacA7YGoAO2BqQDtgaoA7YGrAO2BrADtga0A7YGuAO2BrwDtgbAA7YGxAO2BsgDtgbMA7YG0AO2BtQDtgbYA7YG3AO2BuADtgbkA7YG6AO2BuwDtgbwA7YG9AO2BvgDtgb8A7YKAAO2CgQDtgoIA7YKDAO2ChADtgoUA7YKGAO2ChwDtgogA7YKJAO2CigDtgosA7YKMAO2CjQDtgo4A7YKPAO2CkADtgpEA7YKSAO2CkwDtgpQA7YKVAO2ClgDtgpcA7YKYAO2CmQDtgpoA7YKbAO2CnADtgp0A7YKeAO2CnwDtgqAA7YKhAO2CogDtgqMA7YKkAO2CpQDtgqYA7YKnAO2CqADtgqkA7YKqAO2CqwDtgqwA7YKtAO2CrgDtgq8A7YKwAO2CsQDtgrIA7YKzAO2CtADtgrUA7YK2AO2CtwDtgrgA7YK5AO2CugDtgrsA7YK8AO2CvQDtgr4A7YK/AO2DgADtg4EA7YOCAO2DgwDtg4QA7YOFAO2DhgDtg4cA7YOIAO2DiQDtg4oA7YOLAO2DjADtg40A7YOOAO2DjwDtg5AA7YORAO2DkgDtg5MA7YOUAO2DlQDtg5YA7YOXAO2DmADtg5kA7YOaAO2DmwDtg5wA7YOdAO2DngDtg58A7YOgAO2DoQDtg6IA7YOjAO2DpADtg6UA7YOmAO2DpwDtg6gA7YOpAO2DqgDtg6sA7YOsAO2DrQDtg64A7YOvAO2DsADtg7EA7YOyAO2DswDtg7QA7YO1AO2DtgDtg7cA7YO4AO2DuQDtg7oA7YO7AO2DvADtg70A7YO+AO2DvwDthIAA7YSBAO2EggDthIMA7YSEAO2EhQDthIYA7YSHAO2EiADthIkA7YSKAO2EiwDthIwA7YSNAO2EjgDthI8A7YSQAO2EkQDthJIA7YSTAO2ElADthJUA7YSWAO2ElwDthJgA7YSZAO2EmgDthJsA7YScAO2EnQDthJ4A7YSfAO2EoADthKEA7YSiAO2EowDthKQA7YSlAO2EpgDthKcA7YSoAO2EqQDthKoA7YSrAO2ErADthK0A7YSuAO2ErwDthLAA7YSxAO2EsgDthLMA7YS0AO2EtQDthLYA7YS3AO2EuADthLkA7YS6AO2EuwDthLwA7YS9AO2EvgDthL8A7YWAAO2FgQDthYIA7YWDAO2FhADthYUA7YWGAO2FhwDthYgA7YWJAO2FigDthYsA7YWMAO2FjQDthY4A7YWPAO2FkADthZEA7YWSAO2FkwDthZQA7YWVAO2FlgDthZcA7YWYAO2FmQDthZoA7YWbAO2FnADthZ0A7YWeAO2FnwDthaAA7YWhAO2FogDthaMA7YWkAO2FpQDthaYA7YWnAO2FqADthakA7YWqAO2FqwDthawA7YWtAO2FrgDtha8A7YWwAO2FsQDthbIA7YWzAO2FtADthbUA7YW2AO2FtwDthbgA7YW5AO2FugDthbsA7YW8AO2FvQDthb4A7YW/AO2GgADthoEA7YaCAO2GgwDthoQA7YaFAO2GhgDthocA7YaIAO2GiQDthooA7YaLAO2GjADtho0A7YaOAO2GjwDthpAA7YaRAO2GkgDthpMA7YaUAO2GlQDthpYA7YaXAO2GmADthpkA7YaaAO2GmwDthpwA7YadAO2GngDthp8A7YagAO2GoQDthqIA7YajAO2GpADthqUA7YamAO2GpwDthqgA7YapAO2GqgDthqsA7YasAO2GrQDthq4A7YavAO2GsADthrEA7YayAO2GswDthrQA7Ya1AO2GtgDthrcA7Ya4AO2GuQDthroA7Ya7AO2GvADthr0A7Ya+AO2GvwDth4AA7YeBAO2HggDth4MA7YeEAO2HhQDth4YA7YeHAO2HiADth4kA7YeKAO2HiwDth4wA7YeNAO2HjgDth48A7YeQAO2HkQDth5IA7YeTAO2HlADth5UA7YeWAO2HlwDth5gA7YeZAO2HmgDth5sA7YecAO2HnQDth54A7YefAO2HoADth6EA7YeiAO2HowDth6QA7YelAO2HpgDth6cA7YeoAO2HqQDth6oA7YerAO2HrADth60A7YeuAO2HrwDth7AA7YexAO2HsgDth7MA7Ye0AO2HtQDth7YA7Ye3AO2HuADth7kA7Ye6AO2HuwDth7wA7Ye9AO2HvgDth78A7YiAAO2IgQDtiIIA7YiDAO2IhADtiIUA7YiGAO2IhwDtiIgA7YiJAO2IigDtiIsA7YiMAO2IjQDtiI4A7YiPAO2IkADtiJEA7YiSAO2IkwDtiJQA7YiVAO2IlgDtiJcA7YiYAO2ImQDtiJoA7YibAO2InADtiJ0A7YieAO2InwDtiKAA7YihAO2IogDtiKMA7YikAO2IpQDtiKYA7YinAO2IqADtiKkA7YiqAO2IqwDtiKwA7YitAO2IrgDtiK8A7YiwAO2IsQDtiLIA7YizAO2ItADtiLUA7Yi2AO2ItwDtiLgA7Yi5AO2IugDtiLsA7Yi8AO2IvQDtiL4A7Yi/AO2JgADtiYEA7YmCAO2JgwDtiYQA7YmFAO2JhgDtiYcA7YmIAO2JiQDtiYoA7YmLAO2JjADtiY0A7YmOAO2JjwDtiZAA7YmRAO2JkgDtiZMA7YmUAO2JlQDtiZYA7YmXAO2JmADtiZkA7YmaAO2JmwDtiZwA7YmdAO2JngDtiZ8A7YmgAO2JoQDtiaIA7YmjAO2JpADtiaUA7YmmAO2JpwDtiagA7YmpAO2JqgDtiasA7YmsAO2JrQDtia4A7YmvAO2JsADtibEA7YmyAO2JswDtibQA7Ym1AO2JtgDtibcA7Ym4AO2JuQDtiboA7Ym7AO2JvADtib0A7Ym+AO2JvwDtioAA7YqBAO2KggDtioMA7YqEAO2KhQDtioYA7YqHAO2KiADtiokA7YqKAO2KiwDtiowA7YqNAO2KjgDtio8A7YqQAO2KkQDtipIA7YqTAO2KlADtipUA7YqWAO2KlwDtipgA7YqZAO2KmgDtipsA7YqcAO2KnQDtip4A7YqfAO2KoADtiqEA7YqiAO2KowDtiqQA7YqlAO2KpgDtiqcA7YqoAO2KqQDtiqoA7YqrAO2KrADtiq0A7YquAO2KrwDtirAA7YqxAO2KsgDtirMA7Yq0AO2KtQDtirYA7Yq3AO2KuADtirkA7Yq6AO2KuwDtirwA7Yq9AO2KvgDtir8A7YuAAO2LgQDti4IA7YuDAO2LhADti4UA7YuGAO2LhwDti4gA7YuJAO2LigDti4sA7YuMAO2LjQDti44A7YuPAO2LkADti5EA7YuSAO2LkwDti5QA7YuVAO2LlgDti5cA7YuYAO2LmQDti5oA7YubAO2LnADti50A7YueAO2LnwDti6AA7YuhAO2LogDti6MA7YukAO2LpQDti6YA7YunAO2LqADti6kA7YuqAO2LqwDti6wA7YutAO2LrgDti68A7YuwAO2LsQDti7IA7YuzAO2LtADti7UA7Yu2AO2LtwDti7gA7Yu5AO2LugDti7sA7Yu8AO2LvQDti74A7Yu/AO2MgADtjIEA7YyCAO2MgwDtjIQA7YyFAO2MhgDtjIcA7YyIAO2MiQDtjIoA7YyLAO2MjADtjI0A7YyOAO2MjwDtjJAA7YyRAO2MkgDtjJMA7YyUAO2MlQDtjJYA7YyXAO2MmADtjJkA7YyaAO2MmwDtjJwA7YydAO2MngDtjJ8A7YygAO2MoQDtjKIA7YyjAO2MpADtjKUA7YymAO2MpwDtjKgA7YypAO2MqgDtjKsA7YysAO2MrQDtjK4A7YyvAO2MsADtjLEA7YyyAO2MswDtjLQA7Yy1AO2MtgDtjLcA7Yy4AO2MuQDtjLoA7Yy7AO2MvADtjL0A7Yy+AO2MvwDtjYAA7Y2BAO2NggDtjYMA7Y2EAO2NhQDtjYYA7Y2HAO2NiADtjYkA7Y2KAO2NiwDtjYwA7Y2NAO2NjgDtjY8A7Y2QAO2NkQDtjZIA7Y2TAO2NlADtjZUA7Y2WAO2NlwDtjZgA7Y2ZAO2NmgDtjZsA7Y2cAO2NnQDtjZ4A7Y2fAO2NoADtjaEA7Y2iAO2NowDtjaQA7Y2lAO2NpgDtjacA7Y2oAO2NqQDtjaoA7Y2rAO2NrADtja0A7Y2uAO2NrwDtjbAA7Y2xAO2NsgDtjbMA7Y20AO2NtQDtjbYA7Y23AO2NuADtjbkA7Y26AO2NuwDtjbwA7Y29AO2NvgDtjb8A7Y6AAO2OgQDtjoIA7Y6DAO2OhADtjoUA7Y6GAO2OhwDtjogA7Y6JAO2OigDtjosA7Y6MAO2OjQDtjo4A7Y6PAO2OkADtjpEA7Y6SAO2OkwDtjpQA7Y6VAO2OlgDtjpcA7Y6YAO2OmQDtjpoA7Y6bAO2OnADtjp0A7Y6eAO2OnwDtjqAA7Y6hAO2OogDtjqMA7Y6kAO2OpQDtjqYA7Y6nAO2OqADtjqkA7Y6qAO2OqwDtjqwA7Y6tAO2OrgDtjq8A7Y6wAO2OsQDtjrIA7Y6zAO2OtADtjrUA7Y62AO2OtwDtjrgA7Y65AO2OugDtjrsA7Y68AO2OvQDtjr4A7Y6/AO2PgADtj4EA7Y+CAO2PgwDtj4QA7Y+FAO2PhgDtj4cA7Y+IAO2PiQDtj4oA7Y+LAO2PjADtj40A7Y+OAO2PjwDtj5AA7Y+RAO2PkgDtj5MA7Y+UAO2PlQDtj5YA7Y+XAO2PmADtj5kA7Y+aAO2PmwDtj5wA7Y+dAO2PngDtj58A7Y+gAO2PoQDtj6IA7Y+jAO2PpADtj6UA7Y+mAO2PpwDtj6gA7Y+pAO2PqgDtj6sA7Y+sAO2PrQDtj64A7Y+vAO2PsADtj7EA7Y+yAO2PswDtj7QA7Y+1AO2PtgDtj7cA7Y+4AO2PuQDtj7oA7Y+7AO2PvADtj70A7Y++AO2PvwDtkIAA7ZCBAO2QggDtkIMA7ZCEAO2QhQDtkIYA7ZCHAO2QiADtkIkA7ZCKAO2QiwDtkIwA7ZCNAO2QjgDtkI8A7ZCQAO2QkQDtkJIA7ZCTAO2QlADtkJUA7ZCWAO2QlwDtkJgA7ZCZAO2QmgDtkJsA7ZCcAO2QnQDtkJ4A7ZCfAO2QoADtkKEA7ZCiAO2QowDtkKQA7ZClAO2QpgDtkKcA7ZCoAO2QqQDtkKoA7ZCrAO2QrADtkK0A7ZCuAO2QrwDtkLAA7ZCxAO2QsgDtkLMA7ZC0AO2QtQDtkLYA7ZC3AO2QuADtkLkA7ZC6AO2QuwDtkLwA7ZC9AO2QvgDtkL8A7ZGAAO2RgQDtkYIA7ZGDAO2RhADtkYUA7ZGGAO2RhwDtkYgA7ZGJAO2RigDtkYsA7ZGMAO2RjQDtkY4A7ZGPAO2RkADtkZEA7ZGSAO2RkwDtkZQA7ZGVAO2RlgDtkZcA7ZGYAO2RmQDtkZoA7ZGbAO2RnADtkZ0A7ZGeAO2RnwDtkaAA7ZGhAO2RogDtkaMA7ZGkAO2RpQDtkaYA7ZGnAO2RqADtkakA7ZGqAO2RqwDtkawA7ZGtAO2RrgDtka8A7ZGwAO2RsQDtkbIA7ZGzAO2RtADtkbUA7ZG2AO2RtwDtkbgA7ZG5AO2RugDtkbsA7ZG8AO2RvQDtkb4A7ZG/AO2SgADtkoEA7ZKCAO2SgwDtkoQA7ZKFAO2ShgDtkocA7ZKIAO2SiQDtkooA7ZKLAO2SjADtko0A7ZKOAO2SjwDtkpAA7ZKRAO2SkgDtkpMA7ZKUAO2SlQDtkpYA7ZKXAO2SmADtkpkA7ZKaAO2SmwDtkpwA7ZKdAO2SngDtkp8A7ZKgAO2SoQDtkqIA7ZKjAO2SpADtkqUA7ZKmAO2SpwDtkqgA7ZKpAO2SqgDtkqsA7ZKsAO2SrQDtkq4A7ZKvAO2SsADtkrEA7ZKyAO2SswDtkrQA7ZK1AO2StgDtkrcA7ZK4AO2SuQDtkroA7ZK7AO2SvADtkr0A7ZK+AO2SvwDtk4AA7ZOBAO2TggDtk4MA7ZOEAO2ThQDtk4YA7ZOHAO2TiADtk4kA7ZOKAO2TiwDtk4wA7ZONAO2TjgDtk48A7ZOQAO2TkQDtk5IA7ZOTAO2TlADtk5UA7ZOWAO2TlwDtk5gA7ZOZAO2TmgDtk5sA7ZOcAO2TnQDtk54A7ZOfAO2ToADtk6EA7ZOiAO2TowDtk6QA7ZOlAO2TpgDtk6cA7ZOoAO2TqQDtk6oA7ZOrAO2TrADtk60A7ZOuAO2TrwDtk7AA7ZOxAO2TsgDtk7MA7ZO0AO2TtQDtk7YA7ZO3AO2TuADtk7kA7ZO6AO2TuwDtk7wA7ZO9AO2TvgDtk78A7ZSAAO2UgQDtlIIA7ZSDAO2UhADtlIUA7ZSGAO2UhwDtlIgA7ZSJAO2UigDtlIsA7ZSMAO2UjQDtlI4A7ZSPAO2UkADtlJEA7ZSSAO2UkwDtlJQA7ZSVAO2UlgDtlJcA7ZSYAO2UmQDtlJoA7ZSbAO2UnADtlJ0A7ZSeAO2UnwDtlKAA7ZShAO2UogDtlKMA7ZSkAO2UpQDtlKYA7ZSnAO2UqADtlKkA7ZSqAO2UqwDtlKwA7ZStAO2UrgDtlK8A7ZSwAO2UsQDtlLIA7ZSzAO2UtADtlLUA7ZS2AO2UtwDtlLgA7ZS5AO2UugDtlLsA7ZS8AO2UvQDtlL4A7ZS/AO2VgADtlYEA7ZWCAO2VgwDtlYQA7ZWFAO2VhgDtlYcA7ZWIAO2ViQDtlYoA7ZWLAO2VjADtlY0A7ZWOAO2VjwDtlZAA7ZWRAO2VkgDtlZMA7ZWUAO2VlQDtlZYA7ZWXAO2VmADtlZkA7ZWaAO2VmwDtlZwA7ZWdAO2VngDtlZ8A7ZWgAO2VoQDtlaIA7ZWjAO2VpADtlaUA7ZWmAO2VpwDtlagA7ZWpAO2VqgDtlasA7ZWsAO2VrQDtla4A7ZWvAO2VsADtlbEA7ZWyAO2VswDtlbQA7ZW1AO2VtgDtlbcA7ZW4AO2VuQDtlboA7ZW7AO2VvADtlb0A7ZW+AO2VvwDtloAA7ZaBAO2WggDtloMA7ZaEAO2WhQDtloYA7ZaHAO2WiADtlokA7ZaKAO2WiwDtlowA7ZaNAO2WjgDtlo8A7ZaQAO2WkQDtlpIA7ZaTAO2WlADtlpUA7ZaWAO2WlwDtlpgA7ZaZAO2WmgDtlpsA7ZacAO2WnQDtlp4A7ZafAO2WoADtlqEA7ZaiAO2WowDtlqQA7ZalAO2WpgDtlqcA7ZaoAO2WqQDtlqoA7ZarAO2WrADtlq0A7ZauAO2WrwDtlrAA7ZaxAO2WsgDtlrMA7Za0AO2WtQDtlrYA7Za3AO2WuADtlrkA7Za6AO2WuwDtlrwA7Za9AO2WvgDtlr8A7ZeAAO2XgQDtl4IA7ZeDAO2XhADtl4UA7ZeGAO2XhwDtl4gA7ZeJAO2XigDtl4sA7ZeMAO2XjQDtl44A7ZePAO2XkADtl5EA7ZeSAO2XkwDtl5QA7ZeVAO2XlgDtl5cA7ZeYAO2XmQDtl5oA7ZebAO2XnADtl50A7ZeeAO2XnwDtl6AA7ZehAO2XogDtl6MA7ZekAO2XpQDtl6YA7ZenAO2XqADtl6kA7ZeqAO2XqwDtl6wA7ZetAO2XrgDtl68A7ZewAO2XsQDtl7IA7ZezAO2XtADtl7UA7Ze2AO2XtwDtl7gA7Ze5AO2XugDtl7sA7Ze8AO2XvQDtl74A7Ze/AO2YgADtmIEA7ZiCAO2YgwDtmIQA7ZiFAO2YhgDtmIcA7ZiIAO2YiQDtmIoA7ZiLAO2YjADtmI0A7ZiOAO2YjwDtmJAA7ZiRAO2YkgDtmJMA7ZiUAO2YlQDtmJYA7ZiXAO2YmADtmJkA7ZiaAO2YmwDtmJwA7ZidAO2YngDtmJ8A7ZigAO2YoQDtmKIA7ZijAO2YpADtmKUA7ZimAO2YpwDtmKgA7ZipAO2YqgDtmKsA7ZisAO2YrQDtmK4A7ZivAO2YsADtmLEA7ZiyAO2YswDtmLQA7Zi1AO2YtgDtmLcA7Zi4AO2YuQDtmLoA7Zi7AO2YvADtmL0A7Zi+AO2YvwDtmYAA7ZmBAO2ZggDtmYMA7ZmEAO2ZhQDtmYYA7ZmHAO2ZiADtmYkA7ZmKAO2ZiwDtmYwA7ZmNAO2ZjgDtmY8A7ZmQAO2ZkQDtmZIA7ZmTAO2ZlADtmZUA7ZmWAO2ZlwDtmZgA7ZmZAO2ZmgDtmZsA7ZmcAO2ZnQDtmZ4A7ZmfAO2ZoADtmaEA7ZmiAO2ZowDtmaQA7ZmlAO2ZpgDtmacA7ZmoAO2ZqQDtmaoA7ZmrAO2ZrADtma0A7ZmuAO2ZrwDtmbAA7ZmxAO2ZsgDtmbMA7Zm0AO2ZtQDtmbYA7Zm3AO2ZuADtmbkA7Zm6AO2ZuwDtmbwA7Zm9AO2ZvgDtmb8A7ZqAAO2agQDtmoIA7ZqDAO2ahADtmoUA7ZqGAO2ahwDtmogA7ZqJAO2aigDtmosA7ZqMAO2ajQDtmo4A7ZqPAO2akADtmpEA7ZqSAO2akwDtmpQA7ZqVAO2algDtmpcA7ZqYAO2amQDtmpoA7ZqbAO2anADtmp0A7ZqeAO2anwDtmqAA7ZqhAO2aogDtmqMA7ZqkAO2apQDtmqYA7ZqnAO2aqADtmqkA7ZqqAO2aqwDtmqwA7ZqtAO2argDtmq8A7ZqwAO2asQDtmrIA7ZqzAO2atADtmrUA7Zq2AO2atwDtmrgA7Zq5AO2augDtmrsA7Zq8AO2avQDtmr4A7Zq/AO2bgADtm4EA7ZuCAO2bgwDtm4QA7ZuFAO2bhgDtm4cA7ZuIAO2biQDtm4oA7ZuLAO2bjADtm40A7ZuOAO2bjwDtm5AA7ZuRAO2bkgDtm5MA7ZuUAO2blQDtm5YA7ZuXAO2bmADtm5kA7ZuaAO2bmwDtm5wA7ZudAO2bngDtm58A7ZugAO2boQDtm6IA7ZujAO2bpADtm6UA7ZumAO2bpwDtm6gA7ZupAO2bqgDtm6sA7ZusAO2brQDtm64A7ZuvAO2bsADtm7EA7ZuyAO2bswDtm7QA7Zu1AO2btgDtm7cA7Zu4AO2buQDtm7oA7Zu7AO2bvADtm70A7Zu+AO2bvwDtnIAA7ZyBAO2cggDtnIMA7ZyEAO2chQDtnIYA7ZyHAO2ciADtnIkA7ZyKAO2ciwDtnIwA7ZyNAO2cjgDtnI8A7ZyQAO2ckQDtnJIA7ZyTAO2clADtnJUA7ZyWAO2clwDtnJgA7ZyZAO2cmgDtnJsA7ZycAO2cnQDtnJ4A7ZyfAO2coADtnKEA7ZyiAO2cowDtnKQA7ZylAO2cpgDtnKcA7ZyoAO2cqQDtnKoA7ZyrAO2crADtnK0A7ZyuAO2crwDtnLAA7ZyxAO2csgDtnLMA7Zy0AO2ctQDtnLYA7Zy3AO2cuADtnLkA7Zy6AO2cuwDtnLwA7Zy9AO2cvgDtnL8A7Z2AAO2dgQDtnYIA7Z2DAO2dhADtnYUA7Z2GAO2dhwDtnYgA7Z2JAO2digDtnYsA7Z2MAO2djQDtnY4A7Z2PAO2dkADtnZEA7Z2SAO2dkwDtnZQA7Z2VAO2dlgDtnZcA7Z2YAO2dmQDtnZoA7Z2bAO2dnADtnZ0A7Z2eAO2dnwDtnaAA7Z2hAO2dogDtnaMA7Z2kAO2dpQDtnaYA7Z2nAO2dqADtnakA7Z2qAO2dqwDtnawA7Z2tAO2drgDtna8A7Z2wAO2dsQDtnbIA7Z2zAO2dtADtnbUA7Z22AO2dtwDtnbgA7Z25AO2dugDtnbsA7Z28AO2dvQDtnb4A7Z2/AO2egADtnoEA7Z6CAO2egwDtnoQA7Z6FAO2ehgDtnocA7Z6IAO2eiQDtnooA7Z6LAO2ejADtno0A7Z6OAO2ejwDtnpAA7Z6RAO2ekgDtnpMA7Z6UAO2elQDtnpYA7Z6XAO2emADtnpkA7Z6aAO2emwDtnpwA7Z6dAO2engDtnp8A7Z6gAO2eoQDtnqIA7Z6jAPCRgpoA8JGCnADwkYKrAPCRhK4A8JGErwDwkY2LAPCRjYwA8JGSuwDwkZK8APCRkr4A8JGWugDwkZa7APCdhZfwnYWlAPCdhZjwnYWlAPCdhZjwnYWl8J2FrgDwnYWY8J2FpfCdha8A8J2FmPCdhaXwnYWwAPCdhZjwnYWl8J2FsQDwnYWY8J2FpfCdhbIA8J2GufCdhaUA8J2GufCdhaXwnYWuAPCdhrnwnYWl8J2FrwDwnYa68J2FpQDwnYa68J2FpfCdha4A8J2GuvCdhaXwnYWvAPCghKIA8KCUnADwoJSlAPCglYsA8KCYugDwoKCEAPCgo54A8KCorADwoK2jAPChk6QA8KGaqADwoZuqAPChp4gA8KGsmADwobSLAPCht6QA8KG3pgDwooaDAPCihp8A8KKMsQDwopuUAPCioYQA8KKhigDwoqyMAPCir7EA8KOAigDwo4q4APCjjZ8A8KOOkwDwo46cAPCjj4MA8KOPlQDwo5GtAPCjmqMA8KOipwDwo6qNAPCjq7oA8KOyvADwo7SeAPCju5EA8KO9ngDwo76OAPCkiaMA8KSLrgDwpI6rAPCkmIgA8KSctQDwpKCUAPCksLYA8KSykgDwpL6hAPCkvrgA8KWBhADwpYOyAPClg7MA8KWEmQDwpYSzAPCliYkA8KWQnQDwpZimAPClmpoA8KWbhQDwpaW8APClqqcA8KWuqwDwpbKAAPCls5AA8KW+hgDwpoeaAPCmiKgA8KaJhwDwpouZAPCmjL4A8KaTmgDwppSjAPCmlqgA8KaepwDwpp61APCmrLwA8KawtgDwprOVAPCmtasA8Ka8rADwpr6xAPCng5IA8KePigDwp5mnAPCnoq4A8KelpgDwp7KoAPCnu5MA8Ke8rwDwqJeSAPCol60A8KicrgDwqK+6APCotbcA8KmFhQDwqYefAPCpiJoA8KmQigDwqZKWAPCplrYA8KmssADwqoOOAPCqhIUA8KqIjgDwqoqRAPCqjpIA8KqYgAA=c   t   i   o   n   a   l   .   i   n   t   e   r   p   o   l   a   t   e   (   
                                                   p   a   t   c   h   _   p   o   s   _   e   m   b   e   d   ,   
                                                   s   i   z   e   =   (   n   e   w   _   h   e   i   g   h   t   ,       n   e   w   _   w   i   d   t   h   )   ,   
                                                   m   o   d   e   =   "   b   i   c   u   b   i   c   "   ,   
                                                   a   l   i   g   n   _   c   o   r   n   e   r   s   =   F   a   l   s   e   ,   
                                   )   
   
                                   p   a   t   c   h   _   p   o   s   _   e   m   b   e   d       =       p   a   t   c   h   _   p   o   s   _   e   m   b   e   d   .   p   e   r   m   u   t   e   (   0   ,       2   ,       3   ,       1   )   .   v   i   e   w   (   1   ,       -   1   ,       d   i   m   )   
   
                                   r   e   t   u   r   n       t   o   r   c   h   .   c   a   t   (   (   c   l   a   s   s   _   p   o   s   _   e   m   b   e   d   ,       p   a   t   c   h   _   p   o   s   _   e   m   b   e   d   )   ,       d   i   m   =   1   )   
   
                   d   e   f       f   o   r   w   a   r   d   (   s   e   l   f   ,       p   i   x   e   l   _   v   a   l   u   e   s   :       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   F   a   l   s   e   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                                   b   a   t   c   h   _   s   i   z   e   ,       _   ,       h   e   i   g   h   t   ,       w   i   d   t   h       =       p   i   x   e   l   _   v   a   l   u   e   s   .   s   h   a   p   e   
                                   i   f       n   o   t       i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g       a   n   d       (   h   e   i   g   h   t       !   =       s   e   l   f   .   i   m   a   g   e   _   s   i   z   e       o   r       w   i   d   t   h       !   =       s   e   l   f   .   i   m   a   g   e   _   s   i   z   e   )   :   
                                                   r   a   i   s   e       V   a   l   u   e   E   r   r   o   r   (   
                                                                   f   "   I   n   p   u   t       i   m   a   g   e       s   i   z   e       (   {   h   e   i   g   h   t   }   *   {   w   i   d   t   h   }   )       d   o   e   s   n   '   t       m   a   t   c   h       m   o   d   e   l       (   {   s   e   l   f   .   i   m   a   g   e   _   s   i   z   e   }   *   {   s   e   l   f   .   i   m   a   g   e   _   s   i   z   e   }   )   .   "   
                                                   )   
                                   t   a   r   g   e   t   _   d   t   y   p   e       =       s   e   l   f   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   .   d   t   y   p   e   
                                   p   a   t   c   h   _   e   m   b   e   d   s       =       s   e   l   f   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   (   p   i   x   e   l   _   v   a   l   u   e   s   .   t   o   (   d   t   y   p   e   =   t   a   r   g   e   t   _   d   t   y   p   e   )   )           #       s   h   a   p   e       =       [   *   ,       w   i   d   t   h   ,       g   r   i   d   ,       g   r   i   d   ]   
                                   p   a   t   c   h   _   e   m   b   e   d   s       =       p   a   t   c   h   _   e   m   b   e   d   s   .   f   l   a   t   t   e   n   (   2   )   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   
   
                                   c   l   a   s   s   _   e   m   b   e   d   s       =       s   e   l   f   .   c   l   a   s   s   _   e   m   b   e   d   d   i   n   g   .   e   x   p   a   n   d   (   b   a   t   c   h   _   s   i   z   e   ,       1   ,       -   1   )   
                                   e   m   b   e   d   d   i   n   g   s       =       t   o   r   c   h   .   c   a   t   (   [   c   l   a   s   s   _   e   m   b   e   d   s   ,       p   a   t   c   h   _   e   m   b   e   d   s   ]   ,       d   i   m   =   1   )   
                                   i   f       i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :   
                                                   e   m   b   e   d   d   i   n   g   s       =       e   m   b   e   d   d   i   n   g   s       +       s   e   l   f   .   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   (   e   m   b   e   d   d   i   n   g   s   ,       h   e   i   g   h   t   ,       w   i   d   t   h   )   
                                   e   l   s   e   :   
                                                   e   m   b   e   d   d   i   n   g   s       =       e   m   b   e   d   d   i   n   g   s       +       s   e   l   f   .   p   o   s   i   t   i   o   n   _   e   m   b   e   d   d   i   n   g   (   s   e   l   f   .   p   o   s   i   t   i   o   n   _   i   d   s   )   
                                   r   e   t   u   r   n       e   m   b   e   d   d   i   n   g   s   
   
   
   d   e   f       e   a   g   e   r   _   a   t   t   e   n   t   i   o   n   _   f   o   r   w   a   r   d   (   
                   m   o   d   u   l   e   :       n   n   .   M   o   d   u   l   e   ,   
                   q   u   e   r   y   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                   k   e   y   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                   v   a   l   u   e   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]   ,   
                   s   c   a   l   i   n   g   :       f   l   o   a   t   ,   
                   d   r   o   p   o   u   t   :       f   l   o   a   t       =       0   .   0   ,   
                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       b   o   o   l       =       T   r   u   e   ,   
                   *   *   k   w   a   r   g   s   ,   
   )   :   
                   a   t   t   n   _   w   e   i   g   h   t   s       =       t   o   r   c   h   .   m   a   t   m   u   l   (   q   u   e   r   y   ,       k   e   y   .   t   r   a   n   s   p   o   s   e   (   -   1   ,       -   2   )   )       *       s   c   a   l   i   n   g   
                   i   f       a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e   :   
                                   a   t   t   n   _   w   e   i   g   h   t   s       =       a   t   t   n   _   w   e   i   g   h   t   s       +       a   t   t   e   n   t   i   o   n   _   m   a   s   k   
                   a   t   t   n   _   w   e   i   g   h   t   s       =       n   n   .   f   u   n   c   t   i   o   n   a   l   .   s   o   f   t   m   a   x   (   a   t   t   n   _   w   e   i   g   h   t   s   ,       d   i   m   =   -   1   ,       d   t   y   p   e   =   t   o   r   c   h   .   f   l   o   a   t   3   2   )   .   t   o   (   q   u   e   r   y   .   d   t   y   p   e   )   
                   a   t   t   n   _   w   e   i   g   h   t   s       =       n   n   .   f   u   n   c   t   i   o   n   a   l   .   d   r   o   p   o   u   t   (   a   t   t   n   _   w   e   i   g   h   t   s   ,       p   =   d   r   o   p   o   u   t   ,       t   r   a   i   n   i   n   g   =   m   o   d   u   l   e   .   t   r   a   i   n   i   n   g   )   
   
                   a   t   t   n   _   o   u   t   p   u   t       =       t   o   r   c   h   .   m   a   t   m   u   l   (   a   t   t   n   _   w   e   i   g   h   t   s   ,       v   a   l   u   e   )   
                   a   t   t   n   _   o   u   t   p   u   t       =       a   t   t   n   _   o   u   t   p   u   t   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   .   c   o   n   t   i   g   u   o   u   s   (   )   
                   i   f       n   o   t       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :   
                                   a   t   t   n   _   w   e   i   g   h   t   s       =       N   o   n   e   
                   r   e   t   u   r   n       a   t   t   n   _   o   u   t   p   u   t   ,       a   t   t   n   _   w   e   i   g   h   t   s   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   A   t   t   e   n   t   i   o   n   (   n   n   .   M   o   d   u   l   e   )   :   
                   "   "   "   M   u   l   t   i   -   h   e   a   d   e   d       a   t   t   e   n   t   i   o   n       f   r   o   m       '   A   t   t   e   n   t   i   o   n       I   s       A   l   l       Y   o   u       N   e   e   d   '       p   a   p   e   r   "   "   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       U   n   i   o   n   [   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   ]   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   s   e   l   f   .   e   m   b   e   d   _   d   i   m       =       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
                                   s   e   l   f   .   n   u   m   _   h   e   a   d   s       =       c   o   n   f   i   g   .   n   u   m   _   a   t   t   e   n   t   i   o   n   _   h   e   a   d   s   
                                   s   e   l   f   .   h   e   a   d   _   d   i   m       =       s   e   l   f   .   e   m   b   e   d   _   d   i   m       /   /       s   e   l   f   .   n   u   m   _   h   e   a   d   s   
                                   i   f       s   e   l   f   .   h   e   a   d   _   d   i   m       *       s   e   l   f   .   n   u   m   _   h   e   a   d   s       !   =       s   e   l   f   .   e   m   b   e   d   _   d   i   m   :   
                                                   r   a   i   s   e       V   a   l   u   e   E   r   r   o   r   (   
                                                                   f   "   e   m   b   e   d   _   d   i   m       m   u   s   t       b   e       d   i   v   i   s   i   b   l   e       b   y       n   u   m   _   h   e   a   d   s       (   g   o   t       `   e   m   b   e   d   _   d   i   m   `   :       {   s   e   l   f   .   e   m   b   e   d   _   d   i   m   }       a   n   d       `   n   u   m   _   h   e   a   d   s   `   :   "   
                                                                   f   "       {   s   e   l   f   .   n   u   m   _   h   e   a   d   s   }   )   .   "   
                                                   )   
                                   s   e   l   f   .   s   c   a   l   e       =       s   e   l   f   .   h   e   a   d   _   d   i   m   *   *   -   0   .   5   
                                   s   e   l   f   .   d   r   o   p   o   u   t       =       c   o   n   f   i   g   .   a   t   t   e   n   t   i   o   n   _   d   r   o   p   o   u   t   
                                   s   e   l   f   .   i   s   _   c   a   u   s   a   l       =       F   a   l   s   e   
   
                                   s   e   l   f   .   k   _   p   r   o   j       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   e   m   b   e   d   _   d   i   m   )   
                                   s   e   l   f   .   v   _   p   r   o   j       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   e   m   b   e   d   _   d   i   m   )   
                                   s   e   l   f   .   q   _   p   r   o   j       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   e   m   b   e   d   _   d   i   m   )   
                                   s   e   l   f   .   o   u   t   _   p   r   o   j       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   e   m   b   e   d   _   d   i   m   )   
   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       F   a   l   s   e   ,   
                   )       -   >       t   u   p   l   e   [   t   o   r   c   h   .   T   e   n   s   o   r   ,       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]   ]   :   
                                   "   "   "   I   n   p   u   t       s   h   a   p   e   :       B   a   t   c   h       x       T   i   m   e       x       C   h   a   n   n   e   l   "   "   "   
   
                                   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   g   t   h   ,       e   m   b   e   d   _   d   i   m       =       h   i   d   d   e   n   _   s   t   a   t   e   s   .   s   h   a   p   e   
   
                                   q   u   e   r   i   e   s       =       s   e   l   f   .   q   _   p   r   o   j   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   k   e   y   s       =       s   e   l   f   .   k   _   p   r   o   j   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   v   a   l   u   e   s       =       s   e   l   f   .   v   _   p   r   o   j   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
   
                                   q   u   e   r   i   e   s       =       q   u   e   r   i   e   s   .   v   i   e   w   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   g   t   h   ,       -   1   ,       s   e   l   f   .   h   e   a   d   _   d   i   m   )   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   
                                   k   e   y   s       =       k   e   y   s   .   v   i   e   w   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   g   t   h   ,       -   1   ,       s   e   l   f   .   h   e   a   d   _   d   i   m   )   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   
                                   v   a   l   u   e   s       =       v   a   l   u   e   s   .   v   i   e   w   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   g   t   h   ,       -   1   ,       s   e   l   f   .   h   e   a   d   _   d   i   m   )   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   
                                   #       M   E   T   A   C   L   I   P   _   2       t   e   x   t       m   o   d   e   l       u   s   e   s       b   o   t   h       `   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   `       a   n   d       `   a   t   t   e   n   t   i   o   n   _   m   a   s   k   `   
                                   #       i   n       c   a   s   e       F   A   2       k   e   r   n   e   l       i   s       c   a   l   l   e   d   ,       `   i   s   _   c   a   u   s   a   l   `       s   h   o   u   l   d       b   e       i   n   f   e   r   r   e   d       f   r   o   m       `   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   `   
                                   i   f       s   e   l   f   .   c   o   n   f   i   g   .   _   a   t   t   n   _   i   m   p   l   e   m   e   n   t   a   t   i   o   n       =   =       "   f   l   a   s   h   _   a   t   t   e   n   t   i   o   n   _   2   "   :   
                                                   s   e   l   f   .   i   s   _   c   a   u   s   a   l       =       c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e   
                                   e   l   s   e   :   
                                                   i   f       a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e       a   n   d       c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e   :   
                                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       a   t   t   e   n   t   i   o   n   _   m   a   s   k       +       c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   
                                                   e   l   i   f       c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e   :   
                                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   
   
                                   a   t   t   e   n   t   i   o   n   _   i   n   t   e   r   f   a   c   e   :       C   a   l   l   a   b   l   e       =       e   a   g   e   r   _   a   t   t   e   n   t   i   o   n   _   f   o   r   w   a   r   d   
                                   i   f       s   e   l   f   .   c   o   n   f   i   g   .   _   a   t   t   n   _   i   m   p   l   e   m   e   n   t   a   t   i   o   n       !   =       "   e   a   g   e   r   "   :   
                                                   a   t   t   e   n   t   i   o   n   _   i   n   t   e   r   f   a   c   e       =       A   L   L   _   A   T   T   E   N   T   I   O   N   _   F   U   N   C   T   I   O   N   S   [   s   e   l   f   .   c   o   n   f   i   g   .   _   a   t   t   n   _   i   m   p   l   e   m   e   n   t   a   t   i   o   n   ]   
   
                                   a   t   t   n   _   o   u   t   p   u   t   ,       a   t   t   n   _   w   e   i   g   h   t   s       =       a   t   t   e   n   t   i   o   n   _   i   n   t   e   r   f   a   c   e   (   
                                                   s   e   l   f   ,   
                                                   q   u   e   r   i   e   s   ,   
                                                   k   e   y   s   ,   
                                                   v   a   l   u   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   i   s   _   c   a   u   s   a   l   =   s   e   l   f   .   i   s   _   c   a   u   s   a   l   ,   
                                                   s   c   a   l   i   n   g   =   s   e   l   f   .   s   c   a   l   e   ,   
                                                   d   r   o   p   o   u   t   =   0   .   0       i   f       n   o   t       s   e   l   f   .   t   r   a   i   n   i   n   g       e   l   s   e       s   e   l   f   .   d   r   o   p   o   u   t   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
                                   a   t   t   n   _   o   u   t   p   u   t       =       a   t   t   n   _   o   u   t   p   u   t   .   r   e   s   h   a   p   e   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   g   t   h   ,       e   m   b   e   d   _   d   i   m   )   .   c   o   n   t   i   g   u   o   u   s   (   )   
                                   a   t   t   n   _   o   u   t   p   u   t       =       s   e   l   f   .   o   u   t   _   p   r   o   j   (   a   t   t   n   _   o   u   t   p   u   t   )   
   
                                   i   f       n   o   t       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :   
                                                   a   t   t   n   _   w   e   i   g   h   t   s       =       N   o   n   e   
                                   r   e   t   u   r   n       a   t   t   n   _   o   u   t   p   u   t   ,       a   t   t   n   _   w   e   i   g   h   t   s   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   M   L   P   (   n   n   .   M   o   d   u   l   e   )   :   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   s   e   l   f   .   a   c   t   i   v   a   t   i   o   n   _   f   n       =       A   C   T   2   F   N   [   c   o   n   f   i   g   .   h   i   d   d   e   n   _   a   c   t   ]   
                                   s   e   l   f   .   f   c   1       =       n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   i   n   t   e   r   m   e   d   i   a   t   e   _   s   i   z   e   )   
                                   s   e   l   f   .   f   c   2       =       n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   i   n   t   e   r   m   e   d   i   a   t   e   _   s   i   z   e   ,       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   )   
   
                   d   e   f       f   o   r   w   a   r   d   (   s   e   l   f   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   :       t   o   r   c   h   .   T   e   n   s   o   r   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   f   c   1   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   a   c   t   i   v   a   t   i   o   n   _   f   n   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   f   c   2   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   r   e   t   u   r   n       h   i   d   d   e   n   _   s   t   a   t   e   s   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   (   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   
                   b   a   s   e   _   m   o   d   e   l   _   p   r   e   f   i   x       =       "   m   e   t   a   c   l   i   p   _   2   "   
                   s   u   p   p   o   r   t   s   _   g   r   a   d   i   e   n   t   _   c   h   e   c   k   p   o   i   n   t   i   n   g       =       T   r   u   e   
                   _   s   u   p   p   o   r   t   s   _   s   d   p   a       =       T   r   u   e   
                   _   s   u   p   p   o   r   t   s   _   f   l   a   s   h   _   a   t   t   n       =       T   r   u   e   
                   _   s   u   p   p   o   r   t   s   _   f   l   e   x   _   a   t   t   n       =       T   r   u   e   
                   _   s   u   p   p   o   r   t   s   _   a   t   t   e   n   t   i   o   n   _   b   a   c   k   e   n   d       =       T   r   u   e   
   
                   d   e   f       _   i   n   i   t   _   w   e   i   g   h   t   s   (   s   e   l   f   ,       m   o   d   u   l   e   )   :   
                                   "   "   "   I   n   i   t   i   a   l   i   z   e       t   h   e       w   e   i   g   h   t   s   "   "   "   
                                   f   a   c   t   o   r       =       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   
                                   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   E   m   b   e   d   d   i   n   g   s   )   :   
                                                   m   o   d   u   l   e   .   t   o   k   e   n   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   .   d   a   t   a   .   n   o   r   m   a   l   _   (   m   e   a   n   =   0   .   0   ,       s   t   d   =   f   a   c   t   o   r       *       0   .   0   2   )   
                                                   m   o   d   u   l   e   .   p   o   s   i   t   i   o   n   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   .   d   a   t   a   .   n   o   r   m   a   l   _   (   m   e   a   n   =   0   .   0   ,       s   t   d   =   f   a   c   t   o   r       *       0   .   0   2   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   E   m   b   e   d   d   i   n   g   s   )   :   
                                                   f   a   c   t   o   r       =       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   c   l   a   s   s   _   e   m   b   e   d   d   i   n   g   ,       m   e   a   n   =   0   .   0   ,       s   t   d   =   m   o   d   u   l   e   .   e   m   b   e   d   _   d   i   m   *   *   -   0   .   5       *       f   a   c   t   o   r   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   ,       s   t   d   =   m   o   d   u   l   e   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   r   a   n   g   e       *       f   a   c   t   o   r   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   p   o   s   i   t   i   o   n   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   ,       s   t   d   =   m   o   d   u   l   e   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   r   a   n   g   e       *       f   a   c   t   o   r   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   A   t   t   e   n   t   i   o   n   )   :   
                                                   f   a   c   t   o   r       =       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   
                                                   i   n   _   p   r   o   j   _   s   t   d       =       (   m   o   d   u   l   e   .   e   m   b   e   d   _   d   i   m   *   *   -   0   .   5   )       *       (   (   2       *       m   o   d   u   l   e   .   c   o   n   f   i   g   .   n   u   m   _   h   i   d   d   e   n   _   l   a   y   e   r   s   )       *   *       -   0   .   5   )       *       f   a   c   t   o   r   
                                                   o   u   t   _   p   r   o   j   _   s   t   d       =       (   m   o   d   u   l   e   .   e   m   b   e   d   _   d   i   m   *   *   -   0   .   5   )       *       f   a   c   t   o   r   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   q   _   p   r   o   j   .   w   e   i   g   h   t   ,       s   t   d   =   i   n   _   p   r   o   j   _   s   t   d   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   k   _   p   r   o   j   .   w   e   i   g   h   t   ,       s   t   d   =   i   n   _   p   r   o   j   _   s   t   d   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   v   _   p   r   o   j   .   w   e   i   g   h   t   ,       s   t   d   =   i   n   _   p   r   o   j   _   s   t   d   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   o   u   t   _   p   r   o   j   .   w   e   i   g   h   t   ,       s   t   d   =   o   u   t   _   p   r   o   j   _   s   t   d   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   M   L   P   )   :   
                                                   f   a   c   t   o   r       =       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   
                                                   i   n   _   p   r   o   j   _   s   t   d       =       (   m   o   d   u   l   e   .   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   *   *   -   0   .   5   )       *       (   (   2       *       m   o   d   u   l   e   .   c   o   n   f   i   g   .   n   u   m   _   h   i   d   d   e   n   _   l   a   y   e   r   s   )       *   *       -   0   .   5   )       *       f   a   c   t   o   r   
                                                   f   c   _   s   t   d       =       (   2       *       m   o   d   u   l   e   .   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   )       *   *       -   0   .   5       *       f   a   c   t   o   r   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   f   c   1   .   w   e   i   g   h   t   ,       s   t   d   =   f   c   _   s   t   d   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   m   o   d   u   l   e   .   f   c   2   .   w   e   i   g   h   t   ,       s   t   d   =   i   n   _   p   r   o   j   _   s   t   d   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   M   o   d   e   l   )   :   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   
                                                                   m   o   d   u   l   e   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n   .   w   e   i   g   h   t   ,   
                                                                   s   t   d   =   m   o   d   u   l   e   .   t   e   x   t   _   e   m   b   e   d   _   d   i   m   *   *   -   0   .   5       *       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   ,   
                                                   )   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   
                                                                   m   o   d   u   l   e   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n   .   w   e   i   g   h   t   ,   
                                                                   s   t   d   =   m   o   d   u   l   e   .   v   i   s   i   o   n   _   e   m   b   e   d   _   d   i   m   *   *   -   0   .   5       *       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   ,   
                                                   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   )   :   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   
                                                                   m   o   d   u   l   e   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n   .   w   e   i   g   h   t   ,   
                                                                   s   t   d   =   s   e   l   f   .   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   *   *   -   0   .   5       *       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   ,   
                                                   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   )   :   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   
                                                                   m   o   d   u   l   e   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n   .   w   e   i   g   h   t   ,   
                                                                   s   t   d   =   s   e   l   f   .   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   *   *   -   0   .   5       *       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   ,   
                                                   )   
                                   e   l   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       M   e   t   a   C   l   i   p   2   F   o   r   I   m   a   g   e   C   l   a   s   s   i   f   i   c   a   t   i   o   n   )   :   
                                                   n   n   .   i   n   i   t   .   n   o   r   m   a   l   _   (   
                                                                   m   o   d   u   l   e   .   c   l   a   s   s   i   f   i   e   r   .   w   e   i   g   h   t   ,   
                                                                   s   t   d   =   s   e   l   f   .   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   *   *   -   0   .   5       *       s   e   l   f   .   c   o   n   f   i   g   .   i   n   i   t   i   a   l   i   z   e   r   _   f   a   c   t   o   r   ,   
                                                   )   
   
                                   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       n   n   .   L   a   y   e   r   N   o   r   m   )   :   
                                                   m   o   d   u   l   e   .   b   i   a   s   .   d   a   t   a   .   z   e   r   o   _   (   )   
                                                   m   o   d   u   l   e   .   w   e   i   g   h   t   .   d   a   t   a   .   f   i   l   l   _   (   1   .   0   )   
                                   i   f       i   s   i   n   s   t   a   n   c   e   (   m   o   d   u   l   e   ,       n   n   .   L   i   n   e   a   r   )       a   n   d       m   o   d   u   l   e   .   b   i   a   s       i   s       n   o   t       N   o   n   e   :   
                                                   m   o   d   u   l   e   .   b   i   a   s   .   d   a   t   a   .   z   e   r   o   _   (   )   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   (   G   r   a   d   i   e   n   t   C   h   e   c   k   p   o   i   n   t   i   n   g   L   a   y   e   r   )   :   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       U   n   i   o   n   [   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   ]   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   e   m   b   e   d   _   d   i   m       =       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
                                   s   e   l   f   .   s   e   l   f   _   a   t   t   n       =       M   e   t   a   C   l   i   p   2   A   t   t   e   n   t   i   o   n   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   l   a   y   e   r   _   n   o   r   m   1       =       n   n   .   L   a   y   e   r   N   o   r   m   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
                                   s   e   l   f   .   m   l   p       =       M   e   t   a   C   l   i   p   2   M   L   P   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   l   a   y   e   r   _   n   o   r   m   2       =       n   n   .   L   a   y   e   r   N   o   r   m   (   s   e   l   f   .   e   m   b   e   d   _   d   i   m   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       F   a   l   s   e   ,   
                   )       -   >       t   u   p   l   e   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]   :   
                                   "   "   "   
                                   A   r   g   s   :   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `   )   :       i   n   p   u   t       t   o       t   h   e       l   a   y   e   r       o   f       s   h   a   p   e       `   (   b   a   t   c   h   ,       s   e   q   _   l   e   n   ,       e   m   b   e   d   _   d   i   m   )   `   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `   )   :       a   t   t   e   n   t   i   o   n       m   a   s   k       o   f       s   i   z   e   
                                                                   `   (   b   a   t   c   h   ,       1   ,       t   g   t   _   l   e   n   ,       s   r   c   _   l   e   n   )   `       w   h   e   r   e       p   a   d   d   i   n   g       e   l   e   m   e   n   t   s       a   r   e       i   n   d   i   c   a   t   e   d       b   y       v   e   r   y       l   a   r   g   e       n   e   g   a   t   i   v   e       v   a   l   u   e   s   .   
                                                                   `   (   c   o   n   f   i   g   .   e   n   c   o   d   e   r   _   a   t   t   e   n   t   i   o   n   _   h   e   a   d   s   ,   )   `   .   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       (   `   b   o   o   l   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   W   h   e   t   h   e   r       o   r       n   o   t       t   o       r   e   t   u   r   n       t   h   e       a   t   t   e   n   t   i   o   n   s       t   e   n   s   o   r   s       o   f       a   l   l       a   t   t   e   n   t   i   o   n       l   a   y   e   r   s   .       S   e   e       `   a   t   t   e   n   t   i   o   n   s   `       u   n   d   e   r   
                                                                   r   e   t   u   r   n   e   d       t   e   n   s   o   r   s       f   o   r       m   o   r   e       d   e   t   a   i   l   .   
                                   "   "   "   
                                   r   e   s   i   d   u   a   l       =       h   i   d   d   e   n   _   s   t   a   t   e   s   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   l   a   y   e   r   _   n   o   r   m   1   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       a   t   t   n   _   w   e   i   g   h   t   s       =       s   e   l   f   .   s   e   l   f   _   a   t   t   n   (   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       r   e   s   i   d   u   a   l       +       h   i   d   d   e   n   _   s   t   a   t   e   s   
   
                                   r   e   s   i   d   u   a   l       =       h   i   d   d   e   n   _   s   t   a   t   e   s   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   l   a   y   e   r   _   n   o   r   m   2   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   m   l   p   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       r   e   s   i   d   u   a   l       +       h   i   d   d   e   n   _   s   t   a   t   e   s   
   
                                   o   u   t   p   u   t   s       =       (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   )   
   
                                   i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :   
                                                   o   u   t   p   u   t   s       +   =       (   a   t   t   n   _   w   e   i   g   h   t   s   ,   )   
   
                                   r   e   t   u   r   n       o   u   t   p   u   t   s   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   (   n   n   .   M   o   d   u   l   e   )   :   
                   "   "   "   
                   T   r   a   n   s   f   o   r   m   e   r       e   n   c   o   d   e   r       c   o   n   s   i   s   t   i   n   g       o   f       `   c   o   n   f   i   g   .   n   u   m   _   h   i   d   d   e   n   _   l   a   y   e   r   s   `       s   e   l   f       a   t   t   e   n   t   i   o   n       l   a   y   e   r   s   .       E   a   c   h       l   a   y   e   r       i   s       a   
                   [   `   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   `   ]   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   
                   "   "   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   s   e   l   f   .   l   a   y   e   r   s       =       n   n   .   M   o   d   u   l   e   L   i   s   t   (   [   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   (   c   o   n   f   i   g   )       f   o   r       _       i   n       r   a   n   g   e   (   c   o   n   f   i   g   .   n   u   m   _   h   i   d   d   e   n   _   l   a   y   e   r   s   )   ]   )   
                                   s   e   l   f   .   g   r   a   d   i   e   n   t   _   c   h   e   c   k   p   o   i   n   t   i   n   g       =       F   a   l   s   e   
   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   s   _   e   m   b   e   d   s   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   :   
                                   r   "   "   "   
                                   A   r   g   s   :   
                                                   i   n   p   u   t   s   _   e   m   b   e   d   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   u   e   n   c   e   _   l   e   n   g   t   h   ,       h   i   d   d   e   n   _   s   i   z   e   )   `   )   :   
                                                                   O   p   t   i   o   n   a   l   l   y   ,       i   n   s   t   e   a   d       o   f       p   a   s   s   i   n   g       `   i   n   p   u   t   _   i   d   s   `       y   o   u       c   a   n       c   h   o   o   s   e       t   o       d   i   r   e   c   t   l   y       p   a   s   s       a   n       e   m   b   e   d   d   e   d       r   e   p   r   e   s   e   n   t   a   t   i   o   n   .   
                                                                   T   h   i   s       i   s       u   s   e   f   u   l       i   f       y   o   u       w   a   n   t       m   o   r   e       c   o   n   t   r   o   l       o   v   e   r       h   o   w       t   o       c   o   n   v   e   r   t       `   i   n   p   u   t   _   i   d   s   `       i   n   d   i   c   e   s       i   n   t   o       a   s   s   o   c   i   a   t   e   d       v   e   c   t   o   r   s   
                                                                   t   h   a   n       t   h   e       m   o   d   e   l   '   s       i   n   t   e   r   n   a   l       e   m   b   e   d   d   i   n   g       l   o   o   k   u   p       m   a   t   r   i   x   .   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       (   `   t   o   r   c   h   .   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   u   e   n   c   e   _   l   e   n   g   t   h   )   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   M   a   s   k       t   o       a   v   o   i   d       p   e   r   f   o   r   m   i   n   g       a   t   t   e   n   t   i   o   n       o   n       p   a   d   d   i   n   g       t   o   k   e   n       i   n   d   i   c   e   s   .       M   a   s   k       v   a   l   u   e   s       s   e   l   e   c   t   e   d       i   n       `   [   0   ,       1   ]   `   :   
   
                                                                   -       1       f   o   r       t   o   k   e   n   s       t   h   a   t       a   r   e       *   *   n   o   t       m   a   s   k   e   d   *   *   ,   
                                                                   -       0       f   o   r       t   o   k   e   n   s       t   h   a   t       a   r   e       *   *   m   a   s   k   e   d   *   *   .   
   
                                                                   [   W   h   a   t       a   r   e       a   t   t   e   n   t   i   o   n       m   a   s   k   s   ?   ]   (   .   .   /   g   l   o   s   s   a   r   y   #   a   t   t   e   n   t   i   o   n   -   m   a   s   k   )   
                                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       (   `   t   o   r   c   h   .   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   u   e   n   c   e   _   l   e   n   g   t   h   )   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   C   a   u   s   a   l       m   a   s   k       f   o   r       t   h   e       t   e   x   t       m   o   d   e   l   .       M   a   s   k       v   a   l   u   e   s       s   e   l   e   c   t   e   d       i   n       `   [   0   ,       1   ]   `   :   
   
                                                                   -       1       f   o   r       t   o   k   e   n   s       t   h   a   t       a   r   e       *   *   n   o   t       m   a   s   k   e   d   *   *   ,   
                                                                   -       0       f   o   r       t   o   k   e   n   s       t   h   a   t       a   r   e       *   *   m   a   s   k   e   d   *   *   .   
   
                                                                   [   W   h   a   t       a   r   e       a   t   t   e   n   t   i   o   n       m   a   s   k   s   ?   ]   (   .   .   /   g   l   o   s   s   a   r   y   #   a   t   t   e   n   t   i   o   n   -   m   a   s   k   )   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       (   `   b   o   o   l   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   W   h   e   t   h   e   r       o   r       n   o   t       t   o       r   e   t   u   r   n       t   h   e       a   t   t   e   n   t   i   o   n   s       t   e   n   s   o   r   s       o   f       a   l   l       a   t   t   e   n   t   i   o   n       l   a   y   e   r   s   .       S   e   e       `   a   t   t   e   n   t   i   o   n   s   `       u   n   d   e   r   
                                                                   r   e   t   u   r   n   e   d       t   e   n   s   o   r   s       f   o   r       m   o   r   e       d   e   t   a   i   l   .   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       (   `   b   o   o   l   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   W   h   e   t   h   e   r       o   r       n   o   t       t   o       r   e   t   u   r   n       t   h   e       h   i   d   d   e   n       s   t   a   t   e   s       o   f       a   l   l       l   a   y   e   r   s   .       S   e   e       `   h   i   d   d   e   n   _   s   t   a   t   e   s   `       u   n   d   e   r       r   e   t   u   r   n   e   d       t   e   n   s   o   r   s   
                                                                   f   o   r       m   o   r   e       d   e   t   a   i   l   .   
                                                   r   e   t   u   r   n   _   d   i   c   t       (   `   b   o   o   l   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                                   W   h   e   t   h   e   r       o   r       n   o   t       t   o       r   e   t   u   r   n       a       [   `   ~   u   t   i   l   s   .   M   o   d   e   l   O   u   t   p   u   t   `   ]       i   n   s   t   e   a   d       o   f       a       p   l   a   i   n       t   u   p   l   e   .   
                                   "   "   "   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       =       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       =       (   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   
                                   )   
   
                                   e   n   c   o   d   e   r   _   s   t   a   t   e   s       =       (   )       i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       e   l   s   e       N   o   n   e   
                                   a   l   l   _   a   t   t   e   n   t   i   o   n   s       =       (   )       i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       e   l   s   e       N   o   n   e   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       i   n   p   u   t   s   _   e   m   b   e   d   s   
                                   f   o   r       i   d   x   ,       e   n   c   o   d   e   r   _   l   a   y   e   r       i   n       e   n   u   m   e   r   a   t   e   (   s   e   l   f   .   l   a   y   e   r   s   )   :   
                                                   i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :   
                                                                   e   n   c   o   d   e   r   _   s   t   a   t   e   s       =       e   n   c   o   d   e   r   _   s   t   a   t   e   s       +       (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   )   
                                                   l   a   y   e   r   _   o   u   t   p   u   t   s       =       e   n   c   o   d   e   r   _   l   a   y   e   r   (   
                                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   )   
   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       l   a   y   e   r   _   o   u   t   p   u   t   s   [   0   ]   
   
                                                   i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :   
                                                                   a   l   l   _   a   t   t   e   n   t   i   o   n   s       =       a   l   l   _   a   t   t   e   n   t   i   o   n   s       +       (   l   a   y   e   r   _   o   u   t   p   u   t   s   [   1   ]   ,   )   
   
                                   i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :   
                                                   e   n   c   o   d   e   r   _   s   t   a   t   e   s       =       e   n   c   o   d   e   r   _   s   t   a   t   e   s       +       (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   )   
   
                                   r   e   t   u   r   n       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   (   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   e   n   c   o   d   e   r   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   a   l   l   _   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   T   e   x   t   T   r   a   n   s   f   o   r   m   e   r   (   n   n   .   M   o   d   u   l   e   )   :   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   e   m   b   e   d   _   d   i   m       =       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
                                   s   e   l   f   .   e   m   b   e   d   d   i   n   g   s       =       M   e   t   a   C   l   i   p   2   T   e   x   t   E   m   b   e   d   d   i   n   g   s   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   e   n   c   o   d   e   r       =       M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   f   i   n   a   l   _   l   a   y   e   r   _   n   o   r   m       =       n   n   .   L   a   y   e   r   N   o   r   m   (   e   m   b   e   d   _   d   i   m   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
   
                                   #       F   o   r       `   p   o   o   l   e   d   _   o   u   t   p   u   t   `       c   o   m   p   u   t   a   t   i   o   n   
                                   s   e   l   f   .   e   o   s   _   t   o   k   e   n   _   i   d       =       c   o   n   f   i   g   .   e   o   s   _   t   o   k   e   n   _   i   d   
   
                   @   c   h   e   c   k   _   m   o   d   e   l   _   i   n   p   u   t   s   (   t   i   e   _   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   F   a   l   s   e   )   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   o   s   i   t   i   o   n   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   u   s   e   _   c   a   c   h   e   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   *   *   k   w   a   r   g   s   :       U   n   p   a   c   k   [   T   r   a   n   s   f   o   r   m   e   r   s   K   w   a   r   g   s   ]   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   :   
                                   i   n   p   u   t   _   s   h   a   p   e       =       i   n   p   u   t   _   i   d   s   .   s   i   z   e   (   )   
                                   i   n   p   u   t   _   i   d   s       =       i   n   p   u   t   _   i   d   s   .   v   i   e   w   (   -   1   ,       i   n   p   u   t   _   s   h   a   p   e   [   -   1   ]   )   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   e   m   b   e   d   d   i   n   g   s   (   i   n   p   u   t   _   i   d   s   =   i   n   p   u   t   _   i   d   s   ,       p   o   s   i   t   i   o   n   _   i   d   s   =   p   o   s   i   t   i   o   n   _   i   d   s   )   
   
                                   #       C   L   I   P   '   s       t   e   x   t       m   o   d   e   l       u   s   e   s       c   a   u   s   a   l       m   a   s   k   ,       p   r   e   p   a   r   e       i   t       h   e   r   e   .   
                                   #       h   t   t   p   s   :   /   /   g   i   t   h   u   b   .   c   o   m   /   o   p   e   n   a   i   /   C   L   I   P   /   b   l   o   b   /   c   f   c   f   f   b   9   0   e   6   9   f   3   7   b   f   2   f   f   1   e   9   8   8   2   3   7   a   0   f   b   e   4   1   f   3   3   c   0   4   /   c   l   i   p   /   m   o   d   e   l   .   p   y   #   L   3   2   4   
                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       _   c   r   e   a   t   e   _   4   d   _   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   (   
                                                   i   n   p   u   t   _   s   h   a   p   e   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   t   y   p   e   ,       d   e   v   i   c   e   =   h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   e   v   i   c   e   
                                   )   
   
                                   #       e   x   p   a   n   d       a   t   t   e   n   t   i   o   n   _   m   a   s   k   
                                   i   f       a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       n   o   t       N   o   n   e       a   n   d       s   e   l   f   .   c   o   n   f   i   g   .   _   a   t   t   n   _   i   m   p   l   e   m   e   n   t   a   t   i   o   n       !   =       "   f   l   a   s   h   _   a   t   t   e   n   t   i   o   n   _   2   "   :   
                                                   #       [   b   a   t   c   h   _   s   i   z   e   ,       s   e   q   _   l   e   n   ]       -   >       [   b   a   t   c   h   _   s   i   z   e   ,       1   ,       t   g   t   _   s   e   q   _   l   e   n   ,       s   r   c   _   s   e   q   _   l   e   n   ]   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       _   p   r   e   p   a   r   e   _   4   d   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   (   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   t   y   p   e   )   
   
                                   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t       =       s   e   l   f   .   e   n   c   o   d   e   r   (   
                                                   i   n   p   u   t   s   _   e   m   b   e   d   s   =   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   c   a   u   s   a   l   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   *   *   k   w   a   r   g   s   ,   
                                   )   
   
                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       s   e   l   f   .   f   i   n   a   l   _   l   a   y   e   r   _   n   o   r   m   (   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   )   
   
                                   #       U   s   e       r   o   b   u   s   t       p   o   o   l   i   n   g       l   i   k   e       C   L   I   P       -       f   i   n   d   s       t   h   e       f   i   r   s   t       E   O   S       t   o   k   e   n       p   o   s   i   t   i   o   n       p   e   r       s   e   q   u   e   n   c   e   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   [   
                                                   t   o   r   c   h   .   a   r   a   n   g   e   (   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   .   s   h   a   p   e   [   0   ]   ,       d   e   v   i   c   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   .   d   e   v   i   c   e   )   ,   
                                                   (   i   n   p   u   t   _   i   d   s   .   t   o   (   d   t   y   p   e   =   t   o   r   c   h   .   i   n   t   ,       d   e   v   i   c   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   .   d   e   v   i   c   e   )       =   =       s   e   l   f   .   e   o   s   _   t   o   k   e   n   _   i   d   )   .   i   n   t   (   )   .   a   r   g   m   a   x   (   d   i   m   =   -   1   )   ,   
                                   ]   
   
                                   r   e   t   u   r   n       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   (   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   p   o   o   l   e   r   _   o   u   t   p   u   t   =   p   o   o   l   e   d   _   o   u   t   p   u   t   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   (   
                   c   u   s   t   o   m   _   i   n   t   r   o   =   "   "   "   
                   T   h   e       t   e   x   t       m   o   d   e   l       f   r   o   m       M   E   T   A   C   L   I   P   _   2       w   i   t   h   o   u   t       a   n   y       h   e   a   d       o   r       p   r   o   j   e   c   t   i   o   n       o   n       t   o   p   .   
                   "   "   "   
   )   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   "   "   "   
                   T   h   e       t   e   x   t       m   o   d   e   l       f   r   o   m       M   e   t   a   C   l   i   p   2       w   i   t   h   o   u   t       a   n   y       h   e   a   d       o   r       p   r   o   j   e   c   t   i   o   n       o   n       t   o   p   .   
                   T   h   i   s       m   o   d   e   l       i   n   h   e   r   i   t   s       f   r   o   m       [   `   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   `   ]   .       C   h   e   c   k       t   h   e       s   u   p   e   r   c   l   a   s   s       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       t   h   e       g   e   n   e   r   i   c       m   e   t   h   o   d   s       t   h   e   
                   l   i   b   r   a   r   y       i   m   p   l   e   m   e   n   t   s       f   o   r       a   l   l       i   t   s       m   o   d   e   l       (   s   u   c   h       a   s       d   o   w   n   l   o   a   d   i   n   g       o   r       s   a   v   i   n   g   ,       r   e   s   i   z   i   n   g       t   h   e       i   n   p   u   t       e   m   b   e   d   d   i   n   g   s   ,       p   r   u   n   i   n   g       h   e   a   d   s   
                   e   t   c   .   )   
   
                   T   h   i   s       m   o   d   e   l       i   s       a   l   s   o       a       P   y   T   o   r   c   h       [   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   ]   (   h   t   t   p   s   :   /   /   p   y   t   o   r   c   h   .   o   r   g   /   d   o   c   s   /   s   t   a   b   l   e   /   n   n   .   h   t   m   l   #   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   )       s   u   b   c   l   a   s   s   .   
                   U   s   e       i   t       a   s       a       r   e   g   u   l   a   r       P   y   T   o   r   c   h       M   o   d   u   l   e       a   n   d       r   e   f   e   r       t   o       t   h   e       P   y   T   o   r   c   h       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       a   l   l       m   a   t   t   e   r       r   e   l   a   t   e   d       t   o       g   e   n   e   r   a   l       u   s   a   g   e   
                   a   n   d       b   e   h   a   v   i   o   r   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g       (   [   `   M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   `   ]   )   :       M   o   d   e   l       c   o   n   f   i   g   u   r   a   t   i   o   n       c   l   a   s   s       w   i   t   h       a   l   l       t   h   e       p   a   r   a   m   e   t   e   r   s       o   f       t   h   e       m   o   d   e   l   .   
                                                   I   n   i   t   i   a   l   i   z   i   n   g       w   i   t   h       a       c   o   n   f   i   g       f   i   l   e       d   o   e   s       n   o   t       l   o   a   d       t   h   e       w   e   i   g   h   t   s       a   s   s   o   c   i   a   t   e   d       w   i   t   h       t   h   e       m   o   d   e   l   ,       o   n   l   y       t   h   e   
                                                   c   o   n   f   i   g   u   r   a   t   i   o   n   .       C   h   e   c   k       o   u   t       t   h   e       [   `   ~   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   `   ]       m   e   t   h   o   d       t   o       l   o   a   d       t   h   e       m   o   d   e   l       w   e   i   g   h   t   s   .   
   
                   E   x   a   m   p   l   e   s   :   
   
                   `   `   `   p   y   t   h   o   n   
                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   T   o   k   e   n   i   z   e   r   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   
   
                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                   >   >   >       t   o   k   e   n   i   z   e   r       =       A   u   t   o   T   o   k   e   n   i   z   e   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                   >   >   >       i   n   p   u   t   s       =       t   o   k   e   n   i   z   e   r   (   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       p   a   d   d   i   n   g   =   T   r   u   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                   >   >   >       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                   >   >   >       p   o   o   l   e   d   _   o   u   t   p   u   t       =       o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t           #       p   o   o   l   e   d       (   E   O   S       t   o   k   e   n   )       s   t   a   t   e   s   
                   `   `   `   "   "   "   
   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   
   
                   _   n   o   _   s   p   l   i   t   _   m   o   d   u   l   e   s       =       [   "   M   e   t   a   C   l   i   p   2   T   e   x   t   E   m   b   e   d   d   i   n   g   s   "   ,       "   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   "   ]   
                   _   s   u   p   p   o   r   t   s   _   f   l   a   s   h   _   a   t   t   n       =       F   a   l   s   e           #       m   a   s   k       c   r   e   a   t   i   o   n       o   n   l   y       a   c   c   o   u   n   t   s       f   o   r       s   d   p   a   /   e   a   g   e   r   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   t   e   x   t   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   T   r   a   n   s   f   o   r   m   e   r   (   c   o   n   f   i   g   )   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   d   e   f       g   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   )       -   >       n   n   .   M   o   d   u   l   e   :   
                                   r   e   t   u   r   n       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   t   o   k   e   n   _   e   m   b   e   d   d   i   n   g   
   
                   d   e   f       s   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   ,       v   a   l   u   e   )   :   
                                   s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   t   o   k   e   n   _   e   m   b   e   d   d   i   n   g       =       v   a   l   u   e   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   o   s   i   t   i   o   n   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   :   
                                   r   "   "   "   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   T   o   k   e   n   i   z   e   r   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       t   o   k   e   n   i   z   e   r       =       A   u   t   o   T   o   k   e   n   i   z   e   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       i   n   p   u   t   s       =       t   o   k   e   n   i   z   e   r   (   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       p   a   d   d   i   n   g   =   T   r   u   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                                   >   >   >       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                                   >   >   >       p   o   o   l   e   d   _   o   u   t   p   u   t       =       o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t           #       p   o   o   l   e   d       (   E   O   S       t   o   k   e   n   )       s   t   a   t   e   s   
                                   `   `   `   "   "   "   
   
                                   r   e   t   u   r   n       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   (   
                                                   i   n   p   u   t   _   i   d   s   =   i   n   p   u   t   _   i   d   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   p   o   s   i   t   i   o   n   _   i   d   s   =   p   o   s   i   t   i   o   n   _   i   d   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                   )   
   
   
   @   d   a   t   a   c   l   a   s   s   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   (   
                   c   u   s   t   o   m   _   i   n   t   r   o   =   "   "   "   
                   B   a   s   e       c   l   a   s   s       f   o   r       t   e   x   t       m   o   d   e   l   '   s       o   u   t   p   u   t   s       t   h   a   t       a   l   s   o       c   o   n   t   a   i   n   s       a       p   o   o   l   i   n   g       o   f       t   h   e       l   a   s   t       h   i   d   d   e   n       s   t   a   t   e   s   .   
                   "   "   "   
   )   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   O   u   t   p   u   t   (   M   o   d   e   l   O   u   t   p   u   t   )   :   
                   r   "   "   "   
                   t   e   x   t   _   e   m   b   e   d   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   )   `       *   o   p   t   i   o   n   a   l   *       r   e   t   u   r   n   e   d       w   h   e   n       m   o   d   e   l       i   s       i   n   i   t   i   a   l   i   z   e   d       w   i   t   h       `   w   i   t   h   _   p   r   o   j   e   c   t   i   o   n   =   T   r   u   e   `   )   :   
                                   T   h   e       t   e   x   t       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y       a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   r   _   o   u   t   p   u   t   .   
                   "   "   "   
   
                   t   e   x   t   _   e   m   b   e   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   t   u   p   l   e   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       .   .   .   ]   ]       =       N   o   n   e   
                   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   t   u   p   l   e   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       .   .   .   ]   ]       =       N   o   n   e   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   "   "   "   
                   M   e   t   a   C   l   i   p   2       t   e   x   t       m   o   d   e   l       w   i   t   h       a       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       o   n       t   o   p       (   a       l   i   n   e   a   r       l   a   y   e   r       o   n       t   o   p       o   f       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t   )   .   
   
                   T   h   i   s       m   o   d   e   l       i   n   h   e   r   i   t   s       f   r   o   m       [   `   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   `   ]   .       C   h   e   c   k       t   h   e       s   u   p   e   r   c   l   a   s   s       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       t   h   e       g   e   n   e   r   i   c       m   e   t   h   o   d   s       t   h   e   
                   l   i   b   r   a   r   y       i   m   p   l   e   m   e   n   t   s       f   o   r       a   l   l       i   t   s       m   o   d   e   l       (   s   u   c   h       a   s       d   o   w   n   l   o   a   d   i   n   g       o   r       s   a   v   i   n   g   ,       r   e   s   i   z   i   n   g       t   h   e       i   n   p   u   t       e   m   b   e   d   d   i   n   g   s   ,       p   r   u   n   i   n   g       h   e   a   d   s   
                   e   t   c   .   )   
   
                   T   h   i   s       m   o   d   e   l       i   s       a   l   s   o       a       P   y   T   o   r   c   h       [   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   ]   (   h   t   t   p   s   :   /   /   p   y   t   o   r   c   h   .   o   r   g   /   d   o   c   s   /   s   t   a   b   l   e   /   n   n   .   h   t   m   l   #   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   )       s   u   b   c   l   a   s   s   .   
                   U   s   e       i   t       a   s       a       r   e   g   u   l   a   r       P   y   T   o   r   c   h       M   o   d   u   l   e       a   n   d       r   e   f   e   r       t   o       t   h   e       P   y   T   o   r   c   h       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       a   l   l       m   a   t   t   e   r       r   e   l   a   t   e   d       t   o       g   e   n   e   r   a   l       u   s   a   g   e   
                   a   n   d       b   e   h   a   v   i   o   r   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g       (   [   `   M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   `   ]   )   :       M   o   d   e   l       c   o   n   f   i   g   u   r   a   t   i   o   n       c   l   a   s   s       w   i   t   h       a   l   l       t   h   e       p   a   r   a   m   e   t   e   r   s       o   f       t   h   e       m   o   d   e   l   .   
                                                   I   n   i   t   i   a   l   i   z   i   n   g       w   i   t   h       a       c   o   n   f   i   g       f   i   l   e       d   o   e   s       n   o   t       l   o   a   d       t   h   e       w   e   i   g   h   t   s       a   s   s   o   c   i   a   t   e   d       w   i   t   h       t   h   e       m   o   d   e   l   ,       o   n   l   y       t   h   e   
                                                   c   o   n   f   i   g   u   r   a   t   i   o   n   .       C   h   e   c   k       o   u   t       t   h   e       [   `   ~   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   `   ]       m   e   t   h   o   d       t   o       l   o   a   d       t   h   e       m   o   d   e   l       w   e   i   g   h   t   s   .   
   
                   E   x   a   m   p   l   e   s   :   
   
                   `   `   `   p   y   t   h   o   n   
                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   T   o   k   e   n   i   z   e   r   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   
   
                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                   >   >   >       t   o   k   e   n   i   z   e   r       =       A   u   t   o   T   o   k   e   n   i   z   e   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                   >   >   >       i   n   p   u   t   s       =       t   o   k   e   n   i   z   e   r   (   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       p   a   d   d   i   n   g   =   T   r   u   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                   >   >   >       t   e   x   t   _   e   m   b   e   d   s       =       o   u   t   p   u   t   s   .   t   e   x   t   _   e   m   b   e   d   s   
                   `   `   `   "   "   "   
   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   
   
                   _   s   u   p   p   o   r   t   s   _   f   l   a   s   h   _   a   t   t   n       =       F   a   l   s   e   
                   _   n   o   _   s   p   l   i   t   _   m   o   d   u   l   e   s       =       [   "   M   e   t   a   C   l   i   p   2   T   e   x   t   E   m   b   e   d   d   i   n   g   s   "   ,       "   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   "   ]   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
   
                                   t   e   x   t   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   t   e   x   t   _   m   o   d   e   l       =       t   e   x   t   _   m   o   d   e   l   .   t   e   x   t   _   m   o   d   e   l   
   
                                   s   e   l   f   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n       =       n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m   ,       b   i   a   s   =   F   a   l   s   e   )   
   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   d   e   f       g   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   )       -   >       n   n   .   M   o   d   u   l   e   :   
                                   r   e   t   u   r   n       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   t   o   k   e   n   _   e   m   b   e   d   d   i   n   g   
   
                   d   e   f       s   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   ,       v   a   l   u   e   )   :   
                                   s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   t   o   k   e   n   _   e   m   b   e   d   d   i   n   g       =       v   a   l   u   e   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   o   s   i   t   i   o   n   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                   )       -   >       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   O   u   t   p   u   t   :   
                                   r   "   "   "   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   T   o   k   e   n   i   z   e   r   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       t   o   k   e   n   i   z   e   r       =       A   u   t   o   T   o   k   e   n   i   z   e   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       i   n   p   u   t   s       =       t   o   k   e   n   i   z   e   r   (   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       p   a   d   d   i   n   g   =   T   r   u   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                                   >   >   >       t   e   x   t   _   e   m   b   e   d   s       =       o   u   t   p   u   t   s   .   t   e   x   t   _   e   m   b   e   d   s   
                                   `   `   `   "   "   "   
   
                                   t   e   x   t   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   (   
                                                   i   n   p   u   t   _   i   d   s   =   i   n   p   u   t   _   i   d   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   p   o   s   i   t   i   o   n   _   i   d   s   =   p   o   s   i   t   i   o   n   _   i   d   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                   )   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       t   e   x   t   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   t   e   x   t   _   e   m   b   e   d   s       =       s   e   l   f   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n   (   p   o   o   l   e   d   _   o   u   t   p   u   t   )   
   
                                   r   e   t   u   r   n       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   O   u   t   p   u   t   (   
                                                   t   e   x   t   _   e   m   b   e   d   s   =   t   e   x   t   _   e   m   b   e   d   s   ,   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   t   e   x   t   _   o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   t   e   x   t   _   o   u   t   p   u   t   s   .   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   t   e   x   t   _   o   u   t   p   u   t   s   .   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   @   d   a   t   a   c   l   a   s   s   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   O   u   t   p   u   t   (   M   o   d   e   l   O   u   t   p   u   t   )   :   
                   r   "   "   "   
                   l   o   s   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   1   ,   )   `   ,       *   o   p   t   i   o   n   a   l   *   ,       r   e   t   u   r   n   e   d       w   h   e   n       `   r   e   t   u   r   n   _   l   o   s   s   `       i   s       `   T   r   u   e   `   )   :   
                                   C   o   n   t   r   a   s   t   i   v   e       l   o   s   s       f   o   r       i   m   a   g   e   -   t   e   x   t       s   i   m   i   l   a   r   i   t   y   .   
                   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   i   m   a   g   e   _   b   a   t   c   h   _   s   i   z   e   ,       t   e   x   t   _   b   a   t   c   h   _   s   i   z   e   )   `   )   :   
                                   T   h   e       s   c   a   l   e   d       d   o   t       p   r   o   d   u   c   t       s   c   o   r   e   s       b   e   t   w   e   e   n       `   i   m   a   g   e   _   e   m   b   e   d   s   `       a   n   d       `   t   e   x   t   _   e   m   b   e   d   s   `   .       T   h   i   s       r   e   p   r   e   s   e   n   t   s       t   h   e       i   m   a   g   e   -   t   e   x   t   
                                   s   i   m   i   l   a   r   i   t   y       s   c   o   r   e   s   .   
                   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   t   e   x   t   _   b   a   t   c   h   _   s   i   z   e   ,       i   m   a   g   e   _   b   a   t   c   h   _   s   i   z   e   )   `   )   :   
                                   T   h   e       s   c   a   l   e   d       d   o   t       p   r   o   d   u   c   t       s   c   o   r   e   s       b   e   t   w   e   e   n       `   t   e   x   t   _   e   m   b   e   d   s   `       a   n   d       `   i   m   a   g   e   _   e   m   b   e   d   s   `   .       T   h   i   s       r   e   p   r   e   s   e   n   t   s       t   h   e       t   e   x   t   -   i   m   a   g   e   
                                   s   i   m   i   l   a   r   i   t   y       s   c   o   r   e   s   .   
                   t   e   x   t   _   e   m   b   e   d   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   `   )   :   
                                   T   h   e       t   e   x   t       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y       a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t       o   f       [   `   M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   `   ]   .   
                   i   m   a   g   e   _   e   m   b   e   d   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   `   )   :   
                                   T   h   e       i   m   a   g   e       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y       a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t       o   f       [   `   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   `   ]   .   
                   t   e   x   t   _   m   o   d   e   l   _   o   u   t   p   u   t       (   `   B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   `   )   :   
                                   T   h   e       o   u   t   p   u   t       o   f       t   h   e       [   `   M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   `   ]   .   
                   v   i   s   i   o   n   _   m   o   d   e   l   _   o   u   t   p   u   t       (   `   B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   `   )   :   
                                   T   h   e       o   u   t   p   u   t       o   f       t   h   e       [   `   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   `   ]   .   
                   "   "   "   
   
                   l   o   s   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   t   e   x   t   _   e   m   b   e   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   i   m   a   g   e   _   e   m   b   e   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   t   e   x   t   _   m   o   d   e   l   _   o   u   t   p   u   t   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       N   o   n   e   
                   v   i   s   i   o   n   _   m   o   d   e   l   _   o   u   t   p   u   t   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       N   o   n   e   
   
                   d   e   f       t   o   _   t   u   p   l   e   (   s   e   l   f   )       -   >       t   u   p   l   e   [   A   n   y   ]   :   
                                   r   e   t   u   r   n       t   u   p   l   e   (   
                                                   s   e   l   f   [   k   ]       i   f       k       n   o   t       i   n       [   "   t   e   x   t   _   m   o   d   e   l   _   o   u   t   p   u   t   "   ,       "   v   i   s   i   o   n   _   m   o   d   e   l   _   o   u   t   p   u   t   "   ]       e   l   s   e       g   e   t   a   t   t   r   (   s   e   l   f   ,       k   )   .   t   o   _   t   u   p   l   e   (   )   
                                                   f   o   r       k       i   n       s   e   l   f   .   k   e   y   s   (   )   
                                   )   
   
   
   #       c   o   n   t   r   a   s   t   i   v   e       l   o   s   s       f   u   n   c   t   i   o   n   ,       a   d   a   p   t   e   d       f   r   o   m   
   #       h   t   t   p   s   :   /   /   s   a   c   h   i   n   r   u   k   .   g   i   t   h   u   b   .   i   o   /   b   l   o   g   /   2   0   2   1   -   0   3   -   0   7   -   m   e   t   a   c   l   i   p   _   2   .   h   t   m   l   
   d   e   f       c   o   n   t   r   a   s   t   i   v   e   _   l   o   s   s   (   l   o   g   i   t   s   :       t   o   r   c   h   .   T   e   n   s   o   r   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                   r   e   t   u   r   n       n   n   .   f   u   n   c   t   i   o   n   a   l   .   c   r   o   s   s   _   e   n   t   r   o   p   y   (   l   o   g   i   t   s   ,       t   o   r   c   h   .   a   r   a   n   g   e   (   l   e   n   (   l   o   g   i   t   s   )   ,       d   e   v   i   c   e   =   l   o   g   i   t   s   .   d   e   v   i   c   e   )   )   
   
   
   d   e   f       m   e   t   a   c   l   i   p   _   2   _   l   o   s   s   (   s   i   m   i   l   a   r   i   t   y   :       t   o   r   c   h   .   T   e   n   s   o   r   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                   c   a   p   t   i   o   n   _   l   o   s   s       =       c   o   n   t   r   a   s   t   i   v   e   _   l   o   s   s   (   s   i   m   i   l   a   r   i   t   y   )   
                   i   m   a   g   e   _   l   o   s   s       =       c   o   n   t   r   a   s   t   i   v   e   _   l   o   s   s   (   s   i   m   i   l   a   r   i   t   y   .   t   (   )   )   
                   r   e   t   u   r   n       (   c   a   p   t   i   o   n   _   l   o   s   s       +       i   m   a   g   e   _   l   o   s   s   )       /       2   .   0   
   
   
   d   e   f       _   g   e   t   _   v   e   c   t   o   r   _   n   o   r   m   (   t   e   n   s   o   r   :       t   o   r   c   h   .   T   e   n   s   o   r   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                   "   "   "   
                   T   h   i   s       m   e   t   h   o   d       i   s       e   q   u   i   v   a   l   e   n   t       t   o       t   e   n   s   o   r   .   n   o   r   m   (   p   =   2   ,       d   i   m   =   -   1   ,       k   e   e   p   d   i   m   =   T   r   u   e   )       a   n   d       u   s   e   d       t   o       m   a   k   e   
                   m   o   d   e   l       `   e   x   e   c   u   t   o   r   c   h   `       e   x   p   o   r   t   a   b   l   e   .       S   e   e       i   s   s   u   e       h   t   t   p   s   :   /   /   g   i   t   h   u   b   .   c   o   m   /   p   y   t   o   r   c   h   /   e   x   e   c   u   t   o   r   c   h   /   i   s   s   u   e   s   /   3   5   6   6   
                   "   "   "   
                   s   q   u   a   r   e   _   t   e   n   s   o   r       =       t   o   r   c   h   .   p   o   w   (   t   e   n   s   o   r   ,       2   )   
                   s   u   m   _   t   e   n   s   o   r       =       t   o   r   c   h   .   s   u   m   (   s   q   u   a   r   e   _   t   e   n   s   o   r   ,       d   i   m   =   -   1   ,       k   e   e   p   d   i   m   =   T   r   u   e   )   
                   n   o   r   m   e   d   _   t   e   n   s   o   r       =       t   o   r   c   h   .   p   o   w   (   s   u   m   _   t   e   n   s   o   r   ,       0   .   5   )   
                   r   e   t   u   r   n       n   o   r   m   e   d   _   t   e   n   s   o   r   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   M   o   d   e   l   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   "   "   "   
                   T   h   i   s       m   o   d   e   l       i   n   h   e   r   i   t   s       f   r   o   m       [   `   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   `   ]   .       C   h   e   c   k       t   h   e       s   u   p   e   r   c   l   a   s   s       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       t   h   e       g   e   n   e   r   i   c       m   e   t   h   o   d   s       t   h   e   
                   l   i   b   r   a   r   y       i   m   p   l   e   m   e   n   t   s       f   o   r       a   l   l       i   t   s       m   o   d   e   l       (   s   u   c   h       a   s       d   o   w   n   l   o   a   d   i   n   g       o   r       s   a   v   i   n   g   ,       r   e   s   i   z   i   n   g       t   h   e       i   n   p   u   t       e   m   b   e   d   d   i   n   g   s   ,       p   r   u   n   i   n   g       h   e   a   d   s   
                   e   t   c   .   )   
   
                   T   h   i   s       m   o   d   e   l       i   s       a   l   s   o       a       P   y   T   o   r   c   h       [   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   ]   (   h   t   t   p   s   :   /   /   p   y   t   o   r   c   h   .   o   r   g   /   d   o   c   s   /   s   t   a   b   l   e   /   n   n   .   h   t   m   l   #   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   )       s   u   b   c   l   a   s   s   .   
                   U   s   e       i   t       a   s       a       r   e   g   u   l   a   r       P   y   T   o   r   c   h       M   o   d   u   l   e       a   n   d       r   e   f   e   r       t   o       t   h   e       P   y   T   o   r   c   h       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       a   l   l       m   a   t   t   e   r       r   e   l   a   t   e   d       t   o       g   e   n   e   r   a   l       u   s   a   g   e   
                   a   n   d       b   e   h   a   v   i   o   r   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g       (   [   `   M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   `   ]   )   :       M   o   d   e   l       c   o   n   f   i   g   u   r   a   t   i   o   n       c   l   a   s   s       w   i   t   h       a   l   l       t   h   e       p   a   r   a   m   e   t   e   r   s       o   f       t   h   e       m   o   d   e   l   .   
                                                   I   n   i   t   i   a   l   i   z   i   n   g       w   i   t   h       a       c   o   n   f   i   g       f   i   l   e       d   o   e   s       n   o   t       l   o   a   d       t   h   e       w   e   i   g   h   t   s       a   s   s   o   c   i   a   t   e   d       w   i   t   h       t   h   e       m   o   d   e   l   ,       o   n   l   y       t   h   e   
                                                   c   o   n   f   i   g   u   r   a   t   i   o   n   .       C   h   e   c   k       o   u   t       t   h   e       [   `   ~   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   `   ]       m   e   t   h   o   d       t   o       l   o   a   d       t   h   e       m   o   d   e   l       w   e   i   g   h   t   s   .   
   
                   E   x   a   m   p   l   e   s   :   
   
                   `   `   `   p   y   t   h   o   n   
                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   M   o   d   e   l   
   
                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   
                   .   .   .                       t   e   x   t   =   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   ,       p   a   d   d   i   n   g   =   T   r   u   e   
                   .   .   .       )   
   
                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                   >   >   >       l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e       =       o   u   t   p   u   t   s   .   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e           #       t   h   i   s       i   s       t   h   e       i   m   a   g   e   -   t   e   x   t       s   i   m   i   l   a   r   i   t   y       s   c   o   r   e   
                   >   >   >       p   r   o   b   s       =       l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e   .   s   o   f   t   m   a   x   (   d   i   m   =   1   )           #       w   e       c   a   n       t   a   k   e       t   h   e       s   o   f   t   m   a   x       t   o       g   e   t       t   h   e       l   a   b   e   l       p   r   o   b   a   b   i   l   i   t   i   e   s   
                   `   `   `   "   "   "   
   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   
                   _   n   o   _   s   p   l   i   t   _   m   o   d   u   l   e   s       =       [   "   M   e   t   a   C   l   i   p   2   T   e   x   t   E   m   b   e   d   d   i   n   g   s   "   ,       "   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   "   ,       "   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   E   m   b   e   d   d   i   n   g   s   "   ]   
                   _   s   u   p   p   o   r   t   s   _   f   l   a   s   h   _   a   t   t   n       =       F   a   l   s   e           #       m   a   s   k       c   r   e   a   t   i   o   n       o   n   l   y       a   c   c   o   u   n   t   s       f   o   r       s   d   p   a   /   e   a   g   e   r   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
   
                                   i   f       n   o   t       i   s   i   n   s   t   a   n   c   e   (   c   o   n   f   i   g   .   t   e   x   t   _   c   o   n   f   i   g   ,       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g   )   :   
                                                   r   a   i   s   e       T   y   p   e   E   r   r   o   r   (   
                                                                   "   c   o   n   f   i   g   .   t   e   x   t   _   c   o   n   f   i   g       i   s       e   x   p   e   c   t   e   d       t   o       b   e       o   f       t   y   p   e       M   e   t   a   C   l   i   p   2   T   e   x   t   C   o   n   f   i   g       b   u   t       i   s       o   f       t   y   p   e   "   
                                                                   f   "       {   t   y   p   e   (   c   o   n   f   i   g   .   t   e   x   t   _   c   o   n   f   i   g   )   }   .   "   
                                                   )   
   
                                   i   f       n   o   t       i   s   i   n   s   t   a   n   c   e   (   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                                   r   a   i   s   e       T   y   p   e   E   r   r   o   r   (   
                                                                   "   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g       i   s       e   x   p   e   c   t   e   d       t   o       b   e       o   f       t   y   p   e       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g       b   u   t       i   s       o   f       t   y   p   e   "   
                                                                   f   "       {   t   y   p   e   (   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   )   }   .   "   
                                                   )   
   
                                   t   e   x   t   _   c   o   n   f   i   g       =       c   o   n   f   i   g   .   t   e   x   t   _   c   o   n   f   i   g   
                                   v   i   s   i   o   n   _   c   o   n   f   i   g       =       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   
   
                                   s   e   l   f   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m       =       c   o   n   f   i   g   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m   
                                   s   e   l   f   .   t   e   x   t   _   e   m   b   e   d   _   d   i   m       =       t   e   x   t   _   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
                                   s   e   l   f   .   v   i   s   i   o   n   _   e   m   b   e   d   _   d   i   m       =       v   i   s   i   o   n   _   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
   
                                   t   e   x   t   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   t   e   x   t   _   c   o   n   f   i   g   )   
                                   s   e   l   f   .   t   e   x   t   _   m   o   d   e   l       =       t   e   x   t   _   m   o   d   e   l   .   t   e   x   t   _   m   o   d   e   l   
   
                                   v   i   s   i   o   n   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   v   i   s   i   o   n   _   c   o   n   f   i   g   )   
                                   s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l       =       v   i   s   i   o   n   _   m   o   d   e   l   .   v   i   s   i   o   n   _   m   o   d   e   l   
   
                                   s   e   l   f   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   v   i   s   i   o   n   _   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m   ,       b   i   a   s   =   F   a   l   s   e   )   
                                   s   e   l   f   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   t   e   x   t   _   e   m   b   e   d   _   d   i   m   ,       s   e   l   f   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m   ,       b   i   a   s   =   F   a   l   s   e   )   
                                   s   e   l   f   .   l   o   g   i   t   _   s   c   a   l   e       =       n   n   .   P   a   r   a   m   e   t   e   r   (   t   o   r   c   h   .   t   e   n   s   o   r   (   s   e   l   f   .   c   o   n   f   i   g   .   l   o   g   i   t   _   s   c   a   l   e   _   i   n   i   t   _   v   a   l   u   e   )   )   
   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   @   f   i   l   t   e   r   _   o   u   t   _   n   o   n   _   s   i   g   n   a   t   u   r   e   _   k   w   a   r   g   s   (   )   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       g   e   t   _   t   e   x   t   _   f   e   a   t   u   r   e   s   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   o   s   i   t   i   o   n   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                   )       -   >       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   :   
                                   r   "   "   "   
                                   R   e   t   u   r   n   s   :   
                                                   t   e   x   t   _   f   e   a   t   u   r   e   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   `   )   :       T   h   e       t   e   x   t       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y   
                                                   a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t       o   f       [   `   M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   `   ]   .   
   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   T   o   k   e   n   i   z   e   r   ,       M   e   t   a   C   l   i   p   2   M   o   d   e   l   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       t   o   k   e   n   i   z   e   r       =       A   u   t   o   T   o   k   e   n   i   z   e   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       i   n   p   u   t   s       =       t   o   k   e   n   i   z   e   r   (   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       p   a   d   d   i   n   g   =   T   r   u   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
                                   >   >   >       t   e   x   t   _   f   e   a   t   u   r   e   s       =       m   o   d   e   l   .   g   e   t   _   t   e   x   t   _   f   e   a   t   u   r   e   s   (   *   *   i   n   p   u   t   s   )   
                                   `   `   `   "   "   "   
                                   t   e   x   t   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   (   
                                                   i   n   p   u   t   _   i   d   s   =   i   n   p   u   t   _   i   d   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   p   o   s   i   t   i   o   n   _   i   d   s   =   p   o   s   i   t   i   o   n   _   i   d   s   ,   
                                   )   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       t   e   x   t   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   t   e   x   t   _   f   e   a   t   u   r   e   s       =       s   e   l   f   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n   (   p   o   o   l   e   d   _   o   u   t   p   u   t   )   
   
                                   r   e   t   u   r   n       t   e   x   t   _   f   e   a   t   u   r   e   s   
   
                   @   f   i   l   t   e   r   _   o   u   t   _   n   o   n   _   s   i   g   n   a   t   u   r   e   _   k   w   a   r   g   s   (   )   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       g   e   t   _   i   m   a   g   e   _   f   e   a   t   u   r   e   s   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :       b   o   o   l       =       F   a   l   s   e   ,   
                   )       -   >       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   :   
                                   r   "   "   "   
                                   R   e   t   u   r   n   s   :   
                                                   i   m   a   g   e   _   f   e   a   t   u   r   e   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   `   )   :       T   h   e       i   m   a   g   e       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y   
                                                   a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t       o   f       [   `   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   `   ]   .   
   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   M   o   d   e   l   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                                   >   >   >       i   m   a   g   e   _   f   e   a   t   u   r   e   s       =       m   o   d   e   l   .   g   e   t   _   i   m   a   g   e   _   f   e   a   t   u   r   e   s   (   *   *   i   n   p   u   t   s   )   
                                   `   `   `   "   "   "   
                                   v   i   s   i   o   n   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   (   
                                                   p   i   x   e   l   _   v   a   l   u   e   s   =   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   ,   
                                   )   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   i   m   a   g   e   _   f   e   a   t   u   r   e   s       =       s   e   l   f   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n   (   p   o   o   l   e   d   _   o   u   t   p   u   t   )   
   
                                   r   e   t   u   r   n       i   m   a   g   e   _   f   e   a   t   u   r   e   s   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   L   o   n   g   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   p   o   s   i   t   i   o   n   _   i   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   L   o   n   g   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   r   e   t   u   r   n   _   l   o   s   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :       b   o   o   l       =       F   a   l   s   e   ,   
                   )       -   >       M   e   t   a   C   l   i   p   2   O   u   t   p   u   t   :   
                                   r   "   "   "   
                                   r   e   t   u   r   n   _   l   o   s   s       (   `   b   o   o   l   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                   W   h   e   t   h   e   r       o   r       n   o   t       t   o       r   e   t   u   r   n       t   h   e       c   o   n   t   r   a   s   t   i   v   e       l   o   s   s   .   
   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   M   o   d   e   l   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   
                                   .   .   .                       t   e   x   t   =   [   "   a       p   h   o   t   o       o   f       a       c   a   t   "   ,       "   a       p   h   o   t   o       o   f       a       d   o   g   "   ]   ,       i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   ,       p   a   d   d   i   n   g   =   T   r   u   e   
                                   .   .   .       )   
   
                                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                                   >   >   >       l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e       =       o   u   t   p   u   t   s   .   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e           #       t   h   i   s       i   s       t   h   e       i   m   a   g   e   -   t   e   x   t       s   i   m   i   l   a   r   i   t   y       s   c   o   r   e   
                                   >   >   >       p   r   o   b   s       =       l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e   .   s   o   f   t   m   a   x   (   d   i   m   =   1   )           #       w   e       c   a   n       t   a   k   e       t   h   e       s   o   f   t   m   a   x       t   o       g   e   t       t   h   e       l   a   b   e   l       p   r   o   b   a   b   i   l   i   t   i   e   s   
                                   `   `   `   "   "   "   
                                   #       U   s   e       M   E   T   A   C   L   I   P   _   2       m   o   d   e   l   '   s       c   o   n   f   i   g       f   o   r       s   o   m   e       f   i   e   l   d   s       (   i   f       s   p   e   c   i   f   i   e   d   )       i   n   s   t   e   a   d       o   f       t   h   o   s   e       o   f       v   i   s   i   o   n       &       t   e   x   t       c   o   m   p   o   n   e   n   t   s   .   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       =       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       =       (   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   
                                   )   
   
                                   v   i   s   i   o   n   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   (   
                                                   p   i   x   e   l   _   v   a   l   u   e   s   =   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   ,   
                                   )   
   
                                   t   e   x   t   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   t   e   x   t   _   m   o   d   e   l   (   
                                                   i   n   p   u   t   _   i   d   s   =   i   n   p   u   t   _   i   d   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   p   o   s   i   t   i   o   n   _   i   d   s   =   p   o   s   i   t   i   o   n   _   i   d   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                   )   
   
                                   i   m   a   g   e   _   e   m   b   e   d   s       =       v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   i   m   a   g   e   _   e   m   b   e   d   s       =       s   e   l   f   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n   (   i   m   a   g   e   _   e   m   b   e   d   s   )   
   
                                   t   e   x   t   _   e   m   b   e   d   s       =       t   e   x   t   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   t   e   x   t   _   e   m   b   e   d   s       =       s   e   l   f   .   t   e   x   t   _   p   r   o   j   e   c   t   i   o   n   (   t   e   x   t   _   e   m   b   e   d   s   )   
   
                                   #       n   o   r   m   a   l   i   z   e   d       f   e   a   t   u   r   e   s   
                                   i   m   a   g   e   _   e   m   b   e   d   s       =       i   m   a   g   e   _   e   m   b   e   d   s       /       _   g   e   t   _   v   e   c   t   o   r   _   n   o   r   m   (   i   m   a   g   e   _   e   m   b   e   d   s   )   
                                   t   e   x   t   _   e   m   b   e   d   s       =       t   e   x   t   _   e   m   b   e   d   s       /       _   g   e   t   _   v   e   c   t   o   r   _   n   o   r   m   (   t   e   x   t   _   e   m   b   e   d   s   )   
   
                                   #       c   o   s   i   n   e       s   i   m   i   l   a   r   i   t   y       a   s       l   o   g   i   t   s   
                                   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t       =       t   o   r   c   h   .   m   a   t   m   u   l   (   t   e   x   t   _   e   m   b   e   d   s   ,       i   m   a   g   e   _   e   m   b   e   d   s   .   t   (   )   .   t   o   (   t   e   x   t   _   e   m   b   e   d   s   .   d   e   v   i   c   e   )   )   
                                   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t       =       l   o   g   i   t   s   _   p   e   r   _   t   e   x   t       *       s   e   l   f   .   l   o   g   i   t   _   s   c   a   l   e   .   e   x   p   (   )   .   t   o   (   t   e   x   t   _   e   m   b   e   d   s   .   d   e   v   i   c   e   )   
   
                                   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e       =       l   o   g   i   t   s   _   p   e   r   _   t   e   x   t   .   t   (   )   
   
                                   l   o   s   s       =       N   o   n   e   
                                   i   f       r   e   t   u   r   n   _   l   o   s   s   :   
                                                   l   o   s   s       =       m   e   t   a   c   l   i   p   _   2   _   l   o   s   s   (   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t   )   
   
                                   r   e   t   u   r   n       M   e   t   a   C   l   i   p   2   O   u   t   p   u   t   (   
                                                   l   o   s   s   =   l   o   s   s   ,   
                                                   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e   =   l   o   g   i   t   s   _   p   e   r   _   i   m   a   g   e   ,   
                                                   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t   =   l   o   g   i   t   s   _   p   e   r   _   t   e   x   t   ,   
                                                   t   e   x   t   _   e   m   b   e   d   s   =   t   e   x   t   _   e   m   b   e   d   s   ,   
                                                   i   m   a   g   e   _   e   m   b   e   d   s   =   i   m   a   g   e   _   e   m   b   e   d   s   ,   
                                                   t   e   x   t   _   m   o   d   e   l   _   o   u   t   p   u   t   =   t   e   x   t   _   o   u   t   p   u   t   s   ,   
                                                   v   i   s   i   o   n   _   m   o   d   e   l   _   o   u   t   p   u   t   =   v   i   s   i   o   n   _   o   u   t   p   u   t   s   ,   
                                   )   
   
   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   T   r   a   n   s   f   o   r   m   e   r   (   n   n   .   M   o   d   u   l   e   )   :   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   e   m   b   e   d   _   d   i   m       =       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
   
                                   s   e   l   f   .   e   m   b   e   d   d   i   n   g   s       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   E   m   b   e   d   d   i   n   g   s   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   p   r   e   _   l   a   y   r   n   o   r   m       =       n   n   .   L   a   y   e   r   N   o   r   m   (   e   m   b   e   d   _   d   i   m   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
                                   s   e   l   f   .   e   n   c   o   d   e   r       =       M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   p   o   s   t   _   l   a   y   e   r   n   o   r   m       =       n   n   .   L   a   y   e   r   N   o   r   m   (   e   m   b   e   d   _   d   i   m   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       F   a   l   s   e   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   :   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       =       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       =       (   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   
                                   )   
   
                                   i   f       p   i   x   e   l   _   v   a   l   u   e   s       i   s       N   o   n   e   :   
                                                   r   a   i   s   e       V   a   l   u   e   E   r   r   o   r   (   "   Y   o   u       h   a   v   e       t   o       s   p   e   c   i   f   y       p   i   x   e   l   _   v   a   l   u   e   s   "   )   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   e   m   b   e   d   d   i   n   g   s   (   p   i   x   e   l   _   v   a   l   u   e   s   ,       i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   p   r   e   _   l   a   y   r   n   o   r   m   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
   
                                   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t       =       s   e   l   f   .   e   n   c   o   d   e   r   (   
                                                   i   n   p   u   t   s   _   e   m   b   e   d   s   =   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                   )   
   
                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   [   :   ,       0   ,       :   ]   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       s   e   l   f   .   p   o   s   t   _   l   a   y   e   r   n   o   r   m   (   p   o   o   l   e   d   _   o   u   t   p   u   t   )   
   
                                   r   e   t   u   r   n       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   (   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   p   o   o   l   e   r   _   o   u   t   p   u   t   =   p   o   o   l   e   d   _   o   u   t   p   u   t   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   (   
                   c   u   s   t   o   m   _   i   n   t   r   o   =   "   "   "   
                   T   h   e       v   i   s   i   o   n       m   o   d   e   l       f   r   o   m       M   E   T   A   C   L   I   P   _   2       w   i   t   h   o   u   t       a   n   y       h   e   a   d       o   r       p   r   o   j   e   c   t   i   o   n       o   n       t   o   p   .   
                   "   "   "   
   )   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   "   "   "   
                   T   h   e       v   i   s   i   o   n       m   o   d   e   l       f   r   o   m       M   e   t   a   C   l   i   p   2       w   i   t   h   o   u   t       a   n   y       h   e   a   d       o   r       p   r   o   j   e   c   t   i   o   n       o   n       t   o   p   .   
   
                   T   h   i   s       m   o   d   e   l       i   n   h   e   r   i   t   s       f   r   o   m       [   `   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   `   ]   .       C   h   e   c   k       t   h   e       s   u   p   e   r   c   l   a   s   s       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       t   h   e       g   e   n   e   r   i   c       m   e   t   h   o   d   s       t   h   e   
                   l   i   b   r   a   r   y       i   m   p   l   e   m   e   n   t   s       f   o   r       a   l   l       i   t   s       m   o   d   e   l       (   s   u   c   h       a   s       d   o   w   n   l   o   a   d   i   n   g       o   r       s   a   v   i   n   g   ,       r   e   s   i   z   i   n   g       t   h   e       i   n   p   u   t       e   m   b   e   d   d   i   n   g   s   ,       p   r   u   n   i   n   g       h   e   a   d   s   
                   e   t   c   .   )   
   
                   T   h   i   s       m   o   d   e   l       i   s       a   l   s   o       a       P   y   T   o   r   c   h       [   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   ]   (   h   t   t   p   s   :   /   /   p   y   t   o   r   c   h   .   o   r   g   /   d   o   c   s   /   s   t   a   b   l   e   /   n   n   .   h   t   m   l   #   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   )       s   u   b   c   l   a   s   s   .   
                   U   s   e       i   t       a   s       a       r   e   g   u   l   a   r       P   y   T   o   r   c   h       M   o   d   u   l   e       a   n   d       r   e   f   e   r       t   o       t   h   e       P   y   T   o   r   c   h       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       a   l   l       m   a   t   t   e   r       r   e   l   a   t   e   d       t   o       g   e   n   e   r   a   l       u   s   a   g   e   
                   a   n   d       b   e   h   a   v   i   o   r   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g       (   [   `   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   `   ]   )   :       M   o   d   e   l       c   o   n   f   i   g   u   r   a   t   i   o   n       c   l   a   s   s       w   i   t   h       a   l   l       t   h   e       p   a   r   a   m   e   t   e   r   s       o   f       t   h   e       m   o   d   e   l   .   
                                                   I   n   i   t   i   a   l   i   z   i   n   g       w   i   t   h       a       c   o   n   f   i   g       f   i   l   e       d   o   e   s       n   o   t       l   o   a   d       t   h   e       w   e   i   g   h   t   s       a   s   s   o   c   i   a   t   e   d       w   i   t   h       t   h   e       m   o   d   e   l   ,       o   n   l   y       t   h   e   
                                                   c   o   n   f   i   g   u   r   a   t   i   o   n   .       C   h   e   c   k       o   u   t       t   h   e       [   `   ~   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   `   ]       m   e   t   h   o   d       t   o       l   o   a   d       t   h   e       m   o   d   e   l       w   e   i   g   h   t   s   .   
   
                   E   x   a   m   p   l   e   s   :   
   
                   `   `   `   p   y   t   h   o   n   
                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   
   
                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                   >   >   >       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                   >   >   >       p   o   o   l   e   d   _   o   u   t   p   u   t       =       o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t           #       p   o   o   l   e   d       C   L   S       s   t   a   t   e   s   
                   `   `   `   "   "   "   
   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   
                   m   a   i   n   _   i   n   p   u   t   _   n   a   m   e       =       "   p   i   x   e   l   _   v   a   l   u   e   s   "   
                   _   n   o   _   s   p   l   i   t   _   m   o   d   u   l   e   s       =       [   "   M   e   t   a   C   l   i   p   2   E   n   c   o   d   e   r   L   a   y   e   r   "   ]   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   T   r   a   n   s   f   o   r   m   e   r   (   c   o   n   f   i   g   )   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   d   e   f       g   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   )       -   >       n   n   .   M   o   d   u   l   e   :   
                                   r   e   t   u   r   n       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :       b   o   o   l       =       F   a   l   s   e   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   :   
                                   r   "   "   "   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                                   >   >   >       l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                                   >   >   >       p   o   o   l   e   d   _   o   u   t   p   u   t       =       o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t           #       p   o   o   l   e   d       C   L   S       s   t   a   t   e   s   
                                   `   `   `   "   "   "   
   
                                   r   e   t   u   r   n       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   (   
                                                   p   i   x   e   l   _   v   a   l   u   e   s   =   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   ,   
                                   )   
   
   
   @   d   a   t   a   c   l   a   s   s   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   (   
                   c   u   s   t   o   m   _   i   n   t   r   o   =   "   "   "   
                   B   a   s   e       c   l   a   s   s       f   o   r       v   i   s   i   o   n       m   o   d   e   l   '   s       o   u   t   p   u   t   s       t   h   a   t       a   l   s   o       c   o   n   t   a   i   n   s       i   m   a   g   e       e   m   b   e   d   d   i   n   g   s       o   f       t   h   e       p   o   o   l   i   n   g       o   f       t   h   e       l   a   s   t       h   i   d   d   e   n       s   t   a   t   e   s   .   
                   "   "   "   
   )   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   O   u   t   p   u   t   (   M   o   d   e   l   O   u   t   p   u   t   )   :   
                   r   "   "   "   
                   i   m   a   g   e   _   e   m   b   e   d   s       (   `   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,       o   u   t   p   u   t   _   d   i   m   )   `       *   o   p   t   i   o   n   a   l   *       r   e   t   u   r   n   e   d       w   h   e   n       m   o   d   e   l       i   s       i   n   i   t   i   a   l   i   z   e   d       w   i   t   h       `   w   i   t   h   _   p   r   o   j   e   c   t   i   o   n   =   T   r   u   e   `   )   :   
                                   T   h   e       i   m   a   g   e       e   m   b   e   d   d   i   n   g   s       o   b   t   a   i   n   e   d       b   y       a   p   p   l   y   i   n   g       t   h   e       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       t   o       t   h   e       p   o   o   l   e   r   _   o   u   t   p   u   t   .   
                   "   "   "   
   
                   i   m   a   g   e   _   e   m   b   e   d   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   
                   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   t   u   p   l   e   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       .   .   .   ]   ]       =       N   o   n   e   
                   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   t   u   p   l   e   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       .   .   .   ]   ]       =       N   o   n   e   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   "   "   "   
                   M   e   t   a   C   l   i   p   2       v   i   s   i   o   n       m   o   d   e   l       w   i   t   h       a       p   r   o   j   e   c   t   i   o   n       l   a   y   e   r       o   n       t   o   p       (   a       l   i   n   e   a   r       l   a   y   e   r       o   n       t   o   p       o   f       t   h   e       p   o   o   l   e   d       o   u   t   p   u   t   )   .   
   
                   T   h   i   s       m   o   d   e   l       i   n   h   e   r   i   t   s       f   r   o   m       [   `   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   `   ]   .       C   h   e   c   k       t   h   e       s   u   p   e   r   c   l   a   s   s       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       t   h   e       g   e   n   e   r   i   c       m   e   t   h   o   d   s       t   h   e   
                   l   i   b   r   a   r   y       i   m   p   l   e   m   e   n   t   s       f   o   r       a   l   l       i   t   s       m   o   d   e   l       (   s   u   c   h       a   s       d   o   w   n   l   o   a   d   i   n   g       o   r       s   a   v   i   n   g   ,       r   e   s   i   z   i   n   g       t   h   e       i   n   p   u   t       e   m   b   e   d   d   i   n   g   s   ,       p   r   u   n   i   n   g       h   e   a   d   s   
                   e   t   c   .   )   
   
                   T   h   i   s       m   o   d   e   l       i   s       a   l   s   o       a       P   y   T   o   r   c   h       [   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   ]   (   h   t   t   p   s   :   /   /   p   y   t   o   r   c   h   .   o   r   g   /   d   o   c   s   /   s   t   a   b   l   e   /   n   n   .   h   t   m   l   #   t   o   r   c   h   .   n   n   .   M   o   d   u   l   e   )       s   u   b   c   l   a   s   s   .   
                   U   s   e       i   t       a   s       a       r   e   g   u   l   a   r       P   y   T   o   r   c   h       M   o   d   u   l   e       a   n   d       r   e   f   e   r       t   o       t   h   e       P   y   T   o   r   c   h       d   o   c   u   m   e   n   t   a   t   i   o   n       f   o   r       a   l   l       m   a   t   t   e   r       r   e   l   a   t   e   d       t   o       g   e   n   e   r   a   l       u   s   a   g   e   
                   a   n   d       b   e   h   a   v   i   o   r   .   
   
                   A   r   g   s   :   
                                   c   o   n   f   i   g       (   [   `   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   `   ]   )   :       M   o   d   e   l       c   o   n   f   i   g   u   r   a   t   i   o   n       c   l   a   s   s       w   i   t   h       a   l   l       t   h   e       p   a   r   a   m   e   t   e   r   s       o   f       t   h   e       m   o   d   e   l   .   
                                                   I   n   i   t   i   a   l   i   z   i   n   g       w   i   t   h       a       c   o   n   f   i   g       f   i   l   e       d   o   e   s       n   o   t       l   o   a   d       t   h   e       w   e   i   g   h   t   s       a   s   s   o   c   i   a   t   e   d       w   i   t   h       t   h   e       m   o   d   e   l   ,       o   n   l   y       t   h   e   
                                                   c   o   n   f   i   g   u   r   a   t   i   o   n   .       C   h   e   c   k       o   u   t       t   h   e       [   `   ~   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   `   ]       m   e   t   h   o   d       t   o       l   o   a   d       t   h   e       m   o   d   e   l       w   e   i   g   h   t   s   .   
   
                   E   x   a   m   p   l   e   s   :   
   
                   `   `   `   p   y   t   h   o   n   
                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   
   
                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                   >   >   >       i   m   a   g   e   _   e   m   b   e   d   s       =       o   u   t   p   u   t   s   .   i   m   a   g   e   _   e   m   b   e   d   s   
                   `   `   `   "   "   "   
   
                   c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   
                   m   a   i   n   _   i   n   p   u   t   _   n   a   m   e       =       "   p   i   x   e   l   _   v   a   l   u   e   s   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
   
                                   v   i   s   i   o   n   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l       =       v   i   s   i   o   n   _   m   o   d   e   l   .   v   i   s   i   o   n   _   m   o   d   e   l   
   
                                   s   e   l   f   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n       =       n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   p   r   o   j   e   c   t   i   o   n   _   d   i   m   ,       b   i   a   s   =   F   a   l   s   e   )   
   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   d   e   f       g   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   )       -   >       n   n   .   M   o   d   u   l   e   :   
                                   r   e   t   u   r   n       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   .   e   m   b   e   d   d   i   n   g   s   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   :       b   o   o   l       =       F   a   l   s   e   ,   
                   )       -   >       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   O   u   t   p   u   t   :   
                                   r   "   "   "   
                                   E   x   a   m   p   l   e   s   :   
   
                                   `   `   `   p   y   t   h   o   n   
                                   >   >   >       f   r   o   m       P   I   L       i   m   p   o   r   t       I   m   a   g   e   
                                   >   >   >       i   m   p   o   r   t       r   e   q   u   e   s   t   s   
                                   >   >   >       f   r   o   m       t   r   a   n   s   f   o   r   m   e   r   s       i   m   p   o   r   t       A   u   t   o   P   r   o   c   e   s   s   o   r   ,       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   
   
                                   >   >   >       m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
                                   >   >   >       p   r   o   c   e   s   s   o   r       =       A   u   t   o   P   r   o   c   e   s   s   o   r   .   f   r   o   m   _   p   r   e   t   r   a   i   n   e   d   (   "   f   a   c   e   b   o   o   k   /   m   e   t   a   c   l   i   p   -   2   -   w   o   r   l   d   w   i   d   e   -   h   u   g   e   -   q   u   i   c   k   g   e   l   u   "   )   
   
                                   >   >   >       u   r   l       =       "   h   t   t   p   :   /   /   i   m   a   g   e   s   .   c   o   c   o   d   a   t   a   s   e   t   .   o   r   g   /   v   a   l   2   0   1   7   /   0   0   0   0   0   0   0   3   9   7   6   9   .   j   p   g   "   
                                   >   >   >       i   m   a   g   e       =       I   m   a   g   e   .   o   p   e   n   (   r   e   q   u   e   s   t   s   .   g   e   t   (   u   r   l   ,       s   t   r   e   a   m   =   T   r   u   e   )   .   r   a   w   )   
   
                                   >   >   >       i   n   p   u   t   s       =       p   r   o   c   e   s   s   o   r   (   i   m   a   g   e   s   =   i   m   a   g   e   ,       r   e   t   u   r   n   _   t   e   n   s   o   r   s   =   "   p   t   "   )   
   
                                   >   >   >       o   u   t   p   u   t   s       =       m   o   d   e   l   (   *   *   i   n   p   u   t   s   )   
                                   >   >   >       i   m   a   g   e   _   e   m   b   e   d   s       =       o   u   t   p   u   t   s   .   i   m   a   g   e   _   e   m   b   e   d   s   
                                   `   `   `   "   "   "   
   
                                   v   i   s   i   o   n   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   (   
                                                   p   i   x   e   l   _   v   a   l   u   e   s   =   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   =   i   n   t   e   r   p   o   l   a   t   e   _   p   o   s   _   e   n   c   o   d   i   n   g   ,   
                                   )   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   p   o   o   l   e   r   _   o   u   t   p   u   t   
                                   i   m   a   g   e   _   e   m   b   e   d   s       =       s   e   l   f   .   v   i   s   u   a   l   _   p   r   o   j   e   c   t   i   o   n   (   p   o   o   l   e   d   _   o   u   t   p   u   t   )   
   
                                   r   e   t   u   r   n       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   O   u   t   p   u   t   (   
                                                   i   m   a   g   e   _   e   m   b   e   d   s   =   i   m   a   g   e   _   e   m   b   e   d   s   ,   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   v   i   s   i   o   n   _   o   u   t   p   u   t   s   .   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   (   
                   c   u   s   t   o   m   _   i   n   t   r   o   =   "   "   "   
                   M   E   T   A   C   L   I   P   _   2       v   i   s   i   o   n       e   n   c   o   d   e   r       w   i   t   h       a   n       i   m   a   g   e       c   l   a   s   s   i   f   i   c   a   t   i   o   n       h   e   a   d       o   n       t   o   p       (   a       l   i   n   e   a   r       l   a   y   e   r       o   n       t   o   p       o   f       t   h   e       p   o   o   l   e   d       f   i   n   a   l       h   i   d   d   e   n       s   t   a   t   e   s       o   f   
                   t   h   e       p   a   t   c   h       t   o   k   e   n   s   )       e   .   g   .       f   o   r       I   m   a   g   e   N   e   t   .   
                   "   "   "   
   )   
   c   l   a   s   s       M   e   t   a   C   l   i   p   2   F   o   r   I   m   a   g   e   C   l   a   s   s   i   f   i   c   a   t   i   o   n   (   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   m   a   i   n   _   i   n   p   u   t   _   n   a   m   e       =       "   p   i   x   e   l   _   v   a   l   u   e   s   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       M   e   t   a   C   l   i   p   2   C   o   n   f   i   g   )       -   >       N   o   n   e   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
   
                                   s   e   l   f   .   n   u   m   _   l   a   b   e   l   s       =       c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s   
                                   v   i   s   i   o   n   _   m   o   d   e   l       =       M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   )   
                                   s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l       =       v   i   s   i   o   n   _   m   o   d   e   l   .   v   i   s   i   o   n   _   m   o   d   e   l   
   
                                   #       C   l   a   s   s   i   f   i   e   r       h   e   a   d   
                                   s   e   l   f   .   c   l   a   s   s   i   f   i   e   r       =       (   
                                                   n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s   )       i   f       c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s       >       0       e   l   s   e       n   n   .   I   d   e   n   t   i   t   y   (   )   
                                   )   
   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   @   c   a   n   _   r   e   t   u   r   n   _   t   u   p   l   e   
                   @   a   u   t   o   _   d   o   c   s   t   r   i   n   g   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   l   a   b   e   l   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   :       O   p   t   i   o   n   a   l   [   b   o   o   l   ]       =       N   o   n   e   ,   
                   )       -   >       I   m   a   g   e   C   l   a   s   s   i   f   i   e   r   O   u   t   p   u   t   :   
                                   r   "   "   "   
                                   l   a   b   e   l   s       (   `   t   o   r   c   h   .   L   o   n   g   T   e   n   s   o   r   `       o   f       s   h   a   p   e       `   (   b   a   t   c   h   _   s   i   z   e   ,   )   `   ,       *   o   p   t   i   o   n   a   l   *   )   :   
                                                   L   a   b   e   l   s       f   o   r       c   o   m   p   u   t   i   n   g       t   h   e       i   m   a   g   e       c   l   a   s   s   i   f   i   c   a   t   i   o   n   /   r   e   g   r   e   s   s   i   o   n       l   o   s   s   .       I   n   d   i   c   e   s       s   h   o   u   l   d       b   e       i   n       `   [   0   ,       .   .   .   ,   
                                                   c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s       -       1   ]   `   .       I   f       `   c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s       =   =       1   `       a       r   e   g   r   e   s   s   i   o   n       l   o   s   s       i   s       c   o   m   p   u   t   e   d       (   M   e   a   n   -   S   q   u   a   r   e       l   o   s   s   )   ,       I   f   
                                                   `   c   o   n   f   i   g   .   n   u   m   _   l   a   b   e   l   s       >       1   `       a       c   l   a   s   s   i   f   i   c   a   t   i   o   n       l   o   s   s       i   s       c   o   m   p   u   t   e   d       (   C   r   o   s   s   -   E   n   t   r   o   p   y   )   .   
                                   "   "   "   
                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       =       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   f       o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   
                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       =       (   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   f       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s       i   s       n   o   t       N   o   n   e       e   l   s   e       s   e   l   f   .   c   o   n   f   i   g   .   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   
                                   )   
   
                                   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g       =       s   e   l   f   .   v   i   s   i   o   n   _   m   o   d   e   l   (   
                                                   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                                   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   _   a   t   t   e   n   t   i   o   n   s   ,   
                                                   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                   )   
   
                                   s   e   q   u   e   n   c   e   _   o   u   t   p   u   t       =       o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
   
                                   #       a   v   e   r   a   g   e       p   o   o   l       t   h   e       p   a   t   c   h       t   o   k   e   n   s   
                                   s   e   q   u   e   n   c   e   _   o   u   t   p   u   t       =       t   o   r   c   h   .   m   e   a   n   (   s   e   q   u   e   n   c   e   _   o   u   t   p   u   t   [   :   ,       1   :   ,       :   ]   ,       d   i   m   =   1   )   
                                   #       a   p   p   l   y       c   l   a   s   s   i   f   i   e   r   
                                   l   o   g   i   t   s       =       s   e   l   f   .   c   l   a   s   s   i   f   i   e   r   (   s   e   q   u   e   n   c   e   _   o   u   t   p   u   t   )   
   
                                   l   o   s   s       =       N   o   n   e   
                                   i   f       l   a   b   e   l   s       i   s       n   o   t       N   o   n   e   :   
                                                   l   o   s   s       =       s   e   l   f   .   l   o   s   s   _   f   u   n   c   t   i   o   n   (   l   a   b   e   l   s   ,       l   o   g   i   t   s   ,       s   e   l   f   .   c   o   n   f   i   g   )   
   
                                   r   e   t   u   r   n       I   m   a   g   e   C   l   a   s   s   i   f   i   e   r   O   u   t   p   u   t   (   
                                                   l   o   s   s   =   l   o   s   s   ,   
                                                   l   o   g   i   t   s   =   l   o   g   i   t   s   ,   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   =   o   u   t   p   u   t   s   .   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   s   =   o   u   t   p   u   t   s   .   a   t   t   e   n   t   i   o   n   s   ,   
                                   )   
   
   
   _   _   a   l   l   _   _       =       [   
                   "   M   e   t   a   C   l   i   p   2   M   o   d   e   l   "   ,   
                   "   M   e   t   a   C   l   i   p   2   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   "   ,   
                   "   M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   "   ,   
                   "   M   e   t   a   C   l   i   p   2   T   e   x   t   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   "   ,   
                   "   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   "   ,   
                   "   M   e   t   a   C   l   i   p   2   V   i   s   i   o   n   M   o   d   e   l   W   i   t   h   P   r   o   j   e   c   t   i   o   n   "   ,   
                   "   M   e   t   a   C   l   i   p   2   F   o   r   I   m   a   g   e   C   l   a   s   s   i   f   i   c   a   t   i   o   n   "   ,   
   ]   
                                       p   a   t   c   h   _   p   o   s   _   e   m   b   e   d       =       p   a   t   c   h   _   p   o   s   _   e   m   b   e   d   .   p   e   r   m   u   t   e   (   0   ,       2   ,       3   ,       1   )   .   v   i   e   w   (   1   ,       -   1   ,       d   i   m   )   
                                   r   e   t   u   r   n       p   a   t   c   h   _   p   o   s   _   e   m   b   e   d   
   
                   d   e   f       f   o   r   w   a   r   d   (   s   e   l   f   ,       p   i   x   e   l   _   v   a   l   u   e   s   :       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       t   o   r   c   h   .   B   o   o   l   T   e   n   s   o   r   )       -   >       t   o   r   c   h   .   T   e   n   s   o   r   :   
                                   b   a   t   c   h   _   s   i   z   e       =       p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   0   )   
   
                                   p   a   t   c   h   _   e   m   b   e   d   s               s   e   l   f   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   (   p   i   x   e   l   _   v   a   l   u   e   s   )   
                                   e   m   b   e   d   d   i   n   g   s       =       p   a   t   c   h   _   e   m   b   e   d   s   .   f   l   a   t   t   e   n   (   2   )   .   t   r   a   n   s   p   o   s   e   (   1   ,       2   )   
   
                                   m   a   x   _   i   m   _   h   ,       m   a   x   _   i   m   _   w       =       p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   2   )   ,       p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   3   )   
                                   m   a   x   _   n   b   _   p   a   t   c   h   e   s   _   h   ,       m   a   x   _   n   b   _   p   a   t   c   h   e   s   _   w       =       m   a   x   _   i   m   _   h       /   /       s   e   l   f   .   p   a   t   c   h   _   s   i   z   e   ,       m   a   x   _   i   m   _   w       /   /       s   e   l   f   .   p   a   t   c   h   _   s   i   z   e   
                                   b   o   u   n   d   a   r   i   e   s       =       t   o   r   c   h   .   a   r   a   n   g   e   (   1       /       s   e   l   f   .   n   u   m   _   p   a   t   c   h   e   s   _   p   e   r   _   s   i   d   e   ,       1   .   0   ,       1       /       s   e   l   f   .   n   u   m   _   p   a   t   c   h   e   s   _   p   e   r   _   s   i   d   e   )   
                                   p   o   s   i   t   i   o   n   _   i   d   s       =       t   o   r   c   h   .   f   u   l   l   (   (   b   a   t   c   h   _   s   i   z   e   ,       m   a   x   _   n   b   _   p   a   t   c   h   e   s   _   h       *       m   a   x   _   n   b   _   p   a   t   c   h   e   s   _   w   )   ,       f   i   l   l   _   v   a   l   u   e   =   0   )   
   
                                   f   o   r       b   a   t   c   h   _   i   d   x   ,       p   _   a   t   t   n   _   m   a   s   k       i   n       e   n   u   m   e   r   a   t   e   (   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   )   :   
                                                   n   b   _   p   a   t   c   h   e   s   _   h       =       p   _   a   t   t   n   _   m   a   s   k   [   :   ,       0   ]   .   s   u   m   (   )   
                                                   n   b   _   p   a   t   c   h   e   s   _   w       =       p   _   a   t   t   n   _   m   a   s   k   [   0   ]   .   s   u   m   (   )   
   
                                                   f   r   a   c   t   i   o   n   a   l   _   c   o   o   r   d   s   _   h       =       t   o   r   c   h   .   a   r   a   n   g   e   (   0   ,       1       -       1   e   -   6   ,       1       /       n   b   _   p   a   t   c   h   e   s   _   h   )   
                                                   f   r   a   c   t   i   o   n   a   l   _   c   o   o   r   d   s   _   w       =       t   o   r   c   h   .   a   r   a   n   g   e   (   0   ,       1       -       1   e   -   6   ,       1       /       n   b   _   p   a   t   c   h   e   s   _   w   )   
   
                                                   b   u   c   k   e   t   _   c   o   o   r   d   s   _   h       =       t   o   r   c   h   .   b   u   c   k   e   t   i   z   e   (   f   r   a   c   t   i   o   n   a   l   _   c   o   o   r   d   s   _   h   ,       b   o   u   n   d   a   r   i   e   s   ,       r   i   g   h   t   =   T   r   u   e   )   
                                                   b   u   c   k   e   t   _   c   o   o   r   d   s   _   w       =       t   o   r   c   h   .   b   u   c   k   e   t   i   z   e   (   f   r   a   c   t   i   o   n   a   l   _   c   o   o   r   d   s   _   w   ,       b   o   u   n   d   a   r   i   e   s   ,       r   i   g   h   t   =   T   r   u   e   )   
   
                                                   p   o   s   _   i   d   s       =       (   b   u   c   k   e   t   _   c   o   o   r   d   s   _   h   [   :   ,       N   o   n   e   ]       *       s   e   l   f   .   n   u   m   _   p   a   t   c   h   e   s   _   p   e   r   _   s   i   d   e       +       b   u   c   k   e   t   _   c   o   o   r   d   s   _   w   )   .   f   l   a   t   t   e   n   (   )   
                                                   p   o   s   i   t   i   o   n   _   i   d   s   [   b   a   t   c   h   _   i   d   x   ]   [   p   _   a   t   t   n   _   m   a   s   k   .   v   i   e   w   (   -   1   )   .   c   p   u   (   )   ]       =       p   o   s   _   i   d   s   
   
                                   p   o   s   i   t   i   o   n   _   i   d   s       =       p   o   s   i   t   i   o   n   _   i   d   s   .   t   o   (   s   e   l   f   .   p   o   s   i   t   i   o   n   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   .   d   e   v   i   c   e   )   
   
                                   e   m   b   e   d   d   i   n   g   s       =       e   m   b   e   d   d   i   n   g   s       +       s   e   l   f   .   p   o   s   i   t   i   o   n   _   e   m   b   e   d   d   i   n   g   (   p   o   s   i   t   i   o   n   _   i   d   s   )   
                                   r   e   t   u   r   n       e   m   b   e   d   d   i   n   g   s   
   
   
   c   l   a   s   s       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   M   u   l   t   i   h   e   a   d   A   t   t   e   n   t   i   o   n   P   o   o   l   i   n   g   H   e   a   d   (   n   n   .   M   o   d   u   l   e   )   :   
                   "   "   "   M   u   l   t   i   h   e   a   d       A   t   t   e   n   t   i   o   n       P   o   o   l   i   n   g   .   "   "   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
   
                                   s   e   l   f   .   p   r   o   b   e       =       n   n   .   P   a   r   a   m   e   t   e   r   (   t   o   r   c   h   .   r   a   n   d   n   (   1   ,       1   ,       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   )   )   
                                   s   e   l   f   .   a   t   t   e   n   t   i   o   n       =       t   o   r   c   h   .   n   n   .   M   u   l   t   i   h   e   a   d   A   t   t   e   n   t   i   o   n   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   n   u   m   _   a   t   t   e   n   t   i   o   n   _   h   e   a   d   s   ,       b   a   t   c   h   _   f   i   r   s   t   =   T   r   u   e   )   
                                   s   e   l   f   .   l   a   y   e   r   n   o   r   m       =       n   n   .   L   a   y   e   r   N   o   r   m   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
                                   s   e   l   f   .   m   l   p       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   M   L   P   (   c   o   n   f   i   g   )   
   
                   d   e   f       f   o   r   w   a   r   d   (   s   e   l   f   ,       h   i   d   d   e   n   _   s   t   a   t   e   ,       a   t   t   e   n   t   i   o   n   _   m   a   s   k   )   :   
                                   b   a   t   c   h   _   s   i   z   e       =       h   i   d   d   e   n   _   s   t   a   t   e   .   s   h   a   p   e   [   0   ]   
                                   p   r   o   b   e       =       s   e   l   f   .   p   r   o   b   e   .   r   e   p   e   a   t   (   b   a   t   c   h   _   s   i   z   e   ,       1   ,       1   )   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e       =       s   e   l   f   .   a   t   t   e   n   t   i   o   n   (   
                                                   q   u   e   r   y   =   p   r   o   b   e   ,       k   e   y   =   h   i   d   d   e   n   _   s   t   a   t   e   ,       v   a   l   u   e   =   h   i   d   d   e   n   _   s   t   a   t   e   ,       k   e   y   _   p   a   d   d   i   n   g   _   m   a   s   k   =   ~   a   t   t   e   n   t   i   o   n   _   m   a   s   k   
                                   )   [   0   ]   
   
                                   r   e   s   i   d   u   a   l       =       h   i   d   d   e   n   _   s   t   a   t   e   
                                   h   i   d   d   e   n   _   s   t   a   t   e       =       s   e   l   f   .   l   a   y   e   r   n   o   r   m   (   h   i   d   d   e   n   _   s   t   a   t   e   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e       =       r   e   s   i   d   u   a   l       +       s   e   l   f   .   m   l   p   (   h   i   d   d   e   n   _   s   t   a   t   e   )   
   
                                   r   e   t   u   r   n       h   i   d   d   e   n   _   s   t   a   t   e   [   :   ,       0   ]   
   
   
   c   l   a   s   s       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   M   o   d   e   l   (   P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   P   r   e   T   r   a   i   n   e   d   M   o   d   e   l   )   :   
                   c   o   n   f   i   g   :       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   C   o   n   f   i   g   
                   m   a   i   n   _   i   n   p   u   t   _   n   a   m   e       =       "   p   i   x   e   l   _   v   a   l   u   e   s   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
   
                                   s   e   l   f   .   e   m   b   e   d   d   i   n   g   s       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   E   m   b   e   d   d   i   n   g   s   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   e   n   c   o   d   e   r       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   E   n   c   o   d   e   r   (   c   o   n   f   i   g   )   
                                   s   e   l   f   .   p   o   s   t   _   l   a   y   e   r   n   o   r   m       =       n   n   .   L   a   y   e   r   N   o   r   m   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       e   p   s   =   c   o   n   f   i   g   .   l   a   y   e   r   _   n   o   r   m   _   e   p   s   )   
                                   s   e   l   f   .   h   e   a   d       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   M   u   l   t   i   h   e   a   d   A   t   t   e   n   t   i   o   n   P   o   o   l   i   n   g   H   e   a   d   (   c   o   n   f   i   g   )   
   
                                   #       I   n   i   t   i   a   l   i   z   e       w   e   i   g   h   t   s       a   n   d       a   p   p   l   y       f   i   n   a   l       p   r   o   c   e   s   s   i   n   g   
                                   s   e   l   f   .   p   o   s   t   _   i   n   i   t   (   )   
   
                   d   e   f       g   e   t   _   i   n   p   u   t   _   e   m   b   e   d   d   i   n   g   s   (   s   e   l   f   )       -   >       n   n   .   M   o   d   u   l   e   :   
                                   r   e   t   u   r   n       s   e   l   f   .   e   m   b   e   d   d   i   n   g   s   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   
   
                   @   c   h   e   c   k   _   m   o   d   e   l   _   i   n   p   u   t   s   (   t   i   e   _   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   F   a   l   s   e   )   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   p   i   x   e   l   _   v   a   l   u   e   s   ,   
                                   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   B   o   o   l   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   *   *   k   w   a   r   g   s   :       U   n   p   a   c   k   [   T   r   a   n   s   f   o   r   m   e   r   s   K   w   a   r   g   s   ]   ,   
                   )       -   >       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   :   
                                   b   a   t   c   h   _   s   i   z   e       =       p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   0   )   
                                   i   f       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       i   s       N   o   n   e   :   
                                                   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       t   o   r   c   h   .   o   n   e   s   (   
                                                                   s   i   z   e   =   (   
                                                                                   b   a   t   c   h   _   s   i   z   e   ,   
                                                                                   p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   2   )       /   /       s   e   l   f   .   c   o   n   f   i   g   .   p   a   t   c   h   _   s   i   z   e   ,   
                                                                                   p   i   x   e   l   _   v   a   l   u   e   s   .   s   i   z   e   (   3   )       /   /       s   e   l   f   .   c   o   n   f   i   g   .   p   a   t   c   h   _   s   i   z   e   ,   
                                                                   )   ,   
                                                                   d   t   y   p   e   =   t   o   r   c   h   .   b   o   o   l   ,   
                                                                   d   e   v   i   c   e   =   p   i   x   e   l   _   v   a   l   u   e   s   .   d   e   v   i   c   e   ,   
                                                   )   
   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   e   m   b   e   d   d   i   n   g   s   (   p   i   x   e   l   _   v   a   l   u   e   s   =   p   i   x   e   l   _   v   a   l   u   e   s   ,       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   )   
   
                                   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   .   v   i   e   w   (   b   a   t   c   h   _   s   i   z   e   ,       -   1   )   
                                   #       T   h   e       c   a   l   l       t   o       `   _   u   p   a   d   _   i   n   p   u   t   `       i   n       `   _   f   l   a   s   h   _   a   t   t   e   n   t   i   o   n   _   f   o   r   w   a   r   d   `       i   s       e   x   p   e   n   s   i   v   e   
                                   #       S   o       w   h   e   n       t   h   e       `   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   `       i   s       f   u   l   l       o   f       1   s       (   i   .   e   .       a   t   t   e   n   d   i   n   g       t   o       t   h   e       w   h   o   l   e       s   e   q   u   e   n   c   e   )   ,   
                                   #       a   v   o   i   d   i   n   g       p   a   s   s   i   n   g       t   h   e       a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,       w   h   i   c   h       i   s       e   q   u   i   v   a   l   e   n   t       t   o       a   t   t   e   n   d   i   n   g       t   o       t   h   e       f   u   l   l       s   e   q   u   e   n   c   e   
                                   i   f       n   o   t       t   o   r   c   h   .   a   n   y   (   ~   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   )   :   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       N   o   n   e   
                                   e   l   s   e   :   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       (   
                                                                   _   p   r   e   p   a   r   e   _   4   d   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   (   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   t   y   p   e   )   
                                                                   i   f       s   e   l   f   .   c   o   n   f   i   g   .   _   a   t   t   n   _   i   m   p   l   e   m   e   n   t   a   t   i   o   n       !   =       "   f   l   a   s   h   _   a   t   t   e   n   t   i   o   n   _   2   "   
                                                                   e   l   s   e       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   
                                                   )   
   
                                   e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   :       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t       =       s   e   l   f   .   e   n   c   o   d   e   r   (   
                                                   i   n   p   u   t   s   _   e   m   b   e   d   s   =   h   i   d   d   e   n   _   s   t   a   t   e   s   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                                   *   *   k   w   a   r   g   s   ,   
                                   )   
   
                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       e   n   c   o   d   e   r   _   o   u   t   p   u   t   s   .   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   
                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e       =       s   e   l   f   .   p   o   s   t   _   l   a   y   e   r   n   o   r   m   (   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   )   
   
                                   p   o   o   l   e   d   _   o   u   t   p   u   t       =       s   e   l   f   .   h   e   a   d   (   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,   
                                   )   
   
                                   r   e   t   u   r   n       B   a   s   e   M   o   d   e   l   O   u   t   p   u   t   W   i   t   h   P   o   o   l   i   n   g   (   
                                                   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   =   l   a   s   t   _   h   i   d   d   e   n   _   s   t   a   t   e   ,   
                                                   p   o   o   l   e   r   _   o   u   t   p   u   t   =   p   o   o   l   e   d   _   o   u   t   p   u   t   ,   
                                   )   
   
   
   c   l   a   s   s       P   h   i   4   M   u   l   t   i   m   o   d   a   l   I   m   a   g   e   E   m   b   e   d   d   i   n   g   (   n   n   .   M   o   d   u   l   e   )   :   
                   "   "   "   I   m   a   g   e       e   m   b   e   d   d   i   n   g   .   "   "   "   
   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       P   h   i   4   M   u   l   t   i   m   o   d   a   l   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   s   e   l   f   .   l   a   y   e   r   _   i   d   x       =       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   f   e   a   t   u   r   e   _   l   a   y   e   r   
                                   s   e   l   f   .   c   r   o   p   _   s   i   z   e       =       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   c   r   o   p   _   s   i   z   e   
                                   s   e   l   f   .   i   m   a   g   e   _   d   i   m   _   o   u   t       =       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   
   
                                   n   _   p   a   t   c   h   e   s       =       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   i   m   a   g   e   _   s   i   z   e       /   /       c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   .   p   a   t   c   h   _   s   i   z   e   
                                   i   f       n   _   p   a   t   c   h   e   s       %       2       !   =       0   :   
                                                   s   e   l   f   .   i   m   g   _   p   r   o   c   e   s   s   o   r   _   p   a   d   d   i   n   g       =       n   n   .   R   e   f   l   e   c   t   i   o   n   P   a   d   2   d   (   (   0   ,       1   ,       0   ,       1   )   )   
                                                   n   _   p   a   t   c   h   e   s       +   =       1   
                                   s   e   l   f   .   n   u   m   _   i   m   g   _   t   o   k   e   n   s       =       (   n   _   p   a   t   c   h   e   s       /   /       2   )       *   *       2   
   
                                   s   e   l   f   .   d   r   o   p       =       n   n   .   D   r   o   p   o   u   t   (   c   o   n   f   i   g   .   e   m   b   d   _   p   d   r   o   p   )   
                                   s   e   l   f   .   i   m   g   _   p   r   o   c   e   s   s   o   r       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   V   i   s   i   o   n   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   c   o   n   f   i   g   .   v   i   s   i   o   n   _   c   o   n   f   i   g   )   
                                   s   e   l   f   .   i   m   a   g   e   _   t   o   k   e   n   _   c   o   m   p   r   e   s   s   i   o   n       =       n   n   .   A   v   g   P   o   o   l   2   d   (   k   e   r   n   e   l   _   s   i   z   e   =   2   ,       s   t   r   i   d   e   =   2   )   
                                   s   e   l   f   .   i   m   g   _   p   r   o   j   e   c   t   i   o   n   _   u   p       =       n   n   .   L   i   n   e   a   r   (   s   e   l   f   .   i   m   a   g   e   _   d   i   m   _   o   u   t   ,       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   )   
                                   s   e   l   f   .   i   m   g   _   p   r   o   j   e   c   t   i   o   n   _   d   o   w   n       =       n   n   .   L   i   n   e   a   r   (   c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   ,       c   o   n   f   i   g   .   h   i   d   d   e   n   _   s   i   z   e   )   
                                   s   e   l   f   .   g   l   o   b   a   l   _   i   m   g   _   f   e   a   t   u   r   e   _   e   x   t   e   n   s   o   r       =       n   n   .   P   a   r   a   m   e   t   e   r   (   t   o   r   c   h   .   z   e   r   o   s   (   [   1   ,       1   ,       s   e   l   f   .   i   m   a   g   e   _   d   i   m   _   o   u   t   ]   )   )   
                                   s   e   l   f   .   s   u   b   _   i   m   g   _   f   e   a   t   u   r   e   _   e   x   t   e   n   s   o   r       =       n   n   .   P   a   r   a   m   e   t   e   r   (   t   o   r   c   h   .   z   e   r   o   s   (   [   1   ,       1   ,       1   ,       s   e   l   f   .   i   m   a   g   e   _   d   i   m   _   o   u   t   ]   )   )   
   
                   d   e   f       g   e   t   _   i   m   g   _   f   e   a   t   u   r   e   s   (   s   e   l   f   ,       i   m   g   _   e   m   b   e   d   s   :       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,       a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   N   o   n   e   )       -   >       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   :   
                                   i   m   g   _   p   r   o   c   e   s   s   o   r   _   o   u   t   p   u   t       =       s   e   l   f   .   i   m   g   _   p   r   o   c   e   s   s   o   r   (   
                                                   i   m   g   _   e   m   b   e   d   s   ,       p   a   t   c   h   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   =   a   t   t   e   n   t   i   o   n   _   m   a   s   k   ,       o   u   t   p   u   t   _   h   i   d   d   e   n   _   s   t   a   t   e   s   =   T   r   u   e   
                                   )   
                                   i   m   g   _   f   e   a   t   u   r   e       =       i   m   g   _   p   r   o   c   e   s   s   o   r   _   o   u   t   p   u   t   .   h   i   d   d   e   n   _   s   t   a   t   e   s   [   s   e   l   f   .   l   a   y   e   r   _   i   d   x   ]   
   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       i   m   g   _   f   e   a   t   u   r   e   
                                   #       r   e   s   h   a   p   e       t   o       2   D       t   e   n   s   o   r   
                                   w   i   d   t   h       =       i   n   t   (   m   a   t   h   .   s   q   r   t   (   p   a   t   c   h   _   f   e   a   t   u   r   e   .   s   i   z   e   (   1   )   )   )   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       p   a   t   c   h   _   f   e   a   t   u   r   e   .   v   i   e   w   (   -   1   ,       w   i   d   t   h   ,       w   i   d   t   h   ,       p   a   t   c   h   _   f   e   a   t   u   r   e   .   s   i   z   e   (   -   1   )   )   
                                   #       c   o   n   v   e   r   t       t   o       N   C   H   W   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       p   a   t   c   h   _   f   e   a   t   u   r   e   .   p   e   r   m   u   t   e   (   0   ,       3   ,       1   ,       2   )   
                                   i   f       g   e   t   a   t   t   r   (   s   e   l   f   ,       "   i   m   g   _   p   r   o   c   e   s   s   o   r   _   p   a   d   d   i   n   g   "   ,       N   o   n   e   )       i   s       n   o   t       N   o   n   e   :   
                                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       s   e   l   f   .   i   m   g   _   p   r   o   c   e   s   s   o   r   _   p   a   d   d   i   n   g   (   p   a   t   c   h   _   f   e   a   t   u   r   e   )   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       s   e   l   f   .   i   m   a   g   e   _   t   o   k   e   n   _   c   o   m   p   r   e   s   s   i   o   n   (   p   a   t   c   h   _   f   e   a   t   u   r   e   )   
                                   #       c   o   n   v   e   r   t       t   o       N   H   W   C   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       p   a   t   c   h   _   f   e   a   t   u   r   e   .   p   e   r   m   u   t   e   (   0   ,       2   ,       3   ,       1   )   
                                   p   a   t   c   h   _   f   e   a   t   u   r   e       =       p   a   t   c   h   _   f   e   a   t   u   r   e   .   v   i   e   w   (   -   1   ,       p   a   t   c   h   _   f   e   a   t   u   r   e   .   s   i   z   e   (   1   )       *       p   a   t   c   h   _   f   e   a   t   u   r   e   .   s   i   z   e   (   2   )   ,       p   a   t   c   h   _   f   e   a   t   u   r   e   .   s   i   z   e   (   -   1   )   )   
                                   r   e   t   u   r   n       p   a   t   c   h   _   f   e   a   t   u   r   e   
   
                   d   e   f       f   o   r   w   a   r   d   (   
                                   s   e   l   f   ,   
                                   i   n   p   u   t   _   i   d   s   :       t   o   r   c   h   .   L   o   n   g   T   e   n   s   o   r   ,   
                                   i   n   p   u   t   s   _   e   m   b   e   d   s   :       t   o   r   c   h   .   T   e   n   s   o   r   ,   
                                   i   m   a   g   e   _   p   i   x   e   l   _   v   a   l   u   e   s   :       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   ,   
                                   i   m   a   g   e   _   s   i   z   e   s   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                                   i   m   a   g   e   _   a   t   t   e   n   t   i   o   n   _   m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]       =       N   o   n   e   ,   
                   )       -   >       t   o   r   c   h   .   F   l   o   a   t   T   e   n   s   o   r   :   
                                   i   m   a   g   e   _   p   i   x   e   l   _   v   a   l   u   e   s       =       i   m   a   g   e   _   p   i   x   e   l   _   v   a   l   u   e   s   .   t   o   (   s   e   l   f   .   i   m   g   _   p   r   o   c   e   s   s   o   r   .   e   m   b   e   d   d   i   n   g   s   .   p   a   t   c   h   _   e   m   b   e   d   d   i   n   g   .   w   e   i   g   h   t   .           xb   @                    # coding=utf-8
# Copyright 2023 Microsoft Research and The HuggingFace Inc. team. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""PyTorch KOSMOS-2 model."""

import math
from dataclasses import dataclass
from typing import Any, Callable, Optional, Union

import torch
from torch import nn

from ...activations import ACT2FN
from ...cache_utils import Cache, DynamicCache, EncoderDecoderCache
from ...generation import GenerationMixin
from ...modeling_flash_attention_utils import FlashAttentionKwargs
from ...modeling_layers import GradientCheckpointingLayer
from ...modeling_outputs import (
    BaseModelOutput,
    BaseModelOutputWithPastAndCrossAttentions,
    BaseModelOutputWithPooling,
    CausalLMOutputWithCrossAttentions,
)
from ...modeling_utils import ALL_ATTENTION_FUNCTIONS, PreTrainedModel
from ...processing_utils import Unpack
from ...utils import ModelOutput, TransformersKwargs, auto_docstring, can_return_tuple, logging, torch_int
from ...utils.deprecation import deprecate_kwarg
from .configuration_kosmos2 import Kosmos2Config, Kosmos2TextConfig, Kosmos2VisionConfig


logger = logging.get_logger(__name__)


def _expand_mask(mask: torch.Tensor, dtype: torch.dtype, tgt_len: Optional[int] = None):
    """
    Expands attention_mask from `[bsz, seq_len]` to `[bsz, 1, tgt_seq_len, src_seq_len]`.
    """
    bsz, src_len = mask.size()
    tgt_len = tgt_len if tgt_len is not None else src_len

    expanded_mask = mask[:, None, None, :].expand(bsz, 1, tgt_len, src_len).to(dtype)

    inverted_mask = 1.0 - expanded_mask

    return inverted_mask.masked_fill(inverted_mask.to(torch.bool), torch.finfo(dtype).min)


def _make_causal_mask(
    input_ids_shape: torch.Size, dtype: torch.dtype, device: torch.device, past_key_values_length: int = 0
):
    """
    Make causal mask used for bi-directional self-attention.
    """
    bsz, tgt_len = input_ids_shape
    mask = torch.full((tgt_len, tgt_len), torch.finfo(dtype).min, device=device)
    mask_cond = torch.arange(mask.size(-1), device=device)
    mask.masked_fill_(mask_cond < (mask_cond + 1).view(mask.size(-1), 1), 0)
    mask = mask.to(dtype)

    if past_key_values_length > 0:
        mask = torch.cat([torch.zeros(tgt_len, past_key_values_length, dtype=dtype, device=device), mask], dim=-1)
    return mask[None, None, :, :].expand(bsz, 1, tgt_len, tgt_len + past_key_values_length)


# Copied from transformers.models.roberta.modeling_roberta.create_position_ids_from_input_ids
def create_position_ids_from_input_ids(input_ids, padding_idx, past_key_values_length=0):
    """
    Replace non-padding symbols with their position numbers. Position numbers begin at padding_idx+1. Padding symbols
    are ignored. This is modified from fairseq's `utils.make_positions`.

    Args:
        x: torch.Tensor x:

    Returns: torch.Tensor
    """
    # The series of casts and type-conversions here are carefully balanced to both work with ONNX export and XLA.
    mask = input_ids.ne(padding_idx).int()
    incremental_indices = (torch.cumsum(mask, dim=1).type_as(mask) + past_key_values_length) * mask
    return incremental_indices.long() + padding_idx


@dataclass
@auto_docstring(
    custom_intro="""
    Base class for text model's outputs that also contains a pooling of the last hidden states.
    """
)
class Kosmos2ModelOutput(ModelOutput):
    r"""
    past_key_values (`Cache`, *optional*, returned when `use_cache=True` is passed or when `config.use_cache=True`):
        It is a [`~cache_utils.Cache`] instance. For more details, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache).

        Contains pre-computed hidden-states (key and values in the self-attention blocks and optionally if
        `config.is_encoder_decoder=True` in the cross-attention blocks) that can be used (see `past_key_values`
        input) to speed up sequential decoding.
    image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
        Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.
    projection_attentions (`tuple(torch.FloatTensor)`, *optional*):
        Tuple of `torch.FloatTensor` (one for each layer) of shape `(batch_size, num_heads, sequence_length,
        sequence_length)`.

        Attentions weights given by `Kosmos2ImageToTextProjection`, after the attention softmax, used to compute
        the weighted average in the self-attention heads.
    vision_model_output (`BaseModelOutputWithPooling`, *optional*):
        The output of the [`Kosmos2VisionModel`].
    """

    last_hidden_state: Optional[torch.FloatTensor] = None
    past_key_values: Optional[Cache] = None
    hidden_states: Optional[tuple[torch.FloatTensor]] = None
    attentions: Optional[tuple[torch.FloatTensor]] = None
    image_embeds: Optional[torch.FloatTensor] = None
    projection_attentions: Optional[tuple[torch.FloatTensor]] = None
    vision_model_output: BaseModelOutputWithPooling = None

    def to_tuple(self) -> tuple[Any]:
        return tuple(
            self[k] if k not in ["text_model_output", "vision_model_output"] else getattr(self, k).to_tuple()
            for k in self.keys()
        )


@dataclass
@auto_docstring(
    custom_intro="""
    Model output class for `Kosmos2ForConditionalGeneration`.
    """
)
class Kosmos2ForConditionalGenerationModelOutput(ModelOutput):
    r"""
    loss (`torch.FloatTensor` of shape `(1,)`, *optional*, returned when `labels` is provided):
        Language modeling loss (for next-token prediction).
    logits (`torch.FloatTensor` of shape `(batch_size, sequence_length, config.vocab_size)`):
        Prediction scores of the language modeling head (scores for each vocabulary token before SoftMax).
    past_key_values (`Cache`, *optional*, returned when `use_cache=True` is passed or when `config.use_cache=True`):
        It is a [`~cache_utils.Cache`] instance. For more details, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache).

        Contains pre-computed hidden-states (key and values in the self-attention blocks and optionally if
        `config.is_encoder_decoder=True` in the cross-attention blocks) that can be used (see `past_key_values`
        input) to speed up sequential decoding.
    image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
        Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.
    projection_attentions (`tuple(torch.FloatTensor)`, *optional*):
        Tuple of `torch.FloatTensor` (one for each layer) of shape `(batch_size, num_heads, sequence_length,
        sequence_length)`.

        Attentions weights given by `Kosmos2ImageToTextProjection`, after the attention softmax, used to compute
        the weighted average in the self-attention heads.
    vision_model_output (`BaseModelOutputWithPooling`, *optional*):
        The output of the [`Kosmos2VisionModel`].
    """

    loss: Optional[torch.FloatTensor] = None
    logits: Optional[torch.FloatTensor] = None
    past_key_values: Optional[Cache] = None
    hidden_states: Optional[tuple[torch.FloatTensor]] = None
    attentions: Optional[tuple[torch.FloatTensor]] = None
    image_embeds: Optional[torch.FloatTensor] = None
    projection_attentions: Optional[tuple[torch.FloatTensor]] = None
    vision_model_output: BaseModelOutputWithPooling = None

    def to_tuple(self) -> tuple[Any]:
        return tuple(
            self[k] if k not in ["text_model_output", "vision_model_output"] else getattr(self, k).to_tuple()
            for k in self.keys()
        )


# Copied from transformers.models.clip.modeling_clip.CLIPVisionEmbeddings with CLIP->Kosmos2
class Kosmos2VisionEmbeddings(nn.Module):
    def __init__(self, config: Kosmos2VisionConfig):
        super().__init__()
        self.config = config
        self.embed_dim = config.hidden_size
        self.image_size = config.image_size
        self.patch_size = config.patch_size

        self.class_embedding = nn.Parameter(torch.randn(self.embed_dim))

        self.patch_embedding = nn.Conv2d(
            in_channels=config.num_channels,
            out_channels=self.embed_dim,
            kernel_size=self.patch_size,
            stride=self.patch_size,
            bias=False,
        )

        self.num_patches = (self.image_size // self.patch_size) ** 2
        self.num_positions = self.num_patches + 1
        self.position_embedding = nn.Embedding(self.num_positions, self.embed_dim)
        self.register_buffer("position_ids", torch.arange(self.num_positions).expand((1, -1)), persistent=False)

    def interpolate_pos_encoding(self, embeddings: torch.Tensor, height: int, width: int) -> torch.Tensor:
        """
        This method allows to interpolate the pre-trained position encodings, to be able to use the model on higher resolution
        images. This method is also adapted to support torch.jit tracing.

        Adapted from:
        - https://github.com/facebookresearch/dino/blob/de9ee3df6cf39fac952ab558447af1fa1365362a/vision_transformer.py#L174-L194, and
        - https://github.com/facebookresearch/dinov2/blob/e1277af2ba9496fbadf7aec6eba56e8d882d1e35/dinov2/models/vision_transformer.py#L179-L211
        """

        num_patches = embeddings.shape[1] - 1
        position_embedding = self.position_embedding.weight.unsqueeze(0)
        num_positions = position_embedding.shape[1] - 1

        # always interpolate when tracing to ensure the exported model works for dynamic input shapes
        if not torch.jit.is_tracing() and num_patches == num_positions and height == width:
            return self.position_embedding(self.position_ids)

        class_pos_embed = position_embedding[:, :1]
        patch_pos_embed = position_embedding[:, 1:]

        dim = embeddings.shape[-1]

        new_height = height // self.patch_size
        new_width = width // self.patch_size

        sqrt_num_positions = torch_int(num_positions**0.5)
        patch_pos_embed = patch_pos_embed.reshape(1, sqrt_num_positions, sqrt_num_positions, dim)
        patch_pos_embed = patch_pos_embed.permute(0, 3, 1, 2)

        patch_pos_embed = nn.functional.interpolate(
            patch_pos_embed,
            size=(new_height, new_width),
            mode="bicubic",
            align_corners=False,
        )

        patch_pos_embed = patch_pos_embed.permute(0, 2, 3, 1).view(1, -1, dim)

        return torch.cat((class_pos_embed, patch_pos_embed), dim=1)

    def forward(self, pixel_values: torch.FloatTensor, interpolate_pos_encoding=False) -> torch.Tensor:
        batch_size, _, height, width = pixel_values.shape
        if not interpolate_pos_encoding and (height != self.image_size or width != self.image_size):
            raise ValueError(
                f"Input image size ({height}*{width}) doesn't match model ({self.image_size}*{self.image_size})."
            )
        target_dtype = self.patch_embedding.weight.dtype
        patch_embeds = self.patch_embedding(pixel_values.to(dtype=target_dtype))  # shape = [*, width, grid, grid]
        patch_embeds = patch_embeds.flatten(2).transpose(1, 2)

        class_embeds = self.class_embedding.expand(batch_size, 1, -1)
        embeddings = torch.cat([class_embeds, patch_embeds], dim=1)
        if interpolate_pos_encoding:
            embeddings = embeddings + self.interpolate_pos_encoding(embeddings, height, width)
        else:
            embeddings = embeddings + self.position_embedding(self.position_ids)
        return embeddings


# Adapted from transformers.models.siglip.modeling_siglip.eager_attention_forward -> Kosmos2 doesn't cast attn weights to fp32
def eager_attention_forward(
    module: nn.Module,
    query: torch.Tensor,
    key: torch.Tensor,
    value: torch.Tensor,
    attention_mask: Optional[torch.Tensor],
    scaling: float,
    dropout: float = 0.0,
    **kwargs,
):
    attn_weights = torch.matmul(query, key.transpose(-1, -2)) * scaling
    if attention_mask is not None:
        attn_weights = attn_weights + attention_mask

    attn_weights = nn.functional.softmax(attn_weights, dim=-1)
    attn_weights = nn.functional.dropout(attn_weights, p=dropout, training=module.training)

    attn_output = torch.matmul(attn_weights, value)
    attn_output = attn_output.transpose(1, 2).contiguous()
    return attn_output, attn_weights


class Kosmos2VisionAttention(nn.Module):
    """Multi-headed attention from 'Attention Is All You Need' paper"""

    def __init__(self, config):
        super().__init__()
        self.config = config
        self.embed_dim = config.hidden_size
        self.num_heads = config.num_attention_heads
        self.head_dim = self.embed_dim // self.num_heads
        if self.head_dim * self.num_heads != self.embed_dim:
            raise ValueError(
                f"embed_dim must be divisible by num_heads (got `embed_dim`: {self.embed_dim} and `num_heads`:"
                f" {self.num_heads})."
            )
        self.scale = self.head_dim**-0.5
        self.dropout = config.attention_dropout
        self.is_causal = False

        self.k_proj = nn.Linear(self.embed_dim, self.embed_dim)
        self.v_proj = nn.Linear(self.embed_dim, self.embed_dim)
        self.q_proj = nn.Linear(self.embed_dim, self.embed_dim)
        self.out_proj = nn.Linear(self.embed_dim, self.embed_dim)

    def forward(
        self,
        hidden_states: torch.Tensor,
        attention_mask: Optional[torch.Tensor] = None,
        causal_attention_mask: Optional[torch.Tensor] = None,
        output_attentions: Optional[bool] = False,
    ) -> tuple[torch.Tensor, Optional[torch.Tensor]]:
        """Input shape: Batch x Time x Channel"""

        batch_size, seq_length, embed_dim = hidden_states.shape

        queries = self.q_proj(hidden_states)
        keys = self.k_proj(hidden_states)
        values = self.v_proj(hidden_states)

        queries = queries.view(batch_size, seq_length, self.num_heads, self.head_dim).transpose(1, 2)
        keys = keys.view(batch_size, seq_length, self.num_heads, self.head_dim).transpose(1, 2)
        values = values.view(batch_size, seq_length, self.num_heads, self.head_dim).transpose(1, 2)
        # CLIP text model uses both `causal_attention_mask` and `attention_mask`
        # in case FA2 kernel is called, `is_causal` should be inferred from `causal_attention_mask`
        if self.config._attn_implementation != "flash_attention_2":
            if attention_mask is not None and causal_attention_mask is not None:
                attention_mask = attention_mask + causal_attention_mask
            elif causal_attention_mask is not None:
                attention_mask = causal_attention_mask
        else:
            self.is_causal = causal_attention_mask is not None

        attention_interface: Callable = eager_attention_forward
        if self.config._attn_implementation != "eager":
            attention_interface = ALL_ATTENTION_FUNCTIONS[self.config._attn_implementation]

        attn_output, attn_weights = attention_interface(
            self,
            queries,
            keys,
            values,
            attention_mask,
            is_causal=self.is_causal,
            scaling=self.scale,
            dropout=0.0 if not self.training else self.dropout,
        )

        attn_output = attn_output.reshape(batch_size, seq_length, embed_dim).contiguous()
        attn_output = self.out_proj(attn_output)
        if not output_attentions:
            attn_weights = None
        return attn_output, attn_weights


# Copied from transformers.models.clip.modeling_clip.CLIPMLP with CLIP->Kosmos2Vision
class Kosmos2VisionMLP(nn.Module):
    def __init__(self, config):
        super().__init__()
        self.config = config
        self.activation_fn = ACT2FN[config.hidden_act]
        self.fc1 = nn.Linear(config.hidden_size, config.intermediate_size)
        self.fc2 = nn.Linear(config.intermediate_size, config.hidden_size)

    def forward(self, hidden_states: torch.Tensor) -> torch.Tensor:
        hidden_states = self.fc1(hidden_states)
        hidden_states = self.activation_fn(hidden_states)
        hidden_states = self.fc2(hidden_states)
        return hidden_states


# Copied from transformers.models.altclip.modeling_altclip.AltCLIPEncoderLayer with AltCLIP->Kosmos2Vision
class Kosmos2VisionEncoderLayer(GradientCheckpointingLayer):
    def __init__(self, config: Kosmos2VisionConfig):
        super().__init__()
        self.embed_dim = config.hidden_size
        self.self_attn = Kosmos2VisionAttention(config)
        self.layer_norm1 = nn.LayerNorm(self.embed_dim, eps=config.layer_norm_eps)
        self.mlp = Kosmos2VisionMLP(config)
        self.layer_norm2 = nn.LayerNorm(self.embed_dim, eps=config.layer_norm_eps)

    def forward(
        self,
        hidden_states: torch.Tensor,
        attention_mask: torch.Tensor,
        causal_attention_mask: torch.Tensor,
        output_attentions: Optional[bool] = False,
    ) -> tuple[torch.FloatTensor]:
        """
        Args:
            hidden_states (`torch.FloatTensor`): input to the layer of shape `(batch, seq_len, embed_dim)`
            attention_mask (`torch.FloatTensor`): attention mask of size
                `(batch, 1, tgt_len, src_len)` where padding elements are indicated by very large negative values.
                `(config.encoder_attention_heads,)`.
            output_attentions (`bool`, *optional*):
                Whether or not to return the attentions tensors of all attention layers. See `attentions` under
                returned tensors for more detail.
        """
        residual = hidden_states

        hidden_states = self.layer_norm1(hidden_states)
        hidden_states, attn_weights = self.self_attn(
            hidden_states=hidden_states,
            attention_mask=attention_mask,
            causal_attention_mask=causal_attention_mask,
            output_attentions=output_attentions,
        )
        hidden_states = residual + hidden_states

        residual = hidden_states
        hidden_states = self.layer_norm2(hidden_states)
        hidden_states = self.mlp(hidden_states)
        hidden_states = residual + hidden_states

        outputs = (hidden_states,)

        if output_attentions:
            outputs += (attn_weights,)

        return outputs


# Copied from transformers.models.altclip.modeling_altclip.AltCLIPEncoder with AltCLIP->Kosmos2Vision
class Kosmos2VisionEncoder(nn.Module):
    """
    Transformer encoder consisting of `config.num_hidden_layers` self attention layers. Each layer is a
    [`Kosmos2VisionEncoderLayer`].

    Args:
        config: Kosmos2VisionConfig
    """

    def __init__(self, config: Kosmos2VisionConfig):
        super().__init__()
        self.config = config
        self.layers = nn.ModuleList([Kosmos2VisionEncoderLayer(config) for _ in range(config.num_hidden_layers)])
        self.gradient_checkpointing = False

    @can_return_tuple
    def forward(
        self,
        inputs_embeds,
        attention_mask: Optional[torch.Tensor] = None,
        causal_attention_mask: Optional[torch.Tensor] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        return_dict: Optional[bool] = None,
    ) -> Union[tuple, BaseModelOutput]:
        r"""
        Args:
            inputs_embeds (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`):
                Optionally, instead of passing `input_ids` you can choose to directly pass an embedded representation.
                This is useful if you want more control over how to convert `input_ids` indices into associated vectors
                than the model's internal embedding lookup matrix.
            attention_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
                Mask to avoid performing attention on padding token indices. Mask values selected in `[0, 1]`:

                - 1 for tokens that are **not masked**,
                - 0 for tokens that are **masked**.

                [What are attention masks?](../glossary#attention-mask)
            causal_attention_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
                Causal mask for the text model. Mask values selected in `[0, 1]`:

                - 1 for tokens that are **not masked**,
                - 0 for tokens that are **masked**.

                [What are attention masks?](../glossary#attention-mask)
            output_attentions (`bool`, *optional*):
                Whether or not to return the attentions tensors of all attention layers. See `attentions` under
                returned tensors for more detail.
            output_hidden_states (`bool`, *optional*):
                Whether or not to return the hidden states of all layers. See `hidden_states` under returned tensors
                for more detail.
            return_dict (`bool`, *optional*):
                Whether or not to return a [`~utils.ModelOutput`] instead of a plain tuple.
        """
        output_attentions = output_attentions if output_attentions is not None else self.config.output_attentions
        output_hidden_states = (
            output_hidden_states if output_hidden_states is not None else self.config.output_hidden_states
        )
        return_dict = return_dict if return_dict is not None else self.config.use_return_dict

        encoder_states = () if output_hidden_states else None
        all_attentions = () if output_attentions else None

        hidden_states = inputs_embeds
        for idx, encoder_layer in enumerate(self.layers):
            if output_hidden_states:
                encoder_states = encoder_states + (hidden_states,)
            layer_outputs = encoder_layer(
                hidden_states,
                attention_mask,
                causal_attention_mask,
                output_attentions=output_attentions,
            )

            hidden_states = layer_outputs[0]

            if output_attentions:
                all_attentions = all_attentions + (layer_outputs[1],)

        if output_hidden_states:
            encoder_states = encoder_states + (hidden_states,)

        return BaseModelOutput(
            last_hidden_state=hidden_states, hidden_states=encoder_states, attentions=all_attentions
        )


# Similar to `transformers.models.clip.modeling_clip.CLIPVisionTransformer` but without docstring for `forward`
class Kosmos2VisionTransformer(nn.Module):
    # Copied from transformers.models.altclip.modeling_altclip.AltCLIPVisionTransformer.__init__ with AltCLIPVision->Kosmos2Vision,ALTCLIP_VISION->KOSMOS2_VISION,AltCLIP->Kosmos2Vision
    def __init__(self, config: Kosmos2VisionConfig):
        super().__init__()
        self.config = config
        embed_dim = config.hidden_size

        self.embeddings = Kosmos2VisionEmbeddings(config)
        self.pre_layrnorm = nn.LayerNorm(embed_dim, eps=config.layer_norm_eps)
        self.encoder = Kosmos2VisionEncoder(config)
        self.post_layernorm = nn.LayerNorm(embed_dim, eps=config.layer_norm_eps)

    def forward(
        self,
        pixel_values: Optional[torch.FloatTensor] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        interpolate_pos_encoding: bool = False,
        return_dict: Optional[bool] = None,
    ) -> Union[tuple, BaseModelOutputWithPooling]:
        output_attentions = output_attentions if output_attentions is not None else self.config.output_attentions
        output_hidden_states = (
            output_hidden_states if output_hidden_states is not None else self.config.output_hidden_states
        )
        return_dict = return_dict if return_dict is not None else self.config.use_return_dict

        if pixel_values is None:
            raise ValueError("You have to specify pixel_values")

        hidden_states = self.embeddings(pixel_values, interpolate_pos_encoding=interpolate_pos_encoding)
        hidden_states = self.pre_layrnorm(hidden_states)

        encoder_outputs = self.encoder(
            inputs_embeds=hidden_states,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            return_dict=return_dict,
        )

        last_hidden_state = encoder_outputs[0]
        pooled_output = last_hidden_state[:, 0, :]
        pooled_output = self.post_layernorm(pooled_output)

        if not return_dict:
            return (last_hidden_state, pooled_output) + encoder_outputs[1:]

        return BaseModelOutputWithPooling(
            last_hidden_state=last_hidden_state,
            pooler_output=pooled_output,
            hidden_states=encoder_outputs.hidden_states,
            attentions=encoder_outputs.attentions,
        )


# Similar to `transformers.models.m2m_100.modeling_m2m_100.M2M100SinusoidalPositionalEmbedding` but allowing to pass `position_ids`
class Kosmos2TextSinusoidalPositionalEmbedding(nn.Module):
    """This module produces sinusoidal positional embeddings of any length."""

    # Copied from transformers.models.m2m_100.modeling_m2m_100.M2M100SinusoidalPositionalEmbedding.__init__
    def __init__(self, num_positions: int, embedding_dim: int, padding_idx: Optional[int] = None):
        super().__init__()
        self.offset = 2
        self.embedding_dim = embedding_dim
        self.padding_idx = padding_idx
        self.make_weights(num_positions + self.offset, embedding_dim, padding_idx)

    # Copied from transformers.models.m2m_100.modeling_m2m_100.M2M100SinusoidalPositionalEmbedding.make_weights
    def make_weights(self, num_embeddings: int, embedding_dim: int, padding_idx: Optional[int] = None):
        emb_weights = self.get_embedding(num_embeddings, embedding_dim, padding_idx)
        if hasattr(self, "weights"):
            # in forward put the weights on the correct dtype and device of the param
            emb_weights = emb_weights.to(dtype=self.weights.dtype, device=self.weights.device)

        self.register_buffer("weights", emb_weights, persistent=False)

    @staticmethod
    # Copied from transformers.models.m2m_100.modeling_m2m_100.M2M100SinusoidalPositionalEmbedding.get_embedding
    def get_embedding(num_embeddings: int, embedding_dim: int, padding_idx: Optional[int] = None):
        """
        Build sinusoidal embeddings.

        This matches the implementation in tensor2tensor, but differs slightly from the description in Section 3.5 of
        "Attention Is All You Need".
        """
        half_dim = embedding_dim // 2
        emb = math.log(10000) / (half_dim - 1)
        emb = torch.exp(torch.arange(half_dim, dtype=torch.int64).float() * -emb)
        emb = torch.arange(num_embeddings, dtype=torch.int64).float().unsqueeze(1) * emb.unsqueeze(0)
        emb = torch.cat([torch.sin(emb), torch.cos(emb)], dim=1).view(num_embeddings, -1)
        if embedding_dim % 2 == 1:
            # zero pad
            emb = torch.cat([emb, torch.zeros(num_embeddings, 1)], dim=1)
        if padding_idx is not None:
            emb[padding_idx, :] = 0

        return emb.to(torch.get_default_dtype())

    @torch.no_grad()
    def forward(
        self,
        input_ids: Optional[torch.Tensor] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        past_key_values_length: int = 0,
        position_ids: Optional[torch.Tensor] = None,
    ):
        if input_ids is not None:
            bsz, seq_len = input_ids.size()
            if position_ids is None:
                # Create the position ids from the input token ids. Any padded tokens remain padded.
                position_ids = create_position_ids_from_input_ids(
                    input_ids, self.padding_idx, past_key_values_length
                ).to(input_ids.device)
        else:
            bsz, seq_len = inputs_embeds.size()[:-1]
            if position_ids is None:
                position_ids = self.create_position_ids_from_inputs_embeds(inputs_embeds, past_key_values_length)

        # expand embeddings if needed
        max_pos = self.padding_idx + 1 + seq_len + past_key_values_length
        if max_pos > self.weights.size(0):
            self.make_weights(max_pos + self.offset, self.embedding_dim, self.padding_idx)

        return self.weights.index_select(0, position_ids.view(-1)).view(bsz, seq_len, self.weights.shape[-1]).detach()

    # Copied from transformers.models.m2m_100.modeling_m2m_100.M2M100SinusoidalPositionalEmbedding.create_position_ids_from_inputs_embeds
    def create_position_ids_from_inputs_embeds(self, inputs_embeds, past_key_values_length):
        """
        We are provided embeddings directly. We cannot infer which are padded so just generate sequential position ids.

        Args:
            inputs_embeds: torch.Tensor

        Returns: torch.Tensor
        """
        input_shape = inputs_embeds.size()[:-1]
        sequence_length = input_shape[1]

        position_ids = torch.arange(
            self.padding_idx + 1, sequence_length + self.padding_idx + 1, dtype=torch.long, device=inputs_embeds.device
        )
        return position_ids.unsqueeze(0).expand(input_shape).contiguous() + past_key_values_length


class KosmosTextAttention(nn.Module):
    """Multi-headed attention from 'Attention Is All You Need' paper"""

    # Similar to transformers.models.bart.modeling_bart.BartAttention.__init__ except an additional `inner_attn_ln`.
    def __init__(
        self,
        config,
        embed_dim: int,
        num_heads: int,
        dropout: float = 0.0,
        is_decoder: Optional[bool] = False,
        add_inner_attn_layernorm: Optional[bool] = False,
        bias: Optional[bool] = True,
        layer_idx: Optional[bool] = None,
    ):
        super().__init__()
        self.config = config
        self.embed_dim = embed_dim
        self.num_heads = num_heads
        self.dropout = dropout
        self.head_dim = embed_dim // num_heads

        if (self.head_dim * num_heads) != self.embed_dim:
            raise ValueError(
                f"embed_dim must be divisible by num_heads (got `embed_dim`: {self.embed_dim}"
                f" and `num_heads`: {num_heads})."
            )
        self.scaling = self.head_dim**-0.5
        self.is_decoder = is_decoder
        self.layer_idx = layer_idx

        self.k_proj = nn.Linear(embed_dim, embed_dim, bias=bias)
        self.v_proj = nn.Linear(embed_dim, embed_dim, bias=bias)
        self.q_proj = nn.Linear(embed_dim, embed_dim, bias=bias)
        self.out_proj = nn.Linear(embed_dim, embed_dim, bias=bias)

        # End opy
        self.inner_attn_ln = None
        if add_inner_attn_layernorm:
            self.inner_attn_ln = nn.LayerNorm(embed_dim, eps=config.layer_norm_eps)

    @deprecate_kwarg("past_key_value", new_name="past_key_values", version="4.58")
    def forward(
        self,
        hidden_states: torch.Tensor,
        encoder_hidden_states: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        attention_mask: Optional[torch.Tensor] = None,
        layer_head_mask: Optional[torch.Tensor] = None,
        output_attentions: bool = False,
        cache_position: Optional[torch.Tensor] = None,
        **kwargs,
    ) -> tuple[torch.Tensor, Optional[torch.Tensor], Optional[Cache]]:
        """Input shape: Batch x Time x Channel"""

        # if key_value_states are provided this layer is used as a cross-attention layer
        # for the decoder
        is_cross_attention = encoder_hidden_states is not None
        batch_size, seq_length = hidden_states.shape[:2]

        query_states = self.q_proj(hidden_states)
        query_states = query_states.view(batch_size, seq_length, self.num_heads, self.head_dim).transpose(1, 2)

        is_updated = False
        if past_key_values is not None:
            if isinstance(past_key_values, EncoderDecoderCache):
                is_updated = past_key_values.is_updated.get(self.layer_idx)
                if is_cross_attention:
                    # after the first generated id, we can subsequently re-use all key/value_states from cache
                    curr_past_key_value = past_key_values.cross_attention_cache
                else:
                    curr_past_key_value = past_key_values.self_attention_cache
            else:
                curr_past_key_value = past_key_values

        current_states = encoder_hidden_states if is_cross_attention else hidden_states
        if is_cross_attention and past_key_values is not None and is_updated:
            # reuse k,v, cross_attentions
            key_states = curr_past_key_value.layers[self.layer_idx].keys
            value_states = curr_past_key_value.layers[self.layer_idx].values
        else:
            key_states = self.k_proj(current_states)
            value_states = self.v_proj(current_states)
            key_states = key_states.view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)
            value_states = value_states.view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)

            if past_key_values is not None:
                # save all key/value_states to cache to be re-used for fast auto-regressive generation
                cache_position = cache_position if not is_cross_attention else None
                key_states, value_states = curr_past_key_value.update(
                    key_states, value_states, self.layer_idx, {"cache_position": cache_position}
                )
                # set flag that curr layer for cross-attn is already updated so we can re-use in subsequent calls
                if is_cross_attention and isinstance(past_key_values, EncoderDecoderCache):
                    past_key_values.is_updated[self.layer_idx] = True

        attention_interface: Callable = eager_attention_forward

        if self.config._attn_implementation != "eager":
            attention_interface = ALL_ATTENTION_FUNCTIONS[self.config._attn_implementation]

        attn_output, attn_weights = attention_interface(
            self,
            query_states,
            key_states,
            value_states,
            attention_mask,
            dropout=0.0 if not self.training else self.dropout,
            scaling=self.scaling,
            **kwargs,
        )

        attn_output = attn_output.reshape(batch_size, seq_length, -1).contiguous()
        if self.inner_attn_ln is not None:
            attn_output = self.inner_attn_ln(attn_output)

        attn_output = self.out_proj(attn_output)

        return attn_output, attn_weights


class Kosmos2TextFFN(nn.Module):
    def __init__(self, config: Kosmos2TextConfig):
        super().__init__()

        self.dropout = config.dropout
        self.activation_fn = ACT2FN[config.activation_function]
        self.activation_dropout = config.activation_dropout

        self.fc1 = nn.Linear(config.embed_dim, config.ffn_dim)
        self.fc2 = nn.Linear(config.ffn_dim, config.embed_dim)

        self.ffn_layernorm = nn.LayerNorm(config.ffn_dim, eps=config.layer_norm_eps)

    def forward(self, hidden_states):
        hidden_states = self.activation_fn(self.fc1(hidden_states))
        hidden_states = nn.functional.dropout(hidden_states, p=self.activation_dropout, training=self.training)
        hidden_states = self.ffn_layernorm(hidden_states)
        hidden_states = self.fc2(hidden_states)
        hidden_states = nn.functional.dropout(hidden_states, p=self.dropout, training=self.training)

        return hidden_states


class Kosmos2TextBlock(GradientCheckpointingLayer):
    def __init__(self, config: Kosmos2TextConfig, layer_idx=None):
        super().__init__()
        self.embed_dim = config.embed_dim

        self.self_attn = KosmosTextAttention(
            config,
            embed_dim=self.embed_dim,
            num_heads=config.attention_heads,
            dropout=config.attention_dropout,
            is_decoder=True,
            add_inner_attn_layernorm=True,
            layer_idx=layer_idx,
        )
        self.dropout = config.dropout
        self.self_attn_layer_norm = nn.LayerNorm(self.embed_dim, eps=config.layer_norm_eps)

        if config.add_cross_attention:
            self.encoder_attn = KosmosTextAttention(
                config,
                embed_dim=self.embed_dim,
                num_heads=config.attention_heads,
                dropout=config.attention_dropout,
                is_decoder=True,
                add_inner_attn_layernorm=False,
                layer_idx=layer_idx,
            )
            self.encoder_attn_layer_norm = nn.LayerNorm(self.embed_dim, eps=config.layer_norm_eps)

        self.ffn = Kosmos2TextFFN(config)
        self.final_layer_norm = nn.LayerNorm(self.embed_dim, eps=config.layer_norm_eps)

    @deprecate_kwarg("past_key_value", new_name="past_key_values", version="4.58")
    def forward(
        self,
        hidden_states: torch.Tensor,
        attention_mask: Optional[torch.Tensor] = None,
        encoder_hidden_states: Optional[torch.Tensor] = None,
        encoder_attention_mask: Optional[torch.Tensor] = None,
        layer_head_mask: Optional[torch.Tensor] = None,
        cross_attn_layer_head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        output_attentions: Optional[bool] = False,
        use_cache: Optional[bool] = True,
        cache_position: Optional[torch.Tensor] = None,
        **kwargs,
    ) -> tuple[torch.FloatTensor, Optional[tuple[torch.FloatTensor, torch.FloatTensor]]]:
        residual = hidden_states
        hidden_states = self.self_attn_layer_norm(hidden_states)

        hidden_states, self_attn_weights = self.self_attn(
            hidden_states=hidden_states,
            past_key_values=past_key_values,
            attention_mask=attention_mask,
            layer_head_mask=layer_head_mask,
            output_attentions=output_attentions,
            cache_position=cache_position,
            **kwargs,
        )
        hidden_states = nn.functional.dropout(hidden_states, p=self.dropout, training=self.training)
        hidden_states = residual + hidden_states

        # Cross-Attention Block
        cross_attn_weights = None
        if encoder_hidden_states is not None:
            if not hasattr(self, "encoder_attn"):
                raise ValueError(
                    f"If `encoder_hidden_states` are passed, {self} has to be instantiated with cross-attention layers"
                    " by setting `config.add_cross_attention=True`"
                )

            residual = hidden_states
            hidden_states = self.encoder_attn_layer_norm(hidden_states)

            hidden_states, cross_attn_weights = self.encoder_attn(
                hidden_states=hidden_states,
                encoder_hidden_states=encoder_hidden_states,
                attention_mask=encoder_attention_mask,
                layer_head_mask=cross_attn_layer_head_mask,
                past_key_values=past_key_values,
                output_attentions=output_attentions,
                cache_position=cache_position,
                **kwargs,
            )
            hidden_states = nn.functional.dropout(hidden_states, p=self.dropout, training=self.training)
            hidden_states = residual + hidden_states

        # Fully Connected
        residual = hidden_states

        hidden_states = self.final_layer_norm(hidden_states)

        # FFN
        hidden_states = self.ffn(hidden_states)
        hidden_states = residual + hidden_states

        outputs = (hidden_states,)

        if output_attentions:
            outputs += (self_attn_weights, cross_attn_weights)
        return outputs


class Kosmos2TextTransformer(nn.Module):
    """
    Transformer decoder consisting of `config.layers` layers. Each layer is a [`Kosmos2TextBlock`].

    Args:
        config: Kosmos2TextConfig
    """

    def __init__(self, config: Kosmos2TextConfig):
        super().__init__()
        self.config = config
        self.dropout = config.dropout
        self.layerdrop = config.layerdrop

        self.embed_scale = math.sqrt(config.embed_dim) if config.scale_embedding else 1.0
        self.embed_tokens = nn.Embedding(config.vocab_size, config.embed_dim, padding_idx=config.pad_token_id)

        self.embed_positions = Kosmos2TextSinusoidalPositionalEmbedding(
            num_positions=config.max_position_embeddings,
            embedding_dim=config.embed_dim,
            padding_idx=config.pad_token_id,
        )

        self.layers = nn.ModuleList([Kosmos2TextBlock(config, layer_idx=i) for i in range(config.layers)])
        self.layer_norm = nn.LayerNorm(config.embed_dim, config.layer_norm_eps)

        self.gradient_checkpointing = False

    def _prepare_decoder_attention_mask(self, attention_mask, input_shape, inputs_embeds, past_key_values_length):
        # create causal mask
        # [bsz, seq_len] -> [bsz, 1, tgt_seq_len, src_seq_len]
        combined_attention_mask = None
        if input_shape[-1] > 1:
            combined_attention_mask = _make_causal_mask(
                input_shape,
                inputs_embeds.dtype,
                device=inputs_embeds.device,
                past_key_values_length=past_key_values_length,
            )

        if attention_mask is not None:
            # [bsz, seq_len] -> [bsz, 1, tgt_seq_len, src_seq_len]
            expanded_attn_mask = _expand_mask(attention_mask, inputs_embeds.dtype, tgt_len=input_shape[-1]).to(
                inputs_embeds.device
            )
            combined_attention_mask = (
                expanded_attn_mask if combined_attention_mask is None else expanded_attn_mask + combined_attention_mask
            )

        return combined_attention_mask

    def forward_embedding(
        self,
        input_ids,
        inputs_embeds: Optional[torch.Tensor] = None,
        image_embeds: Optional[torch.Tensor] = None,
        img_input_mask: Optional[torch.Tensor] = None,
        past_key_values_length: int = 0,
        position_ids: Optional[torch.Tensor] = None,
    ):
        # The argument `inputs_embeds` should be the one without being multiplied by `self.embed_scale`.
        if inputs_embeds is None:
            inputs_embeds = self.embed_tokens(input_ids)

        if image_embeds is not None:
            inputs_embeds[img_input_mask.to(dtype=torch.bool)] = image_embeds.to(inputs_embeds.device).view(
                -1, image_embeds.size(-1)
            )

        inputs_embeds = inputs_embeds * self.embed_scale

        # embed positions
        positions = self.embed_positions(
            input_ids=input_ids,
            inputs_embeds=inputs_embeds,
            past_key_values_length=past_key_values_length,
            position_ids=position_ids,
        )
        positions = positions.to(inputs_embeds.device)

        hidden_states = inputs_embeds + positions

        hidden_states = nn.functional.dropout(hidden_states, p=self.dropout, training=self.training)

        return hidden_states

    def forward(
        self,
        input_ids: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        image_embeds: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        encoder_hidden_states: Optional[torch.Tensor] = None,
        encoder_attention_mask: Optional[torch.Tensor] = None,
        head_mask: Optional[torch.Tensor] = None,
        cross_attn_head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        position_ids: Optional[torch.Tensor] = None,
        use_cache: Optional[bool] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        return_dict: Optional[bool] = None,
        cache_position: Optional[torch.Tensor] = None,
        **kwargs: Unpack[FlashAttentionKwargs],
    ) -> Union[tuple, BaseModelOutputWithPastAndCrossAttentions]:
        output_attentions = output_attentions if output_attentions is not None else self.config.output_attentions
        output_hidden_states = (
            output_hidden_states if output_hidden_states is not None else self.config.output_hidden_states
        )
        use_cache = use_cache if use_cache is not None else self.config.use_cache

        if input_ids is not None and inputs_embeds is not None:
            raise ValueError("You cannot specify both input_ids and inputs_embeds at the same time")
        elif input_ids is not None:
            input_shape = input_ids.shape
            input_ids = input_ids.view(-1, input_shape[-1])
        elif inputs_embeds is not None:
            input_shape = inputs_embeds.size()[:-1]
        else:
            raise ValueError("You have to specify either input_ids or inputs_embeds")

        if self.gradient_checkpointing and self.training:
            if use_cache:
                logger.warning_once(
                    "`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`..."
                )
                use_cache = False

        if use_cache and past_key_values is None:
            past_key_values = (
                EncoderDecoderCache(DynamicCache(config=self.config), DynamicCache(config=self.config))
                if encoder_hidden_states is not None
                else DynamicCache(config=self.config)
            )
        if use_cache and isinstance(past_key_values, tuple):
            logger.warning_once(
                "Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.58.0. "
                "You should pass an instance of `EncoderDecoderCache` instead, e.g. "
                "`past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`."
            )
            past_key_values = EncoderDecoderCache.from_legacy_cache(past_key_values)

        past_key_values_length = past_key_values.get_seq_length() if past_key_values is not None else 0

        # We don't need img info. when `past_key_values_length` > 0
        if past_key_values_length > 0:
            image_embeds = None
            image_embeds_position_mask = None

        hidden_states = self.forward_embedding(
            input_ids=input_ids,
            inputs_embeds=inputs_embeds,
            image_embeds=image_embeds,
            img_input_mask=image_embeds_position_mask,
            past_key_values_length=past_key_values_length,
            position_ids=position_ids,
        )

        attention_mask = self._prepare_decoder_attention_mask(
            attention_mask, input_shape, hidden_states, past_key_values_length
        )

        # expand encoder attention mask
        if encoder_hidden_states is not None and encoder_attention_mask is not None:
            # [bsz, seq_len] -> [bsz, 1, tgt_seq_len, src_seq_len]
            encoder_attention_mask = _expand_mask(encoder_attention_mask, inputs_embeds.dtype, tgt_len=input_shape[-1])

        hidden_states = nn.functional.dropout(hidden_states, p=self.dropout, training=self.training)

        # decoder layers
        all_hidden_states = () if output_hidden_states else None
        all_self_attns = () if output_attentions else None
        all_cross_attentions = () if (output_attentions and encoder_hidden_states is not None) else None

        # check if head_mask/cross_attn_head_mask has a correct number of layers specified if desired
        for attn_mask, mask_name in zip([head_mask, cross_attn_head_mask], ["head_mask", "cross_attn_head_mask"]):
            if attn_mask is not None:
                if attn_mask.size()[0] != (len(self.layers)):
                    raise ValueError(
                        f"The `{mask_name}` should be specified for {len(self.layers)} layers, but it is for"
                        f" {head_mask.size()[0]}."
                    )

        for idx, decoder_layer in enumerate(self.layers):
            # add LayerDrop (see https://huggingface.co/papers/1909.11556 for description)
            if output_hidden_states:
                all_hidden_states += (hidden_states,)
            if self.training:
                dropout_probability = torch.rand([])
                if dropout_probability < self.layerdrop:
                    continue

            layer_outputs = decoder_layer(
                hidden_states,
                attention_mask,
                encoder_hidden_states,
                encoder_attention_mask=encoder_attention_mask,
                layer_head_mask=(head_mask[idx] if head_mask is not None else None),
                cross_attn_layer_head_mask=(cross_attn_head_mask[idx] if cross_attn_head_mask is not None else None),
                past_key_values=past_key_values,
                output_attentions=output_attentions,
                use_cache=use_cache,
                cache_position=cache_position,
                **kwargs,
            )
            hidden_states = layer_outputs[0]

            if output_attentions:
                all_self_attns += (layer_outputs[1],)

                if encoder_hidden_states is not None:
                    all_cross_attentions += (layer_outputs[2],)

        # add final layer norm
        hidden_states = self.layer_norm(hidden_states)

        # add hidden states from the last decoder layer
        if output_hidden_states:
            all_hidden_states += (hidden_states,)

        return BaseModelOutputWithPastAndCrossAttentions(
            last_hidden_state=hidden_states,
            past_key_values=past_key_values,
            hidden_states=all_hidden_states,
            attentions=all_self_attns,
            cross_attentions=all_cross_attentions,
        )


@auto_docstring
class Kosmos2PreTrainedModel(PreTrainedModel):
    config: Kosmos2Config
    supports_gradient_checkpointing = True
    _no_split_modules = ["Kosmos2VisionEncoderLayer", "Kosmos2TextBlock"]
    _supports_attention_backend = True
    _supports_flash_attn = True
    _supports_sdpa = True

    def _init_weights(self, module: nn.Module):
        """Initialize the weights"""
        if isinstance(self, Kosmos2VisionModel):
            factor = self.config.initializer_factor
        elif isinstance(self, (Kosmos2Model, Kosmos2ForConditionalGeneration)):
            factor = self.config.vision_config.initializer_factor

        if isinstance(self, (Kosmos2TextModel, Kosmos2TextForCausalLM)):
            std = self.config.init_std
        elif isinstance(self, (Kosmos2Model, Kosmos2ForConditionalGeneration)):
            std = self.config.text_config.init_std

        if isinstance(module, Kosmos2VisionEmbeddings):
            nn.init.normal_(module.class_embedding, mean=0.0, std=module.embed_dim**-0.5 * factor)
            nn.init.normal_(module.patch_embedding.weight, std=module.config.initializer_range * factor)
            nn.init.normal_(module.position_embedding.weight, std=module.config.initializer_range * factor)
        elif isinstance(module, Kosmos2VisionAttention):
            in_proj_std = (module.embed_dim**-0.5) * ((2 * module.config.num_hidden_layers) ** -0.5) * factor
            out_proj_std = (module.embed_dim**-0.5) * factor
            nn.init.normal_(module.q_proj.weight, std=in_proj_std)
            nn.init.normal_(module.k_proj.weight, std=in_proj_std)
            nn.init.normal_(module.v_proj.weight, std=in_proj_std)
            nn.init.normal_(module.out_proj.weight, std=out_proj_std)
        elif isinstance(module, Kosmos2VisionMLP):
            in_proj_std = (module.config.hidden_size**-0.5) * ((2 * module.config.num_hidden_layers) ** -0.5) * factor
            fc_std = (2 * module.config.hidden_size) ** -0.5 * factor
            nn.init.normal_(module.fc1.weight, std=fc_std)
            nn.init.normal_(module.fc2.weight, std=in_proj_std)
        elif isinstance(module, KosmosTextAttention):
            nn.init.normal_(module.q_proj.weight, std=std)
            nn.init.normal_(module.k_proj.weight, std=std)
            nn.init.normal_(module.v_proj.weight, std=std)
            nn.init.normal_(module.out_proj.weight, std=std)
        elif isinstance(module, Kosmos2TextFFN):
            nn.init.normal_(module.fc1.weight, std=std)
            nn.init.normal_(module.fc2.weight, std=std)
        elif isinstance(module, Kosmos2TextForCausalLM):
            nn.init.normal_(module.lm_head.weight, std=std)
        elif isinstance(module, Kosmos2ImageToTextProjection):
            nn.init.normal_(module.dense.weight, std=std)
            nn.init.normal_(module.latent_query)
        elif isinstance(module, Kosmos2TextTransformer):
            module.embed_tokens.weight.data.normal_(mean=0.0, std=std)
            if module.embed_tokens.padding_idx is not None:
                module.embed_tokens.weight.data[module.embed_tokens.padding_idx].zero_()
        elif isinstance(module, nn.LayerNorm):
            module.weight.data.fill_(1.0)
            module.bias.data.zero_()

        if isinstance(module, nn.Linear) and module.bias is not None:
            module.bias.data.zero_()


class Kosmos2VisionModel(Kosmos2PreTrainedModel):
    config: Kosmos2VisionConfig
    main_input_name = "pixel_values"

    # Copied from transformers.models.clip.modeling_clip.CLIPVisionModel.__init__ with CLIP_VISION->KOSMOS2_VISION,CLIP->Kosmos2,self.vision_model->self.model
    def __init__(self, config: Kosmos2VisionConfig):
        super().__init__(config)
        self.model = Kosmos2VisionTransformer(config)
        # Initialize weights and apply final processing
        self.post_init()

    # Copied from transformers.models.clip.modeling_clip.CLIPVisionModel.get_input_embeddings with CLIP_VISION->KOSMOS2_VISION,CLIP->Kosmos2,self.vision_model->self.model
    def get_input_embeddings(self) -> nn.Module:
        return self.model.embeddings.patch_embedding

    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.FloatTensor] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        interpolate_pos_encoding: bool = False,
        return_dict: Optional[bool] = None,
    ) -> Union[tuple, BaseModelOutputWithPooling]:
        return self.model(
            pixel_values=pixel_values,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            interpolate_pos_encoding=interpolate_pos_encoding,
            return_dict=return_dict,
        )


class Kosmos2TextModel(Kosmos2PreTrainedModel):
    config: Kosmos2TextConfig

    def __init__(self, config: Kosmos2TextConfig):
        super().__init__(config)
        self.model = Kosmos2TextTransformer(config)
        # Initialize weights and apply final processing
        self.post_init()

    def get_input_embeddings(self) -> nn.Module:
        return self.model.embed_tokens

    @can_return_tuple
    @auto_docstring
    def forward(
        self,
        input_ids: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        image_embeds: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        encoder_hidden_states: Optional[torch.Tensor] = None,
        encoder_attention_mask: Optional[torch.Tensor] = None,
        head_mask: Optional[torch.Tensor] = None,
        cross_attn_head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        position_ids: Optional[torch.Tensor] = None,
        use_cache: Optional[bool] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        return_dict: Optional[bool] = None,
        cache_position: Optional[torch.Tensor] = None,
        **kwargs: Unpack[FlashAttentionKwargs],
    ) -> Union[tuple, BaseModelOutputWithPastAndCrossAttentions]:
        r"""
        image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
            Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.
        image_embeds_position_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
            Mask to indicate the location in a sequence to insert the image features . Mask values selected in `[0,
            1]`:

            - 1 for places where to put the image features,
            - 0 for places that are not for image features (i.e. for text tokens).
        cross_attn_head_mask (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*):
            Mask to nullify selected heads of the cross-attention modules. Mask values selected in `[0, 1]`:

            - 1 indicates the head is **not masked**,
            - 0 indicates the head is **masked**.
        """
        return self.model(
            input_ids=input_ids,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            encoder_hidden_states=encoder_hidden_states,
            encoder_attention_mask=encoder_attention_mask,
            head_mask=head_mask,
            cross_attn_head_mask=cross_attn_head_mask,
            past_key_values=past_key_values,
            inputs_embeds=inputs_embeds,
            position_ids=position_ids,
            use_cache=use_cache,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            return_dict=return_dict,
            cache_position=cache_position,
            **kwargs,
        )


@auto_docstring(
    custom_intro="""
    The text model from KOSMOS-2 with a language modeling head on top (linear layer with weights tied to the input
    embeddings).
    """
)
class Kosmos2TextForCausalLM(Kosmos2PreTrainedModel, GenerationMixin):
    config: Kosmos2TextConfig
    _tied_weights_keys = ["lm_head.weight"]

    def __init__(self, config: Kosmos2TextConfig):
        super().__init__(config)

        self.model = Kosmos2TextTransformer(config)
        self.lm_head = nn.Linear(in_features=config.embed_dim, out_features=config.vocab_size, bias=False)

        # Initialize weights and apply final processing
        self.post_init()

    def get_input_embeddings(self) -> nn.Module:
        return self.model.embed_tokens

    def get_output_embeddings(self) -> nn.Module:
        return self.lm_head

    @can_return_tuple
    @auto_docstring
    def forward(
        self,
        input_ids: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        image_embeds: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        encoder_hidden_states: Optional[torch.Tensor] = None,
        encoder_attention_mask: Optional[torch.Tensor] = None,
        head_mask: Optional[torch.Tensor] = None,
        cross_attn_head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        position_ids: Optional[torch.Tensor] = None,
        labels: Optional[torch.LongTensor] = None,
        use_cache: Optional[bool] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        return_dict: Optional[bool] = None,
        cache_position: Optional[torch.Tensor] = None,
        **kwargs: Unpack[TransformersKwargs],
    ) -> Union[tuple, CausalLMOutputWithCrossAttentions]:
        r"""
        image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
            Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.
        image_embeds_position_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
            Mask to indicate the location in a sequence to insert the image features . Mask values selected in `[0,
            1]`:

            - 1 for places where to put the image features,
            - 0 for places that are not for image features (i.e. for text tokens).
        cross_attn_head_mask (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*):
            Mask to nullify selected heads of the cross-attention modules. Mask values selected in `[0, 1]`:

            - 1 indicates the head is **not masked**,
            - 0 indicates the head is **masked**.
        labels (`torch.LongTensor` of shape `(batch_size, sequence_length)`, *optional*):
            Labels for computing the left-to-right language modeling loss (next word prediction). Indices should be in
            `[-100, 0, ..., config.vocab_size]` (see `input_ids` docstring) Tokens with indices set to `-100` are
            ignored (masked), the loss is only computed for the tokens with labels in `[0, ..., config.vocab_size]`
        """
        return_dict = return_dict if return_dict is not None else self.config.use_return_dict

        if labels is not None:
            if use_cache:
                logger.warning("The `use_cache` argument is changed to `False` since `labels` is provided.")
            use_cache = False

        outputs = self.model(
            input_ids=input_ids,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            encoder_hidden_states=encoder_hidden_states,
            encoder_attention_mask=encoder_attention_mask,
            head_mask=head_mask,
            cross_attn_head_mask=cross_attn_head_mask,
            past_key_values=past_key_values,
            inputs_embeds=inputs_embeds,
            position_ids=position_ids,
            use_cache=use_cache,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            return_dict=True,
            cache_position=cache_position,
            **kwargs,
        )
        lm_logits = self.lm_head(outputs[0])

        loss = None
        if labels is not None:
            loss = self.loss_function(logits=lm_logits, labels=labels, vocab_size=self.config.vocab_size, **kwargs)

        return CausalLMOutputWithCrossAttentions(
            loss=loss,
            logits=lm_logits,
            past_key_values=outputs.past_key_values,
            hidden_states=outputs.hidden_states,
            attentions=outputs.attentions,
            cross_attentions=outputs.cross_attentions,
        )

    def prepare_inputs_for_generation(
        self,
        input_ids,
        image_embeds=None,
        image_embeds_position_mask=None,
        past_key_values=None,
        attention_mask=None,
        inputs_embeds=None,
        use_cache=None,
        cache_position=None,
        **model_kwargs,
    ):
        # Overwritten -- in specific circumstances we don't want to forward image inputs to the model

        # If we're in cached decoding stage, pixel values should be None because input ids do not contain special image token anymore
        if cache_position[0] != 0:
            image_embeds = None
            image_embeds_position_mask = None

        # appending `False` to `image_embeds_position_mask` (because `input_ids` grows during generation)
        elif image_embeds_position_mask is not None:
            batch_size, seq_len = inputs_embeds.size()[:-1] if inputs_embeds is not None else input_ids.size()
            mask_len = image_embeds_position_mask.size()[-1]
            image_embeds_position_mask = torch.cat(
                (
                    image_embeds_position_mask,
                    torch.zeros(size=(batch_size, seq_len - mask_len), dtype=torch.bool, device=input_ids.device),
                ),
                dim=1,
            )

        model_inputs = super().prepare_inputs_for_generation(
            input_ids,
            past_key_values=past_key_values,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            inputs_embeds=inputs_embeds,
            use_cache=use_cache,
            cache_position=cache_position,
            **model_kwargs,
        )
        # Kosmos2 has offset for position ids, so we need to create them correctly in PositionEmbedding layer
        model_inputs.pop("position_ids", None)

        return model_inputs


class Kosmos2ImageToTextProjection(nn.Module):
    """The layer that transforms the image model's output to part of the text model's input (namely, image features)"""

    def __init__(self, config: Kosmos2Config):
        super().__init__()
        self.dense = nn.Linear(config.vision_config.hidden_size, config.text_config.embed_dim)
        self.latent_query = nn.Parameter(torch.randn(config.latent_query_num, config.text_config.embed_dim))

        self.x_attn = KosmosTextAttention(
            config.text_config,
            config.text_config.embed_dim,
            config.text_config.attention_heads,
            dropout=config.text_config.attention_dropout,
            is_decoder=False,
            add_inner_attn_layernorm=False,
        )

    def forward(self, features):
        hidden_states = self.dense(features)

        # shape = [batch, latent_query_num, h_dim]
        latent_query = self.latent_query.unsqueeze(0).expand(hidden_states.size(0), -1, -1)
        key_value_states = torch.cat([hidden_states, latent_query], dim=1)

        hidden_states, attn_weights = self.x_attn(
            hidden_states=latent_query,
            encoder_hidden_states=key_value_states,
            past_key_values=None,
            attention_mask=None,
            output_attentions=None,
        )

        return hidden_states, attn_weights


@auto_docstring(
    custom_intro="""
    KOSMOS-2 Model for generating text and image features. The model consists of a vision encoder and a language model.
    """
)
class Kosmos2Model(Kosmos2PreTrainedModel):
    config: Kosmos2Config
    main_input_name = "pixel_values"

    def __init__(self, config: Kosmos2Config):
        super().__init__(config)

        self.text_model = Kosmos2TextModel(config.text_config)
        self.vision_model = Kosmos2VisionModel(config.vision_config)
        self.image_to_text_projection = Kosmos2ImageToTextProjection(config)

        # Initialize weights and apply final processing
        self.post_init()

    def get_input_embeddings(self) -> nn.Module:
        return self.text_model.model.embed_tokens

    def set_input_embeddings(self, value):
        self.text_model.model.embed_tokens = value

    def get_image_features(
        self,
        pixel_values: torch.FloatTensor,
        return_attentions: Optional[bool] = False,
        interpolate_pos_encoding: Optional[bool] = False,
    ):
        """
        Encodes images into continuous embeddings that can be forwarded to the language model.

        Args:
            pixel_values (`torch.FloatTensor` of shape `(batch_size, num_channels, image_size, image_size)`):
                The tensors corresponding to the input images.
            return_attentions (`bool`, *optional*, defaults to `False`):
                Whether to return `projection_attentions` or not.
            interpolate_pos_encoding (`bool`, *optional*, defaults to `False`):
                Whether to interpolate positional embeddings or not.
        """
        vision_model_output = self.vision_model(
            pixel_values=pixel_values,
            interpolate_pos_encoding=interpolate_pos_encoding,
        )
        # The whole `last_hidden_state` through `post_layernorm` instead of just `pooled_output`.
        image_embeds = self.vision_model.model.post_layernorm(vision_model_output[0])
        # normalized features
        image_embeds = nn.functional.normalize(image_embeds, dim=-1)
        image_embeds, projection_attentions = self.image_to_text_projection(image_embeds)

        if return_attentions:
            return image_embeds, projection_attentions
        return image_embeds

    @can_return_tuple
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.Tensor] = None,
        input_ids: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        image_embeds: Optional[torch.Tensor] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        position_ids: Optional[torch.Tensor] = None,
        use_cache: Optional[bool] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        interpolate_pos_encoding: bool = False,
        return_dict: Optional[bool] = None,
        **kwargs: Unpack[FlashAttentionKwargs],
    ) -> Union[tuple, Kosmos2ModelOutput]:
        r"""
        image_embeds_position_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
            Mask to indicate the location in a sequence to insert the image features . Mask values selected in `[0,
            1]`:

            - 1 for places where to put the image features,
            - 0 for places that are not for image features (i.e. for text tokens).
        image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
            Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.

        Examples:

        ```python
        >>> from PIL import Image
        >>> import requests
        >>> from transformers import AutoProcessor, Kosmos2Model

        >>> model = Kosmos2Model.from_pretrained("microsoft/kosmos-2-patch14-224")
        >>> processor = AutoProcessor.from_pretrained("microsoft/kosmos-2-patch14-224")

        >>> url = "https://huggingface.co/microsoft/kosmos-2-patch14-224/resolve/main/snowman.jpg"
        >>> image = Image.open(requests.get(url, stream=True).raw)

        >>> text = (
        ...     "<grounding> An image of<phrase> a snowman</phrase><object><patch_index_0044><patch_index_0863>"
        ...     "</object> warming himself by<phrase> a fire</phrase><object><patch_index_0005><patch_index_0911>"
        ...     "</object>"
        ... )

        >>> inputs = processor(text=text, images=image, return_tensors="pt", add_eos_token=True)

        >>> last_hidden_state = model(
        ...     pixel_values=inputs["pixel_values"],
        ...     input_ids=inputs["input_ids"],
        ...     attention_mask=inputs["attention_mask"],
        ...     image_embeds_position_mask=inputs["image_embeds_position_mask"],
        ... ).last_hidden_state
        >>> list(last_hidden_state.shape)
        [1, 91, 2048]
        ```"""
        output_attentions = output_attentions if output_attentions is not None else self.config.output_attentions
        output_hidden_states = (
            output_hidden_states if output_hidden_states is not None else self.config.output_hidden_states
        )
        return_dict = return_dict if return_dict is not None else self.config.use_return_dict

        vision_model_output = None
        projection_attentions = None
        if image_embeds is None:
            if pixel_values is None:
                raise ValueError("You have to specify either `pixel_values` or `image_embeds`.")
            image_embeds, projection_attentions = self.get_image_features(
                pixel_values, return_attentions=True, interpolate_pos_encoding=interpolate_pos_encoding
            )

        outputs = self.text_model(
            input_ids=input_ids,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            head_mask=head_mask,
            past_key_values=past_key_values,
            inputs_embeds=inputs_embeds,
            position_ids=position_ids,
            use_cache=use_cache,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            return_dict=True,
            **kwargs,
        )

        return Kosmos2ModelOutput(
            last_hidden_state=outputs.last_hidden_state,
            past_key_values=outputs.past_key_values,
            hidden_states=outputs.hidden_states,
            attentions=outputs.attentions,
            image_embeds=image_embeds,
            projection_attentions=projection_attentions,
            vision_model_output=vision_model_output,
        )


@auto_docstring(
    custom_intro="""
    KOSMOS-2 Model for generating text and bounding boxes given an image. The model consists of a vision encoder and a
    language model.
    """
)
class Kosmos2ForConditionalGeneration(Kosmos2PreTrainedModel, GenerationMixin):
    config: Kosmos2Config
    main_input_name = "pixel_values"
    _tied_weights_keys = ["text_model.lm_head.weight"]

    def __init__(self, config: Kosmos2Config):
        super().__init__(config)

        self.text_model = Kosmos2TextForCausalLM(config.text_config)
        self.vision_model = Kosmos2VisionModel(config.vision_config)

        self.image_to_text_projection = Kosmos2ImageToTextProjection(config)

        # Initialize weights and apply final processing
        self.post_init()

    def get_input_embeddings(self) -> nn.Module:
        return self.text_model.model.embed_tokens

    def set_input_embeddings(self, value):
        self.text_model.model.embed_tokens = value

    def get_output_embeddings(self) -> nn.Module:
        return self.text_model.get_output_embeddings()

    def set_output_embeddings(self, new_embeddings):
        self.text_model.set_output_embeddings(new_embeddings)

    @can_return_tuple
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.Tensor] = None,
        input_ids: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        head_mask: Optional[torch.Tensor] = None,
        past_key_values: Optional[Cache] = None,
        image_embeds: Optional[torch.Tensor] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        position_ids: Optional[torch.Tensor] = None,
        labels: Optional[torch.LongTensor] = None,
        use_cache: Optional[bool] = None,
        output_attentions: Optional[bool] = None,
        output_hidden_states: Optional[bool] = None,
        **kwargs: Unpack[TransformersKwargs],
    ) -> Union[tuple, Kosmos2ForConditionalGenerationModelOutput]:
        r"""
        image_embeds_position_mask (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*):
            Mask to indicate the location in a sequence to insert the image features . Mask values selected in `[0,
            1]`:

            - 1 for places where to put the image features,
            - 0 for places that are not for image features (i.e. for text tokens).
        image_embeds (`torch.FloatTensor` of shape `(batch_size, latent_query_num, hidden_size)`, *optional*):
            Sequence of hidden-states at the output of `Kosmos2ImageToTextProjection`.
        labels (`torch.LongTensor` of shape `(batch_size, sequence_length)`, *optional*):
            Labels for computing the left-to-right language modeling loss (next word prediction). Indices should be in
            `[-100, 0, ..., config.vocab_size]` (see `input_ids` docstring) Tokens with indices set to `-100` are
            ignored (masked), the loss is only computed for the tokens with labels in `[0, ..., config.vocab_size]`

        Examples:

        ```python
        >>> from PIL import Image
        >>> import requests
        >>> from transformers import AutoProcessor, Kosmos2ForConditionalGeneration

        >>> model = Kosmos2ForConditionalGeneration.from_pretrained("microsoft/kosmos-2-patch14-224")
        >>> processor = AutoProcessor.from_pretrained("microsoft/kosmos-2-patch14-224")

        >>> url = "https://huggingface.co/microsoft/kosmos-2-patch14-224/resolve/main/snowman.jpg"
        >>> image = Image.open(requests.get(url, stream=True).raw)

        >>> prompt = "<grounding> An image of"

        >>> inputs = processor(text=prompt, images=image, return_tensors="pt")

        >>> generated_ids = model.generate(
        ...     pixel_values=inputs["pixel_values"],
        ...     input_ids=inputs["input_ids"],
        ...     attention_mask=inputs["attention_mask"],
        ...     image_embeds=None,
        ...     image_embeds_position_mask=inputs["image_embeds_position_mask"],
        ...     use_cache=True,
        ...     max_new_tokens=64,
        ... )
        >>> generated_text = processor.batch_decode(generated_ids, skip_special_tokens=True)[0]
        >>> processed_text = processor.post_process_generation(generated_text, cleanup_and_extract=False)
        >>> processed_text
        '<grounding> An image of<phrase> a snowman</phrase><object><patch_index_0044><patch_index_0863></object> warming himself by<phrase> a fire</phrase><object><patch_index_0005><patch_index_0911></object>.'

        >>> caption, entities = processor.post_process_generation(generated_text)
        >>> caption
        'An image of a snowman warming himself by a fire.'

        >>> entities
        [('a snowman', (12, 21), [(0.390625, 0.046875, 0.984375, 0.828125)]), ('a fire', (41, 47), [(0.171875, 0.015625, 0.484375, 0.890625)])]
        ```"""
        output_attentions = output_attentions if output_attentions is not None else self.config.output_attentions
        output_hidden_states = (
            output_hidden_states if output_hidden_states is not None else self.config.output_hidden_states
        )

        vision_model_output = None
        projection_attentions = None
        if image_embeds is None:
            if pixel_values is None:
                raise ValueError("You have to specify either `pixel_values` or `image_embeds`.")

            vision_model_output = self.vision_model(
                pixel_values=pixel_values,
                output_attentions=output_attentions,
                output_hidden_states=output_hidden_states,
            )
            # The whole `last_hidden_state` through `post_layernorm` instead of just `pooled_output`.
            image_embeds = self.vision_model.model.post_layernorm(vision_model_output[0])
            # normalized features
            image_embeds = nn.functional.normalize(image_embeds, dim=-1)
            image_embeds, projection_attentions = self.image_to_text_projection(image_embeds)

        lm_outputs = self.text_model(
            input_ids=input_ids,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            head_mask=head_mask,
            past_key_values=past_key_values,
            inputs_embeds=inputs_embeds,
            position_ids=position_ids,
            labels=labels,
            use_cache=use_cache,
            output_attentions=output_attentions,
            output_hidden_states=output_hidden_states,
            return_dict=True,
            **kwargs,
        )

        return Kosmos2ForConditionalGenerationModelOutput(
            loss=lm_outputs.loss,
            logits=lm_outputs.logits,
            past_key_values=lm_outputs.past_key_values,
            hidden_states=lm_outputs.hidden_states,
            attentions=lm_outputs.attentions,
            image_embeds=image_embeds,
            projection_attentions=projection_attentions,
            vision_model_output=vision_model_output,
        )

    @torch.no_grad()
    def generate(
        self,
        pixel_values: Optional[torch.Tensor] = None,
        image_embeds_position_mask: Optional[torch.Tensor] = None,
        input_ids: Optional[torch.Tensor] = None,
        attention_mask: Optional[torch.Tensor] = None,
        image_embeds: Optional[torch.Tensor] = None,
        inputs_embeds: Optional[torch.Tensor] = None,
        **kwargs,
    ):
        # in order to allow `inputs` argument (as in `GenerationMixin`)
        inputs = kwargs.pop("inputs", None)
        if pixel_values is not None and inputs is not None:
            raise ValueError(
                f"`inputs`: {inputs} were passed alongside `pixel_values` which is not allowed."
                f"Make sure to either pass `inputs` or pixel_values=..."
            )
        if pixel_values is None and inputs is not None:
            pixel_values = inputs

        if image_embeds is None:
            vision_model_output = self.vision_model(pixel_values)
            # The whole `last_hidden_state` through `post_layernorm` instead of just `pooled_output`.
            image_embeds = self.vision_model.model.post_layernorm(vision_model_output[0])
            # normalized features
            image_embeds = nn.functional.normalize(image_embeds, dim=-1)
            image_embeds, projection_attentions = self.image_to_text_projection(image_embeds)

        output = self.text_model.generate(
            input_ids=input_ids,
            attention_mask=attention_mask,
            image_embeds=image_embeds,
            image_embeds_position_mask=image_embeds_position_mask,
            inputs_embeds=inputs_embeds,
            **kwargs,
        )

        return output


__all__ = ["Kosmos2ForConditionalGeneration", "Kosmos2Model", "Kosmos2PreTrainedModel"]
               f   e   a   t   u   r   e   _   l   e   n   s       =       m   a   s   k   .   s   u   m   (   1   )   
                                   p   a   d   d   i   n   g   _   l   e   n   g   t   h       =       f   e   a   t   u   r   e   _   l   e   n   s   
                                   p   a   d   _   m   a   s   k       =       t   o   r   c   h   .   a   r   a   n   g   e   (   0   ,       m   a   x   _   a   u   d   i   o   _   l   e   n   g   t   h   ,       d   e   v   i   c   e   =   d   e   v   i   c   e   )   .   e   x   p   a   n   d   (   
                                                   p   a   d   d   i   n   g   _   l   e   n   g   t   h   .   s   i   z   e   (   0   )   ,       -   1   
                                   )       <       p   a   d   d   i   n   g   _   l   e   n   g   t   h   .   u   n   s   q   u   e   e   z   e   (   1   )   
                                   p   a   d   _   m   a   s   k       =       p   a   d   _   m   a   s   k   .   u   n   s   q   u   e   e   z   e   (   1   )   
                                   p   a   d   _   m   a   s   k       =       p   a   d   _   m   a   s   k       &       e   n   c   _   s   t   r   e   a   m   i   n   g   _   m   a   s   k   
                                   r   e   t   u   r   n       p   a   d   _   m   a   s   k   
   
                   d   e   f       f   o   r   w   a   r   d   (   s   e   l   f   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   :       t   o   r   c   h   .   T   e   n   s   o   r   ,       m   a   s   k   :       O   p   t   i   o   n   a   l   [   t   o   r   c   h   .   T   e   n   s   o   r   ]   )   :   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       s   e   l   f   .   e   n   c   o   d   e   r   _   e   m   b   e   d   d   i   n   g   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       h   s   _   m   a   s   k   ,       m   a   s   k       =       s   e   l   f   .   f   o   r   w   a   r   d   _   e   m   b   e   d   d   i   n   g   s   (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       m   a   s   k   )   
   
                                   u   n   f   o   l   d   e   d       =       F   a   l   s   e   
                                   b   s   ,       s   e   q   _   l   e   n   ,       _       =       h   i   d   d   e   n   _   s   t   a   t   e   s   .   s   h   a   p   e   
                                   m   a   x   _   s   e   q   _   l   e   n       =       5   0   0           #       m   a   x   i   m   u   m       p   o   s   i   t   i   o   n       f   o   r       a   b   s   o   l   u   t   e       p   o   s   i   t   i   o   n   a   l       e   n   c   o   d   i   n   g   
                                   i   f       s   e   q   _   l   e   n       >       m   a   x   _   s   e   q   _   l   e   n   :   
                                                   #       a   u   d   i   o       s   e   q   u   e   n   c   e       i   s       l   o   n   g   e   r       t   h   a   n       m   a   x   _   s   e   q   _   l   e   n   ,       u   n   f   o   l   d       i   t       i   n   t   o       c   h   u   n   k   s       o   f       m   a   x   _   s   e   q   _   l   e   n   
                                                   u   n   f   o   l   d   e   d       =       T   r   u   e   
                                                   #       t   h   e       u   n   f   o   l   d       o   p       w   i   l   l       d   r   o   p       r   e   s   i   d   u   a   l       f   r   a   m   e   s   ,       p   a   d       i   t       t   o       t   h   e       m   u   l   t   i   p   l   e       o   f       m   a   x   _   s   e   q   _   l   e   n   
                                                   i   f       s   e   q   _   l   e   n       %       m   a   x   _   s   e   q   _   l   e   n       >       0   :   
                                                                   c   h   u   n   k   _   p   a   d   _   s   i   z   e       =       m   a   x   _   s   e   q   _   l   e   n       -       (   s   e   q   _   l   e   n       %       m   a   x   _   s   e   q   _   l   e   n   )   
                                                   e   l   s   e   :   
                                                                   c   h   u   n   k   _   p   a   d   _   s   i   z   e       =       0   
                                                   i   f       c   h   u   n   k   _   p   a   d   _   s   i   z   e       >       0   :   
                                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   _   p   a   d       =       F   .   p   a   d   (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       (   0   ,       0   ,       0   ,       c   h   u   n   k   _   p   a   d   _   s   i   z   e   )   ,       "   c   o   n   s   t   a   n   t   "   ,       0   )   
                                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       h   i   d   d   e   n   _   s   t   a   t   e   s   _   p   a   d   .   t   o   (   h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   e   v   i   c   e   )   
   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       u   n   f   o   l   d   _   t   e   n   s   o   r   (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       m   a   x   _   s   e   q   _   l   e   n   )   
                                                   m   a   s   k   s   _   u   n   f   o   l   d       =       N   o   n   e   
                                                   i   f       m   a   s   k       i   s       n   o   t       N   o   n   e   :   
                                                                   #       r   e   v   i   s   e       h   s   _   m   a   s   k       h   e   r   e       b   e   c   a   u   s   e       t   h   e       p   r   e   v   i   o   u   s       c   a   l   c   u   l   a   t   e   d       h   s   _   m   a   s   k       d   i   d       n   o   t       c   o   n   s   i   d   e   r       e   x   t   r   a       p   a   d   
                                                                   s   u   b   s   a   m   p   l   e   d   _   p   a   d   _   m   a   s   k       =       m   a   s   k   .   s   q   u   e   e   z   e   (   1   )           #       [   b   z   ,       s   u   b   s   a   m   p   l   e   d   _   u   n   m   a   s   k   _   s   e   q   _   l   e   n   ]   
                                                                   e   x   t   r   a   _   p   a   d   d   e   d   _   s   u   b   s   a   m   l   p   e   d   _   p   a   d   _   m   a   s   k       =       F   .   p   a   d   (   
                                                                                   s   u   b   s   a   m   p   l   e   d   _   p   a   d   _   m   a   s   k   ,       (   0   ,       c   h   u   n   k   _   p   a   d   _   s   i   z   e   )   ,       "   c   o   n   s   t   a   n   t   "   ,       F   a   l   s   e   
                                                                   )           #       e   x   t   r   a       p   a   d   d   i   n   g       t   o       t   h   e       p   a   d       m   a   s   k   
                                                                   e   x   t   r   a   _   p   a   d   d   e   d   _   s   u   b   s   a   m   l   p   e   d   _   p   a   d   _   m   a   s   k       =       e   x   t   r   a   _   p   a   d   d   e   d   _   s   u   b   s   a   m   l   p   e   d   _   p   a   d   _   m   a   s   k   .   u   n   s   q   u   e   e   z   e   (   -   1   )   .   f   l   o   a   t   (   )   
                                                                   m   a   s   k   s   _   u   n   f   o   l   d       =       u   n   f   o   l   d   _   t   e   n   s   o   r   (   
                                                                                   e   x   t   r   a   _   p   a   d   d   e   d   _   s   u   b   s   a   m   l   p   e   d   _   p   a   d   _   m   a   s   k   ,       m   a   x   _   s   e   q   _   l   e   n   
                                                                   )           #       u   n   f   o   l   d       t   h   e       p   a   d       m   a   s   k       l   i   k   e       w   e       d   i   d       t   o       t   h   e       i   n   p   u   t       t   e   n   s   o   r   
                                                                   m   a   s   k   s   _   u   n   f   o   l   d       =       m   a   s   k   s   _   u   n   f   o   l   d   .   s   q   u   e   e   z   e   (   -   1   )   .   b   o   o   l   (   )           #       u   n   f   o   l   d       o   p       d   o   e   s       n   o   t       s   u   p   p   o   r   t       b   o   o   l       t   e   n   s   o   r   
                                                   h   s   _   m   a   s   k       =       s   e   l   f   .   c   a   l   c   u   l   a   t   e   _   h   s   _   m   a   s   k   (   
                                                                   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       h   i   d   d   e   n   _   s   t   a   t   e   s   .   d   e   v   i   c   e   ,       m   a   s   k   s   _   u   n   f   o   l   d   
                                                   )           #       c   a   l   c   u   l   a   t   e       h   s   _   m   a   s   k       b   a   s   e   d       o   n       t   h   e       u   n   f   o   l   d   e   d       p   a   d       m   a   s   k   
   
                                   r   e   l   a   t   i   v   e   _   a   t   t   e   n   t   i   o   n   _   b   i   a   s       =       s   e   l   f   .   r   e   l   a   t   i   v   e   _   a   t   t   e   n   t   i   o   n   _   b   i   a   s   _   l   a   y   e   r   (   h   i   d   d   e   n   _   s   t   a   t   e   s   )   
                                   a   t   t   e   n   t   i   o   n   _   m   a   s   k       =       h   s   _   m   a   s   k   .   u   n   s   q   u   e   e   z   e   (   1   )       +       r   e   l   a   t   i   v   e   _   a   t   t   e   n   t   i   o   n   _   b   i   a   s   
   
                                   f   o   r       l   a   y   e   r       i   n       s   e   l   f   .   e   n   c   o   d   e   r   s   :   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       l   a   y   e   r   (   h   i   d   d   e   n   _   s   t   a   t   e   s   ,       a   t   t   e   n   t   i   o   n   _   m   a   s   k   )   
   
                                   i   f       u   n   f   o   l   d   e   d   :   
                                                   e   m   b   e   d   _   d   i   m       =       h   i   d   d   e   n   _   s   t   a   t   e   s   .   s   h   a   p   e   [   -   1   ]   
                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       h   i   d   d   e   n   _   s   t   a   t   e   s   .   r   e   s   h   a   p   e   (   b   s   ,       -   1   ,       e   m   b   e   d   _   d   i   m   )   
                                                   #       i   f       w   e       e   v   e   r       p   a   d   d   e   d       b   e   f   o   r   e       u   n   f   o   l   d   i   n   g   ,       w   e       n   e   e   d       t   o       r   e   m   o   v   e       t   h   e       p   a   d   d   i   n   g   
                                                   i   f       c   h   u   n   k   _   p   a   d   _   s   i   z   e       >       0   :   
                                                                   h   i   d   d   e   n   _   s   t   a   t   e   s       =       h   i   d   d   e   n   _   s   t   a   t   e   s   [   :   ,       :   -   c   h   u   n   k   _   p   a   d   _   s   i   z   e   ,       :   ]   
   
                                   r   e   t   u   r   n       h   i   d   d   e   n   _   s   t   a   t   e   s   
   
   
   c   l   a   s   s       P   h   i   4   M   u   l   t   i   m   o   d   a   l   A   u   d   i   o   E   m   b   e   d   d   i   n   g   (   n   n   .   M   o   d   u   l   e   )   :   
                   d   e   f       _   _   i   n   i   t   _   _   (   s   e   l   f   ,       c   o   n   f   i   g   :       P   h   i   4   M   u   l   t   i   m   o   d   a   l   C   o   n   f   i   g   )   :   
                                   s   u   p   e   r   (   )   .   _   _   i   n   i   t   _   _   (   )   
                                   s   e   l   f   .   c   o   n   f   i   g       =       c   o   n   f   i   g   
                                   s   e   l   f   .   l   a   y   e   r   _   i   d   x       =       c   o   n   f   i   g   .   a   u   d   i   o   _   c   o   n   f   i   g   .   f   e   a   t   u   r   e   _   l   a   y   e   r   
   
                                   s   e   l   f   .   d   r   o   p       =       n   n   .   D   r   o   p   o   u   t   (   c   o   n   f   i   g   .   e   m   b   d   _   p   d   r   o   p   )   
                                   s   e   l   f   .   e   n   c   o   d   e   r       =       P   h   i   4   M   u   l   t   i   m   o   d   a   l   A   u   d   i   o   M   o   d   e   l   .   _   f   r   o   m   _   c   o   n   f   i   g   (   c   o   n   f   i   g   .   a   u   d   i   o   _   c   o   n   f   i   g   )   
                                   s   e   l   f   .   u   p   _   p   r   o   j   _   f   o   r   _   s   p   e   e   c   h       =       n   n   .   L   i   n   e   a   r   (   
                                       